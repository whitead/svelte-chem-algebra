var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function i(t){t.forEach(e)}function n(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function a(t,e,r){t.insertBefore(e,r||null)}function o(t){t.parentNode&&t.parentNode.removeChild(t)}function l(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function h(t){return document.createElement(t)}function C(t){return document.createTextNode(t)}function u(){return C(" ")}function g(t,e,r,i){return t.addEventListener(e,r,i),()=>t.removeEventListener(e,r,i)}function d(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function f(t,e){e=""+e,t.data!==e&&(t.data=e)}function p(t,e,r){for(let r=0;r<t.options.length;r+=1){const i=t.options[r];if(i.__value===e)return void(i.selected=!0)}r&&void 0===e||(t.selectedIndex=-1)}function m(t,e,r){t.classList[r?"add":"remove"](e)}let v;function b(t){v=t}function w(t){(function(){if(!v)throw new Error("Function called outside component initialization");return v})().$$.after_update.push(t)}const y=[],O=[];let N=[];const S=[],x=Promise.resolve();let A=!1;function R(t){N.push(t)}const k=new Set;let F=0;function M(){if(0!==F)return;const t=v;do{try{for(;F<y.length;){const t=y[F];F++,b(t),E(t.$$)}}catch(t){throw y.length=0,F=0,t}for(b(null),y.length=0,F=0;O.length;)O.pop()();for(let t=0;t<N.length;t+=1){const e=N[t];k.has(e)||(k.add(e),e())}N.length=0}while(y.length);for(;S.length;)S.pop()();A=!1,k.clear(),b(t)}function E(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(R)}}const T=new Set;let I;function B(){I={r:0,c:[],p:I}}function L(){I.r||i(I.c),I=I.p}function P(t,e){t&&t.i&&(T.delete(t),t.i(e))}function D(t,e,r,i){if(t&&t.o){if(T.has(t))return;T.add(t),I.c.push((()=>{T.delete(t),i&&(r&&t.d(1),i())})),t.o(e)}else i&&i()}function H(t){t&&t.c()}function z(t,r,s,c){const{fragment:a,after_update:o}=t.$$;a&&a.m(r,s),c||R((()=>{const r=t.$$.on_mount.map(e).filter(n);t.$$.on_destroy?t.$$.on_destroy.push(...r):i(r),t.$$.on_mount=[]})),o.forEach(R)}function $(t,e){const r=t.$$;null!==r.fragment&&(!function(t){const e=[],r=[];N.forEach((i=>-1===t.indexOf(i)?e.push(i):r.push(i))),r.forEach((t=>t())),N=e}(r.after_update),i(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function _(t,e){-1===t.$$.dirty[0]&&(y.push(t),A||(A=!0,x.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function V(e,n,s,c,a,l,h,C=[-1]){const u=v;b(e);const g=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(u?u.$$.context:[])),callbacks:r(),dirty:C,skip_bound:!1,root:n.target||u.$$.root};h&&h(g.root);let d=!1;if(g.ctx=s?s(e,n.props||{},((t,r,...i)=>{const n=i.length?i[0]:r;return g.ctx&&a(g.ctx[t],g.ctx[t]=n)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](n),d&&_(e,t)),r})):[],g.update(),d=!0,i(g.before_update),g.fragment=!!c&&c(g.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);g.fragment&&g.fragment.l(t),t.forEach(o)}else g.fragment&&g.fragment.c();n.intro&&P(e.$$.fragment),z(e,n.target,n.anchor,n.customElement),M()}b(u)}class W{$destroy(){$(this,1),this.$destroy=t}$on(e,r){if(!n(r))return t;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(r),()=>{const t=i.indexOf(r);-1!==t&&i.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var X=class t{static clone(e){let r=Array.isArray(e)?Array():{};for(let i in e){let n=e[i];"function"==typeof n.clone?r[i]=n.clone():r[i]="object"==typeof n?t.clone(n):n}return r}static equals(t,e){if(t.length!==e.length)return!1;let r=t.slice().sort(),i=e.slice().sort();for(var n=0;n<r.length;n++)if(r[n]!==i[n])return!1;return!0}static print(t){if(0==t.length)return"";let e="(";for(let r=0;r<t.length;r++)e+=t[r].id?t[r].id+", ":t[r]+", ";return e=e.substring(0,e.length-2),e+")"}static each(t,e){for(let r=0;r<t.length;r++)e(t[r])}static get(t,e,r){for(let i=0;i<t.length;i++)if(t[i][e]==r)return t[i]}static contains(t,e){if(e.property||e.func){if(e.func){for(let r=0;r<t.length;r++)if(e.func(t[r]))return!0}else for(let r=0;r<t.length;r++)if(t[r][e.property]==e.value)return!0}else for(let r=0;r<t.length;r++)if(t[r]==e.value)return!0;return!1}static intersection(t,e){let r=new Array;for(let i=0;i<t.length;i++)for(let n=0;n<e.length;n++)t[i]===e[n]&&r.push(t[i]);return r}static unique(t){let e={};return t.filter((function(t){return void 0===e[t]&&(e[t]=!0)}))}static count(t,e){let r=0;for(let i=0;i<t.length;i++)t[i]===e&&r++;return r}static toggle(t,e){let r=Array(),i=!1;for(let n=0;n<t.length;n++)t[n]!==e?r.push(t[n]):i=!0;return i||r.push(e),r}static remove(t,e){let r=Array();for(let i=0;i<t.length;i++)t[i]!==e&&r.push(t[i]);return r}static removeUnique(t,e){let r=t.indexOf(e);return r>-1&&t.splice(r,1),t}static removeAll(t,e){return t.filter((function(t){return-1===e.indexOf(t)}))}static merge(t,e){let r=new Array(t.length+e.length);for(let e=0;e<t.length;e++)r[e]=t[e];for(let i=0;i<e.length;i++)r[t.length+i]=e[i];return r}static containsAll(t,e){let r=0;for(let i=0;i<t.length;i++)for(let n=0;n<e.length;n++)t[i]===e[n]&&r++;return r===e.length}static sortByAtomicNumberDesc(t){let e=t.map((function(t,e){return{index:e,value:t.atomicNumber.split(".").map(Number)}}));return e.sort((function(t,e){let r=Math.min(e.value.length,t.value.length),i=0;for(;i<r&&e.value[i]===t.value[i];)i++;return i===r?e.value.length-t.value.length:e.value[i]-t.value[i]})),e.map((function(e){return t[e.index]}))}static deepCopy(e){let r=Array();for(let i=0;i<e.length;i++){let n=e[i];r[i]=n instanceof Array?t.deepCopy(n):n}return r}};var U=class t{static round(t,e){return e=e||1,Number(Math.round(t+"e"+e)+"e-"+e)}static meanAngle(t){let e=0,r=0;for(var i=0;i<t.length;i++)e+=Math.sin(t[i]),r+=Math.cos(t[i]);return Math.atan2(e/t.length,r/t.length)}static innerAngle(e){return t.toRad(180*(e-2)/e)}static polyCircumradius(t,e){return t/(2*Math.sin(Math.PI/e))}static apothem(t,e){return t*Math.cos(Math.PI/e)}static apothemFromSideLength(e,r){let i=t.polyCircumradius(e,r);return t.apothem(i,r)}static centralAngle(e){return t.toRad(360/e)}static toDeg(e){return e*t.degFactor}static toRad(e){return e*t.radFactor}static parityOfPermutation(t){let e=new Uint8Array(t.length),r=0,i=function(r,n=0){return 1===e[r]?n:(n++,e[r]=1,i(t[r],n))};for(var n=0;n<t.length;n++){if(1===e[n])continue;r+=1-i(n)%2}return r%2?-1:1}static get radFactor(){return Math.PI/180}static get degFactor(){return 180/Math.PI}static get twoPI(){return 2*Math.PI}};var Y,q,G,j,K,Z,J,Q,tt=class t{constructor(t,e){0==arguments.length?(this.x=0,this.y=0):1==arguments.length?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}clone(){return new t(this.x,this.y)}toString(){return"("+this.x+","+this.y+")"}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}divide(t){return this.x/=t,this.y/=t,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}invert(){return this.x=-this.x,this.y=-this.y,this}angle(){return Math.atan2(this.y,this.x)}distance(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))}distanceSq(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)}clockwise(t){let e=this.y*t.x,r=this.x*t.y;return e>r?-1:e===r?0:1}relativeClockwise(t,e){let r=(this.y-t.y)*(e.x-t.x),i=(this.x-t.x)*(e.y-t.y);return r>i?-1:r===i?0:1}rotate(e){let r=new t(0,0),i=Math.cos(e),n=Math.sin(e);return r.x=this.x*i-this.y*n,r.y=this.x*n+this.y*i,this.x=r.x,this.y=r.y,this}rotateAround(t,e){let r=Math.sin(t),i=Math.cos(t);this.x-=e.x,this.y-=e.y;let n=this.x*i-this.y*r,s=this.x*r+this.y*i;return this.x=n+e.x,this.y=s+e.y,this}rotateTo(e,r,i=0){this.x+=.001,this.y-=.001;let n=t.subtract(this,r),s=t.subtract(e,r),c=t.angle(s,n);return this.rotateAround(c+i,r),this}rotateAwayFrom(t,e,r){this.rotateAround(r,e);let i=this.distanceSq(t);this.rotateAround(-2*r,e),this.distanceSq(t)<i&&this.rotateAround(2*r,e)}getRotateAwayFromAngle(t,e,r){let i=this.clone();i.rotateAround(r,e);let n=i.distanceSq(t);return i.rotateAround(-2*r,e),i.distanceSq(t)<n?r:-r}getRotateTowardsAngle(t,e,r){let i=this.clone();i.rotateAround(r,e);let n=i.distanceSq(t);return i.rotateAround(-2*r,e),i.distanceSq(t)>n?r:-r}getRotateToAngle(e,r){let i=t.subtract(this,r),n=t.subtract(e,r),s=t.angle(n,i);return Number.isNaN(s)?0:s}isInPolygon(t){let e=!1;for(let r=0,i=t.length-1;r<t.length;i=r++)t[r].y>this.y!=t[i].y>this.y&&this.x<(t[i].x-t[r].x)*(this.y-t[r].y)/(t[i].y-t[r].y)+t[r].x&&(e=!e);return e}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSq(){return this.x*this.x+this.y*this.y}normalize(){return this.divide(this.length()),this}normalized(){return t.divideScalar(this,this.length())}whichSide(t,e){return(this.x-t.x)*(e.y-t.y)-(this.y-t.y)*(e.x-t.x)}sameSideAs(t,e,r){let i=this.whichSide(t,e),n=r.whichSide(t,e);return i<0&&n<0||0==i&&0==n||i>0&&n>0}static add(e,r){return new t(e.x+r.x,e.y+r.y)}static subtract(e,r){return new t(e.x-r.x,e.y-r.y)}static multiply(e,r){return new t(e.x*r.x,e.y*r.y)}static multiplyScalar(e,r){return new t(e.x,e.y).multiplyScalar(r)}static midpoint(e,r){return new t((e.x+r.x)/2,(e.y+r.y)/2)}static normals(e,r){let i=t.subtract(r,e);return[new t(-i.y,i.x),new t(i.y,-i.x)]}static units(e,r){let i=t.subtract(r,e);return[new t(-i.y,i.x).normalize(),new t(i.y,-i.x).normalize()]}static divide(e,r){return new t(e.x/r.x,e.y/r.y)}static divideScalar(e,r){return new t(e.x/r,e.y/r)}static dot(t,e){return t.x*e.x+t.y*e.y}static angle(e,r){let i=t.dot(e,r);return Math.acos(i/(e.length()*r.length()))}static threePointangle(e,r,i){let n=t.subtract(r,e),s=t.subtract(i,r),c=e.distance(r),a=r.distance(i);return Math.acos(t.dot(n,s)/(c*a))}static scalarProjection(e,r){let i=r.normalized();return t.dot(e,i)}static averageDirection(e){let r=new t(0,0);for(var i=0;i<e.length;i++){let t=e[i];r.add(t)}return r.normalize()}};function et(){if(q)return Y;q=1;const t=U,e=X,r=tt;nt();class i{constructor(t,e=0,i=0){this.id=null,this.value=t,this.position=new r(e||0,i||0),this.previousPosition=new r(0,0),this.parentVertexId=null,this.children=Array(),this.spanningTreeChildren=Array(),this.edges=Array(),this.positioned=!1,this.angle=null,this.dir=1,this.neighbourCount=0,this.neighbours=Array(),this.neighbouringElements=Array(),this.forcePositioned=!1}setPosition(t,e){this.position.x=t,this.position.y=e}setPositionFromVector(t){this.position.x=t.x,this.position.y=t.y}addChild(t){this.children.push(t),this.neighbours.push(t),this.neighbourCount++}addRingbondChild(t,e){if(this.children.push(t),this.value.bracket){let r=1;0===this.id&&0===this.value.bracket.hcount&&(r=0),1===this.value.bracket.hcount&&0===e&&(r=2),1===this.value.bracket.hcount&&1===e&&(r=this.neighbours.length<3?2:3),null===this.value.bracket.hcount&&0===e&&(r=1),null===this.value.bracket.hcount&&1===e&&(r=this.neighbours.length<3?1:2),this.neighbours.splice(r,0,t)}else this.neighbours.push(t);this.neighbourCount++}setParentVertexId(t){this.neighbourCount++,this.parentVertexId=t,this.neighbours.push(t)}isTerminal(){return!!this.value.hasAttachedPseudoElements||(null===this.parentVertexId&&this.children.length<2||0===this.children.length)}clone(){let t=new i(this.value,this.position.x,this.position.y);return t.id=this.id,t.previousPosition=new r(this.previousPosition.x,this.previousPosition.y),t.parentVertexId=this.parentVertexId,t.children=e.clone(this.children),t.spanningTreeChildren=e.clone(this.spanningTreeChildren),t.edges=e.clone(this.edges),t.positioned=this.positioned,t.angle=this.angle,t.forcePositioned=this.forcePositioned,t}equals(t){return this.id===t.id}getAngle(e=null,i=!1){let n=null;return n=e?r.subtract(this.position,e):r.subtract(this.position,this.previousPosition),i?t.toDeg(n.angle()):n.angle()}getTextDirection(e,r=!1){let i=this.getDrawnNeighbours(e),n=Array();if(1===e.length)return"right";for(let t=0;t<i.length;t++)n.push(this.getAngle(e[i[t]].position));let s=t.meanAngle(n);if(this.isTerminal()||r)Math.round(100*s)/100==1.57&&(s-=.2),s=Math.round(Math.round(s/Math.PI)*Math.PI);else{let t=Math.PI/2;s=Math.round(Math.round(s/t)*t)}return 2===s?"down":-2===s?"up":0===s||-0===s?"right":3===s||-3===s?"left":"down"}getNeighbours(t=null){if(null===t)return this.neighbours.slice();let e=Array();for(let r=0;r<this.neighbours.length;r++)this.neighbours[r]!==t&&e.push(this.neighbours[r]);return e}getDrawnNeighbours(t){let e=Array();for(let r=0;r<this.neighbours.length;r++)t[this.neighbours[r]].value.isDrawn&&e.push(this.neighbours[r]);return e}getNeighbourCount(){return this.neighbourCount}getSpanningTreeNeighbours(t=null){let e=Array();for(let r=0;r<this.spanningTreeChildren.length;r++)void 0!==t&&t==this.spanningTreeChildren[r]||e.push(this.spanningTreeChildren[r]);return null!=this.parentVertexId&&(void 0!==t&&t==this.parentVertexId||e.push(this.parentVertexId)),e}getNextInRing(t,r,i){let n=this.getNeighbours();for(let s=0;s<n.length;s++)if(e.contains(t[n[s]].value.rings,{value:r})&&n[s]!=i)return n[s];return null}}return Y=i}function rt(){if(j)return G;j=1,et(),it();return G=class{constructor(t,e){this.id=null,this.firstRingId=t.id,this.secondRingId=e.id,this.vertices=new Set;for(var r=0;r<t.members.length;r++){let i=t.members[r];for(let t=0;t<e.members.length;t++){i===e.members[t]&&this.addVertex(i)}}}addVertex(t){this.vertices.add(t)}updateOther(t,e){this.firstRingId===e?this.secondRingId=t:this.firstRingId=t}containsRing(t){return this.firstRingId===t||this.secondRingId===t}isBridge(t){if(this.vertices.size>2)return!0;for(let e of this.vertices)if(t[e].value.rings.length>2)return!0;return!1}static isBridge(t,e,r,i){let n=null;for(let s=0;s<t.length;s++)if(n=t[s],n.firstRingId===r&&n.secondRingId===i||n.firstRingId===i&&n.secondRingId===r)return n.isBridge(e);return!1}static getNeighbours(t,e){let r=[];for(let i=0;i<t.length;i++){let n=t[i];n.firstRingId===e?r.push(n.secondRingId):n.secondRingId===e&&r.push(n.firstRingId)}return r}static getVertices(t,e,r){for(let i=0;i<t.length;i++){let n=t[i];if(n.firstRingId===e&&n.secondRingId===r||n.firstRingId===r&&n.secondRingId===e)return[...n.vertices]}}}}function it(){if(Z)return K;Z=1;const t=X,e=tt;et();const r=rt();class i{constructor(t){this.id=null,this.members=t,this.edges=[],this.insiders=[],this.neighbours=[],this.positioned=!1,this.center=new e(0,0),this.rings=[],this.isBridged=!1,this.isPartOfBridged=!1,this.isSpiro=!1,this.isFused=!1,this.centralAngle=0,this.canFlip=!0}clone(){let e=new i(this.members);return e.id=this.id,e.insiders=t.clone(this.insiders),e.neighbours=t.clone(this.neighbours),e.positioned=this.positioned,e.center=this.center.clone(),e.rings=t.clone(this.rings),e.isBridged=this.isBridged,e.isPartOfBridged=this.isPartOfBridged,e.isSpiro=this.isSpiro,e.isFused=this.isFused,e.centralAngle=this.centralAngle,e.canFlip=this.canFlip,e}getSize(){return this.members.length}getPolygon(t){let e=[];for(let r=0;r<this.members.length;r++)e.push(t[this.members[r]].position);return e}getAngle(){return Math.PI-this.centralAngle}eachMember(t,e,r,i){let n=r=r||0===r?r:this.members[0],s=0;for(;null!=n&&s<100;){let c=n;e(c),n=t[n].getNextInRing(t,this.id,i),i=c,n==r&&(n=null),s++}}getOrderedNeighbours(t){let e=Array(this.neighbours.length);for(let i=0;i<this.neighbours.length;i++){let n=r.getVertices(t,this.id,this.neighbours[i]);e[i]={n:n.length,neighbour:this.neighbours[i]}}return e.sort((function(t,e){return e.n-t.n})),e}isBenzeneLike(t){let e=this.getDoubleBondCount(t),r=this.members.length;return 3===e&&6===r||2===e&&5===r}getDoubleBondCount(t){let e=0;for(let r=0;r<this.members.length;r++){let i=t[this.members[r]].value;"="!==i.bondType&&"="!==i.branchBond||e++}return e}contains(t){for(let e=0;e<this.members.length;e++)if(this.members[e]==t)return!0;return!1}}return K=i}function nt(){if(Q)return J;Q=1;const t=X;et(),it();class e{constructor(t,e="-"){this.idx=null,this.element=1===t.length?t.toUpperCase():t,this.drawExplicit=!1,this.ringbonds=Array(),this.rings=Array(),this.bondType=e,this.branchBond=null,this.isBridge=!1,this.isBridgeNode=!1,this.originalRings=Array(),this.bridgedRing=null,this.anchoredRings=Array(),this.bracket=null,this.plane=0,this.attachedPseudoElements={},this.hasAttachedPseudoElements=!1,this.isDrawn=!0,this.isConnectedToRing=!1,this.neighbouringElements=Array(),this.isPartOfAromaticRing=t!==this.element,this.bondCount=0,this.chirality="",this.isStereoCenter=!1,this.priority=0,this.mainChain=!1,this.hydrogenDirection="down",this.subtreeDepth=1,this.hasHydrogen=!1,this.class=void 0}addNeighbouringElement(t){this.neighbouringElements.push(t)}attachPseudoElement(t,e,r=0,i=0){null===r&&(r=0),null===i&&(i=0);let n=r+t+i;this.attachedPseudoElements[n]?this.attachedPseudoElements[n].count+=1:this.attachedPseudoElements[n]={element:t,count:1,hydrogenCount:r,previousElement:e,charge:i},this.hasAttachedPseudoElements=!0}getAttachedPseudoElements(){let t={},e=this;return Object.keys(this.attachedPseudoElements).sort().forEach((function(r){t[r]=e.attachedPseudoElements[r]})),t}getAttachedPseudoElementsCount(){return Object.keys(this.attachedPseudoElements).length}isHeteroAtom(){return"C"!==this.element&&"H"!==this.element}addAnchoredRing(e){t.contains(this.anchoredRings,{value:e})||this.anchoredRings.push(e)}getRingbondCount(){return this.ringbonds.length}backupRings(){this.originalRings=Array(this.rings.length);for(let t=0;t<this.rings.length;t++)this.originalRings[t]=this.rings[t]}restoreRings(){this.rings=Array(this.originalRings.length);for(let t=0;t<this.originalRings.length;t++)this.rings[t]=this.originalRings[t]}haveCommonRingbond(t,e){for(let r=0;r<t.ringbonds.length;r++)for(let i=0;i<e.ringbonds.length;i++)if(t.ringbonds[r].id==e.ringbonds[i].id)return!0;return!1}neighbouringElementsEqual(t){if(t.length!==this.neighbouringElements.length)return!1;t.sort(),this.neighbouringElements.sort();for(var e=0;e<this.neighbouringElements.length;e++)if(t[e]!==this.neighbouringElements[e])return!1;return!0}getAtomicNumber(){return e.atomicNumbers[this.element]}getMaxBonds(){return e.maxBonds[this.element]}static get maxBonds(){return{H:1,C:4,N:3,O:2,P:3,S:2,B:3,F:1,I:1,Cl:1,Br:1}}static get atomicNumbers(){return{H:1,He:2,Li:3,Be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,p:15,S:16,s:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Uuq:114,Uup:115,Uuh:116,Uus:117,Uuo:118}}static get mass(){return{H:1,He:2,Li:3,Be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,p:15,S:16,s:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Uuq:114,Uup:115,Uuh:116,Uus:117,Uuo:118}}}return J=e}const st=tt;var ct=class t{constructor(t=new st(0,0),e=new st(0,0),r=null,i=null,n=!1,s=!1){this.from=t,this.to=e,this.elementFrom=r,this.elementTo=i,this.chiralFrom=n,this.chiralTo=s}clone(){return new t(this.from.clone(),this.to.clone(),this.elementFrom,this.elementTo)}getLength(){return Math.sqrt(Math.pow(this.to.x-this.from.x,2)+Math.pow(this.to.y-this.from.y,2))}getAngle(){return st.subtract(this.getRightVector(),this.getLeftVector()).angle()}getRightVector(){return this.from.x<this.to.x?this.to:this.from}getLeftVector(){return this.from.x<this.to.x?this.from:this.to}getRightElement(){return this.from.x<this.to.x?this.elementTo:this.elementFrom}getLeftElement(){return this.from.x<this.to.x?this.elementFrom:this.elementTo}getRightChiral(){return this.from.x<this.to.x?this.chiralTo:this.chiralFrom}getLeftChiral(){return this.from.x<this.to.x?this.chiralFrom:this.chiralTo}setRightVector(t,e){return this.from.x<this.to.x?(this.to.x=t,this.to.y=e):(this.from.x=t,this.from.y=e),this}setLeftVector(t,e){return this.from.x<this.to.x?(this.from.x=t,this.from.y=e):(this.to.x=t,this.to.y=e),this}rotateToXAxis(){let t=this.getLeftVector();return this.setRightVector(t.x+this.getLength(),t.y),this}rotate(t){let e=this.getLeftVector(),r=this.getRightVector(),i=Math.sin(t),n=Math.cos(t),s=n*(r.x-e.x)-i*(r.y-e.y)+e.x,c=i*(r.x-e.x)-n*(r.y-e.y)+e.y;return this.setRightVector(s,c),this}shortenFrom(t){let e=st.subtract(this.to,this.from);return e.normalize(),e.multiplyScalar(t),this.from.add(e),this}shortenTo(t){let e=st.subtract(this.from,this.to);return e.normalize(),e.multiplyScalar(t),this.to.add(e),this}shortenRight(t){return this.from.x<this.to.x?this.shortenTo(t):this.shortenFrom(t),this}shortenLeft(t){return this.from.x<this.to.x?this.shortenFrom(t):this.shortenTo(t),this}shorten(t){let e=st.subtract(this.from,this.to);return e.normalize(),e.multiplyScalar(t/2),this.to.add(e),this.from.subtract(e),this}};var at=class t{constructor(t,e,r=1){this.id=null,this.sourceId=t,this.targetId=e,this.weight=r,this.bondType="-",this.isPartOfAromaticRing=!1,this.center=!1,this.wedge=""}setBondType(e){this.bondType=e,this.weight=t.bonds[e]}static get bonds(){return{"-":1,"/":1,"\\":1,"=":2,"#":3,$:4}}};var ot={getChargeText:function(t){return 1===t?"+":2===t?"2+":-1===t?"-":-2===t?"2-":""}};const lt=U,ht=tt;et(),it();const{getChargeText:Ct}=ot;var ut=class{constructor(t,e,r){this.canvas="string"==typeof t||t instanceof String?document.getElementById(t):t,this.ctx=this.canvas.getContext("2d"),this.themeManager=e,this.opts=r,this.drawingWidth=0,this.drawingHeight=0,this.offsetX=0,this.offsetY=0,this.fontLarge=this.opts.fontSizeLarge+"pt Helvetica, Arial, sans-serif",this.fontSmall=this.opts.fontSizeSmall+"pt Helvetica, Arial, sans-serif",this.updateSize(this.opts.width,this.opts.height),this.ctx.font=this.fontLarge,this.hydrogenWidth=this.ctx.measureText("H").width,this.halfHydrogenWidth=this.hydrogenWidth/2,this.halfBondThickness=this.opts.bondThickness/2}updateSize(t,e){this.devicePixelRatio=window.devicePixelRatio||1,this.backingStoreRatio=this.ctx.webkitBackingStorePixelRatio||this.ctx.mozBackingStorePixelRatio||this.ctx.msBackingStorePixelRatio||this.ctx.oBackingStorePixelRatio||this.ctx.backingStorePixelRatio||1,this.ratio=this.devicePixelRatio/this.backingStoreRatio,1!==this.ratio?(this.canvas.width=t*this.ratio,this.canvas.height=e*this.ratio,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.ctx.setTransform(this.ratio,0,0,this.ratio,0,0)):(this.canvas.width=t*this.ratio,this.canvas.height=e*this.ratio)}setTheme(t){this.colors=t}scale(t){let e=-Number.MAX_VALUE,r=-Number.MAX_VALUE,i=Number.MAX_VALUE,n=Number.MAX_VALUE;for(var s=0;s<t.length;s++){if(!t[s].value.isDrawn)continue;let c=t[s].position;e<c.x&&(e=c.x),r<c.y&&(r=c.y),i>c.x&&(i=c.x),n>c.y&&(n=c.y)}var c=this.opts.padding;e+=c,r+=c,i-=c,n-=c,this.drawingWidth=e-i,this.drawingHeight=r-n;var a=this.canvas.offsetWidth/this.drawingWidth,o=this.canvas.offsetHeight/this.drawingHeight,l=a<o?a:o;this.ctx.scale(l,l),this.offsetX=-i,this.offsetY=-n,a<o?this.offsetY+=this.canvas.offsetHeight/(2*l)-this.drawingHeight/2:this.offsetX+=this.canvas.offsetWidth/(2*l)-this.drawingWidth/2}reset(){this.ctx.setTransform(1,0,0,1,0,0)}getColor(t){return(t=t.toUpperCase())in this.colors?this.colors[t]:this.colors.C}drawCircle(t,e,r,i,n=!0,s=!1,c=""){let a=this.ctx,o=this.offsetX,l=this.offsetY;a.save(),a.lineWidth=1.5,a.beginPath(),a.arc(t+o,e+l,r,0,lt.twoPI,!0),a.closePath(),s?(n?(a.fillStyle="#f00",a.fill()):(a.strokeStyle="#f00",a.stroke()),this.drawDebugText(t,e,c)):n?(a.fillStyle=i,a.fill()):(a.strokeStyle=i,a.stroke()),a.restore()}drawLine(t,e=!1,r=1){let i=this.ctx,n=this.offsetX,s=this.offsetY,c=t.clone().shorten(4),a=c.getLeftVector().clone(),o=c.getRightVector().clone();a.x+=n,a.y+=s,o.x+=n,o.y+=s,e||(i.save(),i.globalCompositeOperation="destination-out",i.beginPath(),i.moveTo(a.x,a.y),i.lineTo(o.x,o.y),i.lineCap="round",i.lineWidth=this.opts.bondThickness+1.2,i.strokeStyle=this.themeManager.getColor("BACKGROUND"),i.stroke(),i.globalCompositeOperation="source-over",i.restore()),a=t.getLeftVector().clone(),o=t.getRightVector().clone(),a.x+=n,a.y+=s,o.x+=n,o.y+=s,i.save(),i.beginPath(),i.moveTo(a.x,a.y),i.lineTo(o.x,o.y),i.lineCap="round",i.lineWidth=this.opts.bondThickness;let l=this.ctx.createLinearGradient(a.x,a.y,o.x,o.y);l.addColorStop(.4,this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),l.addColorStop(.6,this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C")),e&&(i.setLineDash([1,1.5]),i.lineWidth=this.opts.bondThickness/1.5),r<1&&(i.globalAlpha=r),i.strokeStyle=l,i.stroke(),i.restore()}drawWedge(t,e=1){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let r=this.ctx,i=this.offsetX,n=this.offsetY,s=t.clone().shorten(5),c=s.getLeftVector().clone(),a=s.getRightVector().clone();c.x+=i,c.y+=n,a.x+=i,a.y+=n,c=t.getLeftVector().clone(),a=t.getRightVector().clone(),c.x+=i,c.y+=n,a.x+=i,a.y+=n,r.save();let o=ht.normals(c,a);o[0].normalize(),o[1].normalize();let l=c,h=a;t.getRightChiral()&&(l=a,h=c);let C=ht.add(l,ht.multiplyScalar(o[0],this.halfBondThickness)),u=ht.add(h,ht.multiplyScalar(o[0],1.5+this.halfBondThickness)),g=ht.add(h,ht.multiplyScalar(o[1],1.5+this.halfBondThickness)),d=ht.add(l,ht.multiplyScalar(o[1],this.halfBondThickness));r.beginPath(),r.moveTo(C.x,C.y),r.lineTo(u.x,u.y),r.lineTo(g.x,g.y),r.lineTo(d.x,d.y);let f=this.ctx.createRadialGradient(a.x,a.y,this.opts.bondLength,a.x,a.y,0);f.addColorStop(.4,this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),f.addColorStop(.6,this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C")),r.fillStyle=f,r.fill(),r.restore()}drawDashedWedge(t){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let e=this.ctx,r=this.offsetX,i=this.offsetY,n=t.getLeftVector().clone(),s=t.getRightVector().clone();n.x+=r,n.y+=i,s.x+=r,s.y+=i,e.save();let c=ht.normals(n,s);c[0].normalize(),c[1].normalize();let a,o,l,h,C=t.getRightChiral(),u=t.clone();C?(a=s,o=n,u.shortenRight(1),l=u.getRightVector().clone(),h=u.getLeftVector().clone()):(a=n,o=s,u.shortenLeft(1),l=u.getLeftVector().clone(),h=u.getRightVector().clone()),l.x+=r,l.y+=i,h.x+=r,h.y+=i;let g=ht.subtract(o,a).normalize();e.strokeStyle=this.themeManager.getColor("C"),e.lineCap="round",e.lineWidth=this.opts.bondThickness,e.beginPath();let d=t.getLength(),f=1.25/(d/(3*this.opts.bondThickness)),p=!1;for(var m=0;m<1;m+=f){let r=ht.multiplyScalar(g,m*d),i=ht.add(a,r),n=1.5*m,s=ht.multiplyScalar(c[0],n);!p&&m>.5&&(e.stroke(),e.beginPath(),e.strokeStyle=this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C"),p=!0),i.subtract(s),e.moveTo(i.x,i.y),i.add(ht.multiplyScalar(s,2)),e.lineTo(i.x,i.y)}e.stroke(),e.restore()}drawDebugText(t,e,r){let i=this.ctx;i.save(),i.font="5px Droid Sans, sans-serif",i.textAlign="start",i.textBaseline="top",i.fillStyle="#ff0000",i.fillText(r,t+this.offsetX,e+this.offsetY),i.restore()}drawBall(t,e,r){let i=this.ctx;i.save(),i.beginPath(),i.arc(t+this.offsetX,e+this.offsetY,this.opts.bondLength/4.5,0,lt.twoPI,!1),i.fillStyle=this.themeManager.getColor(r),i.fill(),i.restore()}drawPoint(t,e,r){let i=this.ctx,n=this.offsetX,s=this.offsetY;i.save(),i.globalCompositeOperation="destination-out",i.beginPath(),i.arc(t+n,e+s,1.5,0,lt.twoPI,!0),i.closePath(),i.fill(),i.globalCompositeOperation="source-over",i.beginPath(),i.arc(t+this.offsetX,e+this.offsetY,.75,0,lt.twoPI,!1),i.fillStyle=this.themeManager.getColor(r),i.fill(),i.restore()}drawText(t,e,r,i,n,s,c,a,o,l={}){let h=this.ctx,C=this.offsetX,u=this.offsetY;h.save(),h.textAlign="start",h.textBaseline="alphabetic";let g="",d=0;c&&(g=Ct(c),h.font=this.fontSmall,d=h.measureText(g).width);let f="0",p=0;a>0&&(f=a.toString(),h.font=this.fontSmall,p=h.measureText(f).width),1===c&&"N"===r&&l.hasOwnProperty("0O")&&l.hasOwnProperty("0O-1")&&(l={"0O":{element:"O",count:2,hydrogenCount:0,previousElement:"C",charge:""}},c=0),h.font=this.fontLarge,h.fillStyle=this.themeManager.getColor("BACKGROUND");let m=h.measureText(r);m.totalWidth=m.width+d,m.height=parseInt(this.fontLarge,10);let v=m.width>this.opts.fontSizeLarge?m.width:this.opts.fontSizeLarge;v/=1.5,h.globalCompositeOperation="destination-out",h.beginPath(),h.arc(t+C,e+u,v,0,lt.twoPI,!0),h.closePath(),h.fill(),h.globalCompositeOperation="source-over";let b=-m.width/2,w=-m.width/2;h.fillStyle=this.themeManager.getColor(r),h.fillText(r,t+C+b,e+this.opts.halfFontSizeLarge+u),b+=m.width,c&&(h.font=this.fontSmall,h.fillText(g,t+C+b,e-this.opts.fifthFontSizeSmall+u),b+=d),a>0&&(h.font=this.fontSmall,h.fillText(f,t+C+w-p,e-this.opts.fifthFontSizeSmall+u),w-=p),h.font=this.fontLarge;let y=0,O=0;if(1===i){let r=t+C,i=e+u+this.opts.halfFontSizeLarge;y=this.hydrogenWidth,w-=y,"left"===n?r+=w:"right"===n||"up"===n&&s||"down"===n&&s?r+=b:"up"!==n||s?"down"!==n||s||(i+=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,r-=this.halfHydrogenWidth):(i-=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,r-=this.halfHydrogenWidth),h.fillText("H",r,i),b+=y}else if(i>1){let r=t+C,c=e+u+this.opts.halfFontSizeLarge;y=this.hydrogenWidth,h.font=this.fontSmall,O=h.measureText(i).width,w-=y+O,"left"===n?r+=w:"right"===n||"up"===n&&s||"down"===n&&s?r+=b:"up"!==n||s?"down"!==n||s||(c+=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,r-=this.halfHydrogenWidth):(c-=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,r-=this.halfHydrogenWidth),h.font=this.fontLarge,h.fillText("H",r,c),h.font=this.fontSmall,h.fillText(i,r+this.halfHydrogenWidth+O,c+this.opts.fifthFontSizeSmall),b+=y+this.halfHydrogenWidth+O}for(let r in l){if(!l.hasOwnProperty(r))continue;let i=0,s=0,c=l[r].element,a=l[r].count,o=l[r].hydrogenCount,g=l[r].charge;h.font=this.fontLarge,a>1&&o>0&&(i=h.measureText("(").width,s=h.measureText(")").width);let d=h.measureText(c).width,f=0,p="",m=0;y=0,o>0&&(y=this.hydrogenWidth),h.font=this.fontSmall,a>1&&(f=h.measureText(a).width),0!==g&&(p=Ct(g),m=h.measureText(p).width),O=0,o>1&&(O=h.measureText(o).width),h.font=this.fontLarge;let v=t+C,N=e+u+this.opts.halfFontSizeLarge;h.fillStyle=this.themeManager.getColor(c),a>0&&(w-=f),a>1&&o>0&&("left"===n?(w-=s,h.fillText(")",v+w,N)):(h.fillText("(",v+b,N),b+=i)),"left"===n?(w-=d,h.fillText(c,v+w,N)):(h.fillText(c,v+b,N),b+=d),o>0&&("left"===n?(w-=y+O,h.fillText("H",v+w,N),o>1&&(h.font=this.fontSmall,h.fillText(o,v+w+y,N+this.opts.fifthFontSizeSmall))):(h.fillText("H",v+b,N),b+=y,o>1&&(h.font=this.fontSmall,h.fillText(o,v+b,N+this.opts.fifthFontSizeSmall),b+=O))),h.font=this.fontLarge,a>1&&o>0&&("left"===n?(w-=i,h.fillText("(",v+w,N)):(h.fillText(")",v+b,N),b+=s)),h.font=this.fontSmall,a>1&&("left"===n?h.fillText(a,v+w+i+s+y+O+d,N+this.opts.fifthFontSizeSmall):(h.fillText(a,v+b,N+this.opts.fifthFontSizeSmall),b+=f)),0!==g&&("left"===n?h.fillText(p,v+w+i+s+y+O+d,e-this.opts.fifthFontSizeSmall+u):(h.fillText(p,v+b,e-this.opts.fifthFontSizeSmall+u),b+=m))}h.restore()}getChargeText(t){return 1===t?"+":2===t?"2+":-1===t?"-":-2===t?"2-":""}drawDebugPoint(t,e,r="",i="#f00"){this.drawCircle(t,e,2,i,!0,!0,r)}drawAromaticityRing(t){let e=this.ctx,r=lt.apothemFromSideLength(this.opts.bondLength,t.getSize());e.save(),e.strokeStyle=this.themeManager.getColor("C"),e.lineWidth=this.opts.bondThickness,e.beginPath(),e.arc(t.center.x+this.offsetX,t.center.y+this.offsetY,r-this.opts.bondSpacing,0,2*Math.PI,!0),e.closePath(),e.stroke(),e.restore()}clear(){this.ctx.clearRect(0,0,this.canvas.offsetWidth,this.canvas.offsetHeight)}};const gt=U,dt=et(),ft=at;it();const pt=nt();var mt=class t{constructor(t,e=!1){this.vertices=Array(),this.edges=Array(),this.atomIdxToVertexId=Array(),this.vertexIdsToEdgeId={},this.isomeric=e,this._atomIdx=0,this._time=0,this._init(t)}_init(t,e=0,r=null,i=!1){const n=t.atom.element?t.atom.element:t.atom;let s=new pt(n,t.bond);("H"!==n||!t.hasNext&&null===r)&&(s.idx=this._atomIdx,this._atomIdx++),s.branchBond=t.branchBond,s.ringbonds=t.ringbonds,s.bracket=t.atom.element?t.atom:null,s.class=t.atom.class;let c=new dt(s),a=this.vertices[r];if(this.addVertex(c),null!==s.idx&&this.atomIdxToVertexId.push(c.id),null!==r){c.setParentVertexId(r),c.value.addNeighbouringElement(a.value.element),a.addChild(c.id),a.value.addNeighbouringElement(s.element),a.spanningTreeChildren.push(c.id);let t=new ft(r,c.id,1);i?(t.setBondType(c.value.branchBond||"-"),c.id,t.setBondType(c.value.branchBond||"-"),c.id):(t.setBondType(a.value.bondType||"-"),a.id),this.addEdge(t)}let o=t.ringbondCount+1;s.bracket&&(o+=s.bracket.hcount);let l=0;if(s.bracket&&s.bracket.chirality){s.isStereoCenter=!0,l=s.bracket.hcount;for(var h=0;h<l;h++)this._init({atom:"H",isBracket:"false",branches:Array(),branchCount:0,ringbonds:Array(),ringbondCount:!1,next:null,hasNext:!1,bond:"-"},h,c.id,!0)}for(h=0;h<t.branchCount;h++)this._init(t.branches[h],h+o,c.id,!0);t.hasNext&&this._init(t.next,t.branchCount+o,c.id)}clear(){this.vertices=Array(),this.edges=Array(),this.vertexIdsToEdgeId={}}addVertex(t){return t.id=this.vertices.length,this.vertices.push(t),t.id}addEdge(t){let e=this.vertices[t.sourceId],r=this.vertices[t.targetId];return t.id=this.edges.length,this.edges.push(t),this.vertexIdsToEdgeId[t.sourceId+"_"+t.targetId]=t.id,this.vertexIdsToEdgeId[t.targetId+"_"+t.sourceId]=t.id,t.isPartOfAromaticRing=e.value.isPartOfAromaticRing&&r.value.isPartOfAromaticRing,e.value.bondCount+=t.weight,r.value.bondCount+=t.weight,e.edges.push(t.id),r.edges.push(t.id),t.id}getEdge(t,e){let r=this.vertexIdsToEdgeId[t+"_"+e];return void 0===r?null:this.edges[r]}getEdges(t){let e=Array(),r=this.vertices[t];for(var i=0;i<r.neighbours.length;i++)e.push(this.vertexIdsToEdgeId[t+"_"+r.neighbours[i]]);return e}hasEdge(t,e){return void 0!==this.vertexIdsToEdgeId[t+"_"+e]}getVertexList(){let t=[this.vertices.length];for(var e=0;e<this.vertices.length;e++)t[e]=this.vertices[e].id;return t}getEdgeList(){let t=Array(this.edges.length);for(var e=0;e<this.edges.length;e++)t[e]=[this.edges[e].sourceId,this.edges[e].targetId];return t}getAdjacencyMatrix(){let t=this.vertices.length,e=Array(t);for(var r=0;r<t;r++)e[r]=new Array(t),e[r].fill(0);for(r=0;r<this.edges.length;r++){let t=this.edges[r];e[t.sourceId][t.targetId]=1,e[t.targetId][t.sourceId]=1}return e}getComponentsAdjacencyMatrix(){let t=this.vertices.length,e=Array(t),r=this.getBridges();for(var i=0;i<t;i++)e[i]=new Array(t),e[i].fill(0);for(i=0;i<this.edges.length;i++){let t=this.edges[i];e[t.sourceId][t.targetId]=1,e[t.targetId][t.sourceId]=1}for(i=0;i<r.length;i++)e[r[i][0]][r[i][1]]=0,e[r[i][1]][r[i][0]]=0;return e}getSubgraphAdjacencyMatrix(t){let e=t.length,r=Array(e);for(var i=0;i<e;i++){r[i]=new Array(e),r[i].fill(0);for(var n=0;n<e;n++)i!==n&&this.hasEdge(t[i],t[n])&&(r[i][n]=1)}return r}getDistanceMatrix(){let t=this.vertices.length,e=this.getAdjacencyMatrix(),r=Array(t);for(var i=0;i<t;i++)r[i]=Array(t),r[i].fill(1/0);for(i=0;i<t;i++)for(var n=0;n<t;n++)1===e[i][n]&&(r[i][n]=1);for(var s=0;s<t;s++)for(i=0;i<t;i++)for(n=0;n<t;n++)r[i][n]>r[i][s]+r[s][n]&&(r[i][n]=r[i][s]+r[s][n]);return r}getSubgraphDistanceMatrix(t){let e=t.length,r=this.getSubgraphAdjacencyMatrix(t),i=Array(e);for(var n=0;n<e;n++)i[n]=Array(e),i[n].fill(1/0);for(n=0;n<e;n++)for(var s=0;s<e;s++)1===r[n][s]&&(i[n][s]=1);for(var c=0;c<e;c++)for(n=0;n<e;n++)for(s=0;s<e;s++)i[n][s]>i[n][c]+i[c][s]&&(i[n][s]=i[n][c]+i[c][s]);return i}getAdjacencyList(){let t=this.vertices.length,e=Array(t);for(var r=0;r<t;r++){e[r]=[];for(var i=0;i<t;i++)r!==i&&this.hasEdge(this.vertices[r].id,this.vertices[i].id)&&e[r].push(i)}return e}getSubgraphAdjacencyList(t){let e=t.length,r=Array(e);for(var i=0;i<e;i++){r[i]=Array();for(var n=0;n<e;n++)i!==n&&this.hasEdge(t[i],t[n])&&r[i].push(n)}return r}getBridges(){let t=this.vertices.length,e=new Array(t),r=new Array(t),i=new Array(t),n=new Array(t),s=this.getAdjacencyList(),c=Array();e.fill(!1),n.fill(null),this._time=0;for(var a=0;a<t;a++)e[a]||this._bridgeDfs(a,e,r,i,n,s,c);return c}traverseBF(t,e){let r=this.vertices.length,i=new Array(r);i.fill(!1);for(var n=[t];n.length>0;){let t=n.shift(),r=this.vertices[t];e(r);for(var s=0;s<r.neighbours.length;s++){let t=r.neighbours[s];i[t]||(i[t]=!0,n.push(t))}}}getTreeDepth(t,e){if(null===t||null===e)return 0;let r=this.vertices[t].getSpanningTreeNeighbours(e),i=0;for(var n=0;n<r.length;n++){let e=r[n],s=this.getTreeDepth(e,t);s>i&&(i=s)}return i+1}traverseTree(t,e,r,i=999999,n=!1,s=1,c=null){if(null===c&&(c=new Uint8Array(this.vertices.length)),s>i+1||1===c[t])return;c[t]=1;let a=this.vertices[t],o=a.getNeighbours(e);(!n||s>1)&&r(a);for(var l=0;l<o.length;l++)this.traverseTree(o[l],t,r,i,n,s+1,c)}kkLayout(t,e,r,i,n,s=.1,c=.1,a=2e3,o=50,l=1e9){let h=n;for(var C=t.length;C--;){var u=this.vertices[t[C]].neighbours.length}let g=this.getSubgraphDistanceMatrix(t),d=t.length,f=gt.polyCircumradius(500,d),p=gt.centralAngle(d),m=0,v=new Float32Array(d),b=new Float32Array(d),w=Array(d);for(C=d;C--;){let r=this.vertices[t[C]];r.positioned?(v[C]=r.position.x,b[C]=r.position.y):(v[C]=e.x+Math.cos(m)*f,b[C]=e.y+Math.sin(m)*f),w[C]=r.positioned,m+=p}let y=Array(d);for(C=d;C--;){y[C]=new Array(d);for(u=d;u--;)y[C][u]=n*g[C][u]}let O=Array(d);for(C=d;C--;){O[C]=Array(d);for(u=d;u--;)O[C][u]=h*Math.pow(g[C][u],-2)}let N,S,x,A,R,k,F,M=Array(d),E=new Float32Array(d),T=new Float32Array(d);for(C=d;C--;)M[C]=Array(d);for(C=d;C--;){N=v[C],S=b[C],x=0,A=0;let t=d;for(;t--;)C!==t&&(R=v[t],k=b[t],F=1/Math.sqrt((N-R)*(N-R)+(S-k)*(S-k)),M[C][t]=[O[C][t]*(N-R-y[C][t]*(N-R)*F),O[C][t]*(S-k-y[C][t]*(S-k)*F)],M[t][C]=M[C][t],x+=M[C][t][0],A+=M[C][t][1]);E[C]=x,T[C]=A}let I=function(t){return[E[t]*E[t]+T[t]*T[t],E[t],T[t]]},B=function(){let t=0,e=0,r=0,i=0;for(C=d;C--;){let[n,s,c]=I(C);n>t&&!1===w[C]&&(t=n,e=C,r=s,i=c)}return[e,t,r,i]},L=function(t,e,r){let i=0,n=0,s=0,c=v[t],a=b[t],o=y[t],l=O[t];for(C=d;C--;){if(C===t)continue;let e=v[C],r=b[C],h=o[C],u=l[C],g=(c-e)*(c-e),d=1/Math.pow(g+(a-r)*(a-r),1.5);i+=u*(1-h*(a-r)*(a-r)*d),n+=u*(1-h*g*d),s+=u*(h*(c-e)*(a-r)*d)}0===i&&(i=.1),0===n&&(n=.1),0===s&&(s=.1);let h=e/i+r/s;h/=s/i-n/s;let u=-(s*h+e)/i;v[t]+=u,b[t]+=h;let g,f,p,m,w,N=M[t];for(e=0,r=0,c=v[t],a=b[t],C=d;C--;)t!==C&&(g=v[C],f=b[C],p=N[C][0],m=N[C][1],w=1/Math.sqrt((c-g)*(c-g)+(a-f)*(a-f)),u=l[C]*(c-g-o[C]*(c-g)*w),h=l[C]*(a-f-o[C]*(a-f)*w),N[C]=[u,h],e+=u,r+=h,E[C]+=u-p,T[C]+=h-m);E[t]=e,T[t]=r},P=0,D=0,H=0,z=0,$=0,_=0;for(;l>s&&a>$;)for($++,[P,l,D,H]=B(),z=l,_=0;z>c&&o>_;)_++,L(P,D,H),[z,D,H]=I(P);for(C=d;C--;){let e=t[C],r=this.vertices[e];r.position.x=v[C],r.position.y=b[C],r.positioned=!0,r.forcePositioned=!0}}_bridgeDfs(t,e,r,i,n,s,c){e[t]=!0,r[t]=i[t]=++this._time;for(var a=0;a<s[t].length;a++){let o=s[t][a];e[o]?o!==n[t]&&(i[t]=Math.min(i[t],r[o])):(n[o]=t,this._bridgeDfs(o,e,r,i,n,s,c),i[t]=Math.min(i[t],i[o]),i[o]>r[t]&&c.push([t,o]))}}static getConnectedComponents(e){let r=e.length,i=new Array(r),n=new Array;i.fill(!1);for(var s=0;s<r;s++)if(!i[s]){let r=Array();i[s]=!0,r.push(s),t._ccGetDfs(s,i,e,r),r.length>1&&n.push(r)}return n}static getConnectedComponentCount(e){let r=e.length,i=new Array(r),n=0;i.fill(!1);for(var s=0;s<r;s++)i[s]||(i[s]=!0,n++,t._ccCountDfs(s,i,e));return n}static _ccCountDfs(e,r,i){for(var n=0;n<i[e].length;n++){i[e][n]&&!r[n]&&e!==n&&(r[n]=!0,t._ccCountDfs(n,r,i))}}static _ccGetDfs(e,r,i,n){for(var s=0;s<i[e].length;s++){i[e][s]&&!r[s]&&e!==s&&(r[s]=!0,n.push(s),t._ccGetDfs(s,r,i,n))}}};const vt=mt;var bt=class t{static getRings(e,r=!1){let i=e.getComponentsAdjacencyMatrix();if(0===i.length)return null;let n=vt.getConnectedComponents(i),s=Array();for(var c=0;c<n.length;c++){let i=n[c],l=e.getSubgraphAdjacencyMatrix([...i]),h=new Uint16Array(l.length),C=new Uint16Array(l.length);for(var a=0;a<l.length;a++){C[a]=0,h[a]=0;for(var o=0;o<l[a].length;o++)h[a]+=l[a][o]}let u=0;for(a=0;a<l.length;a++)for(o=a+1;o<l.length;o++)u+=l[a][o];let g=u-l.length+1,d=!0;for(a=0;a<h.length;a++)3!==h[a]&&(d=!1);if(d&&(g=2+u-l.length),1===g){s.push([...i]);continue}r&&(g=999);let{d:f,pe:p,pe_prime:m}=t.getPathIncludedDistanceMatrices(l),v=t.getRingCandidates(f,p,m),b=t.getSSSR(v,f,l,p,m,h,C,g);for(a=0;a<b.length;a++){let t=Array(b[a].size),e=0;for(let r of b[a])t[e++]=i[r];s.push(t)}}return s}static matrixToString(t){let e="";for(var r=0;r<t.length;r++){for(var i=0;i<t[r].length;i++)e+=t[r][i]+" ";e+="\n"}return e}static getPathIncludedDistanceMatrices(t){let e=t.length,r=Array(e),i=Array(e),n=Array(e);for(var s=0,c=0,a=0,o=e;o--;){r[o]=Array(e),i[o]=Array(e),n[o]=Array(e);for(var l=e;l--;)r[o][l]=o===l||1===t[o][l]?t[o][l]:Number.POSITIVE_INFINITY,1===r[o][l]?i[o][l]=[[[o,l]]]:i[o][l]=Array(),n[o][l]=Array()}for(var h=e;h--;)for(o=e;o--;)for(l=e;l--;){const t=r[o][l],e=r[o][h]+r[h][l];if(t>e){if(t===e+1)for(n[o][l]=[i[o][l].length],s=i[o][l].length;s--;)for(n[o][l][s]=[i[o][l][s].length],c=i[o][l][s].length;c--;)for(n[o][l][s][c]=[i[o][l][s][c].length],a=i[o][l][s][c].length;a--;)n[o][l][s][c][a]=[i[o][l][s][c][0],i[o][l][s][c][1]];else n[o][l]=Array();for(r[o][l]=e,i[o][l]=[[]],s=i[o][h][0].length;s--;)i[o][l][0].push(i[o][h][0][s]);for(s=i[h][l][0].length;s--;)i[o][l][0].push(i[h][l][0][s])}else if(t===e){if(i[o][h].length&&i[h][l].length)if(i[o][l].length){let t=Array();for(s=i[o][h][0].length;s--;)t.push(i[o][h][0][s]);for(s=i[h][l][0].length;s--;)t.push(i[h][l][0][s]);i[o][l].push(t)}else{let t=Array();for(s=i[o][h][0].length;s--;)t.push(i[o][h][0][s]);for(s=i[h][l][0].length;s--;)t.push(i[h][l][0][s]);i[o][l][0]=t}}else if(t===e-1){if(n[o][l].length){let t=Array();for(s=i[o][h][0].length;s--;)t.push(i[o][h][0][s]);for(s=i[h][l][0].length;s--;)t.push(i[h][l][0][s]);n[o][l].push(t)}else{let t=Array();for(s=i[o][h][0].length;s--;)t.push(i[o][h][0][s]);for(s=i[h][l][0].length;s--;)t.push(i[h][l][0][s]);n[o][l][0]=t}}}return{d:r,pe:i,pe_prime:n}}static getRingCandidates(t,e,r){let i=t.length,n=Array(),s=0;for(let c=0;c<i;c++)for(let a=0;a<i;a++)0===t[c][a]||1===e[c][a].length&&0===r[c][a]||(s=0!==r[c][a].length?2*(t[c][a]+.5):2*t[c][a],s!==1/0&&n.push([s,e[c][a],r[c][a]]));return n.sort((function(t,e){return t[0]-e[0]})),n}static getSSSR(e,r,i,n,s,c,a,o){let l=Array(),h=Array();for(let r=0;r<e.length;r++)if(e[r][0]%2!=0)for(let n=0;n<e[r][2].length;n++){let s=e[r][1][0].concat(e[r][2][n]);for(var C=0;C<s.length;C++)s[C][0].constructor===Array&&(s[C]=s[C][0]);let u=t.bondsToAtoms(s);if(t.getBondCount(u,i)!==u.size||t.pathSetsContain(l,u,s,h,c,a)||(l.push(u),h=h.concat(s)),l.length>o)return l}else for(let n=0;n<e[r][1].length-1;n++){let s=e[r][1][n].concat(e[r][1][n+1]);for(C=0;C<s.length;C++)s[C][0].constructor===Array&&(s[C]=s[C][0]);let u=t.bondsToAtoms(s);if(t.getBondCount(u,i)!==u.size||t.pathSetsContain(l,u,s,h,c,a)||(l.push(u),h=h.concat(s)),l.length>o)return l}return l}static getEdgeCount(t){let e=0,r=t.length;for(var i=r-1;i--;)for(var n=r;n--;)1===t[i][n]&&e++;return e}static getEdgeList(t){let e=t.length,r=Array();for(var i=e-1;i--;)for(var n=e;n--;)1===t[i][n]&&r.push([i,n]);return r}static bondsToAtoms(t){let e=new Set;for(var r=t.length;r--;)e.add(t[r][0]),e.add(t[r][1]);return e}static getBondCount(t,e){let r=0;for(let i of t)for(let n of t)i!==n&&(r+=e[i][n]);return r/2}static pathSetsContain(e,r,i,n,s,c){for(var a=e.length;a--;){if(t.isSupersetOf(r,e[a]))return!0;if(e[a].size===r.size&&t.areSetsEqual(e[a],r))return!0}let o=0,l=!1;for(a=i.length;a--;)for(var h=n.length;h--;)(i[a][0]===n[h][0]&&i[a][1]===n[h][1]||i[a][1]===n[h][0]&&i[a][0]===n[h][1])&&o++,o===i.length&&(l=!0);let C=!1;if(l)for(let t of r)if(c[t]<s[t]){C=!0;break}if(l&&!C)return!0;for(let t of r)c[t]++;return!1}static areSetsEqual(t,e){if(t.size!==e.size)return!1;for(let r of t)if(!e.has(r))return!1;return!0}static isSupersetOf(t,e){for(var r of e)if(!t.has(r))return!1;return!0}};var wt=class{constructor(t,e){this.colors=t,this.theme=this.colors[e]}getColor(t){return t&&(t=t.toUpperCase())in this.theme?this.theme[t]:this.theme.C}setTheme(t){this.colors.hasOwnProperty(t)&&(this.theme=this.colors[t])}};var yt=class{static extend(){let t=this,e={},r=!1,i=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(r=arguments[0],i++);let s=function(i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r&&"[object Object]"===Object.prototype.toString.call(i[n])?e[n]=t.extend(!0,e[n],i[n]):e[n]=i[n])};for(;i<n;i++){s(arguments[i])}return e}};const Ot=U,Nt=X,St=tt,xt=ct;et();const At=at,Rt=nt(),kt=it(),Ft=rt(),Mt=ut,Et=mt,Tt=bt,It=wt,Bt=yt;var Lt=class{constructor(t){this.graph=null,this.doubleBondConfigCount=0,this.doubleBondConfig=null,this.ringIdCounter=0,this.ringConnectionIdCounter=0,this.canvasWrapper=null,this.totalOverlapScore=0,this.defaultOptions={width:500,height:500,scale:0,bondThickness:1,bondLength:30,shortBondLength:.8,bondSpacing:.17*30,atomVisualization:"default",isomeric:!0,debug:!1,terminalCarbons:!1,explicitHydrogens:!0,overlapSensitivity:.42,overlapResolutionIterations:1,compactDrawing:!0,fontFamily:"Arial, Helvetica, sans-serif",fontSizeLarge:11,fontSizeSmall:3,padding:10,experimentalSSSR:!1,kkThreshold:.1,kkInnerThreshold:.1,kkMaxIteration:2e4,kkMaxInnerIteration:50,kkMaxEnergy:1e9,weights:{colormap:null,additionalPadding:20,sigma:10,interval:0,opacity:1},themes:{dark:{C:"#fff",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#aaa",BACKGROUND:"#141414"},light:{C:"#222",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#666",BACKGROUND:"#fff"},oldschool:{C:"#000",O:"#000",N:"#000",F:"#000",CL:"#000",BR:"#000",I:"#000",P:"#000",S:"#000",B:"#000",SI:"#000",H:"#000",BACKGROUND:"#fff"},solarized:{C:"#586e75",O:"#dc322f",N:"#268bd2",F:"#859900",CL:"#16a085",BR:"#cb4b16",I:"#6c71c4",P:"#d33682",S:"#b58900",B:"#2aa198",SI:"#2aa198",H:"#657b83",BACKGROUND:"#fff"},"solarized-dark":{C:"#93a1a1",O:"#dc322f",N:"#268bd2",F:"#859900",CL:"#16a085",BR:"#cb4b16",I:"#6c71c4",P:"#d33682",S:"#b58900",B:"#2aa198",SI:"#2aa198",H:"#839496",BACKGROUND:"#fff"},matrix:{C:"#678c61",O:"#2fc079",N:"#4f7e7e",F:"#90d762",CL:"#82d967",BR:"#23755a",I:"#409931",P:"#c1ff8a",S:"#faff00",B:"#50b45a",SI:"#409931",H:"#426644",BACKGROUND:"#fff"},github:{C:"#24292f",O:"#cf222e",N:"#0969da",F:"#2da44e",CL:"#6fdd8b",BR:"#bc4c00",I:"#8250df",P:"#bf3989",S:"#d4a72c",B:"#fb8f44",SI:"#bc4c00",H:"#57606a",BACKGROUND:"#fff"},carbon:{C:"#161616",O:"#da1e28",N:"#0f62fe",F:"#198038",CL:"#007d79",BR:"#fa4d56",I:"#8a3ffc",P:"#ff832b",S:"#f1c21b",B:"#8a3800",SI:"#e67e22",H:"#525252",BACKGROUND:"#fff"},cyberpunk:{C:"#ea00d9",O:"#ff3131",N:"#0abdc6",F:"#00ff9f",CL:"#00fe00",BR:"#fe9f20",I:"#ff00ff",P:"#fe7f00",S:"#fcee0c",B:"#ff00ff",SI:"#ffffff",H:"#913cb1",BACKGROUND:"#fff"},gruvbox:{C:"#665c54",O:"#cc241d",N:"#458588",F:"#98971a",CL:"#79740e",BR:"#d65d0e",I:"#b16286",P:"#af3a03",S:"#d79921",B:"#689d6a",SI:"#427b58",H:"#7c6f64",BACKGROUND:"#fbf1c7"},"gruvbox-dark":{C:"#ebdbb2",O:"#cc241d",N:"#458588",F:"#98971a",CL:"#b8bb26",BR:"#d65d0e",I:"#b16286",P:"#fe8019",S:"#d79921",B:"#8ec07c",SI:"#83a598",H:"#bdae93",BACKGROUND:"#282828"},custom:{C:"#222",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#666",BACKGROUND:"#fff"}}},this.opts=Bt.extend(!0,this.defaultOptions,t),this.opts.halfBondSpacing=this.opts.bondSpacing/2,this.opts.bondLengthSq=this.opts.bondLength*this.opts.bondLength,this.opts.halfFontSizeLarge=this.opts.fontSizeLarge/2,this.opts.quarterFontSizeLarge=this.opts.fontSizeLarge/4,this.opts.fifthFontSizeSmall=this.opts.fontSizeSmall/5,this.theme=this.opts.themes.dark}draw(t,e,r="light",i=!1){this.initDraw(t,r,i),this.infoOnly||(this.themeManager=new It(this.opts.themes,r),this.canvasWrapper=new Mt(e,this.themeManager,this.opts)),i||(this.processGraph(),this.canvasWrapper.scale(this.graph.vertices),this.drawEdges(this.opts.debug),this.drawVertices(this.opts.debug),this.canvasWrapper.reset(),this.opts.debug&&(console.log(this.graph),console.log(this.rings),console.log(this.ringConnections)))}edgeRingCount(t){let e=this.graph.edges[t],r=this.graph.vertices[e.sourceId],i=this.graph.vertices[e.targetId];return Math.min(r.value.rings.length,i.value.rings.length)}getBridgedRings(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isBridged&&t.push(this.rings[e]);return t}getFusedRings(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isFused&&t.push(this.rings[e]);return t}getSpiros(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isSpiro&&t.push(this.rings[e]);return t}printRingInfo(){let t="";for(var e=0;e<this.rings.length;e++){const r=this.rings[e];t+=r.id+";",t+=r.members.length+";",t+=r.neighbours.length+";",t+=r.isSpiro?"true;":"false;",t+=r.isFused?"true;":"false;",t+=r.isBridged?"true;":"false;",t+=r.rings.length+";",t+="\n"}return t}rotateDrawing(){let t=0,e=0,r=0;for(var i=0;i<this.graph.vertices.length;i++){let s=this.graph.vertices[i];if(s.value.isDrawn)for(var n=i+1;n<this.graph.vertices.length;n++){let c=this.graph.vertices[n];if(!c.value.isDrawn)continue;let a=s.position.distanceSq(c.position);a>r&&(r=a,t=i,e=n)}}let s=-St.subtract(this.graph.vertices[t].position,this.graph.vertices[e].position).angle();if(!isNaN(s)){let t=s%.523599;t<.2617995?s-=t:s+=.523599-t;for(i=0;i<this.graph.vertices.length;i++)i!==e&&this.graph.vertices[i].position.rotateAround(s,this.graph.vertices[e].position);for(i=0;i<this.rings.length;i++)this.rings[i].center.rotateAround(s,this.graph.vertices[e].position)}}getTotalOverlapScore(){return this.totalOverlapScore}getRingCount(){return this.rings.length}hasBridgedRing(){return this.bridgedRing}getHeavyAtomCount(){let t=0;for(var e=0;e<this.graph.vertices.length;e++)"H"!==this.graph.vertices[e].value.element&&t++;return t}getMolecularFormula(t=null){let e="",r=new Map,i=null===t?this.graph:new Et(t,this.opts.isomeric);for(var n=0;n<i.vertices.length;n++){let t=i.vertices[n].value;if(r.has(t.element)?r.set(t.element,r.get(t.element)+1):r.set(t.element,1),t.bracket&&!t.bracket.chirality&&(r.has("H")?r.set("H",r.get("H")+t.bracket.hcount):r.set("H",t.bracket.hcount)),!t.bracket){let e=Rt.maxBonds[t.element]-t.bondCount;t.isPartOfAromaticRing&&e--,r.has("H")?r.set("H",r.get("H")+e):r.set("H",e)}}if(r.has("C")){let t=r.get("C");e+="C"+(t>1?t:""),r.delete("C")}if(r.has("H")){let t=r.get("H");e+="H"+(t>1?t:""),r.delete("H")}return Object.keys(Rt.atomicNumbers).sort().map((t=>{if(r.has(t)){let i=r.get(t);e+=t+(i>1?i:"")}})),e}getRingbondType(t,e){if(t.value.getRingbondCount()<1||e.value.getRingbondCount()<1)return null;for(var r=0;r<t.value.ringbonds.length;r++)for(var i=0;i<e.value.ringbonds.length;i++)if(t.value.ringbonds[r].id===e.value.ringbonds[i].id)return"-"===t.value.ringbonds[r].bondType?e.value.ringbonds[i].bond:t.value.ringbonds[r].bond;return null}initDraw(t,e,r,i){this.data=t,this.infoOnly=r,this.ringIdCounter=0,this.ringConnectionIdCounter=0,this.graph=new Et(t,this.opts.isomeric),this.rings=Array(),this.ringConnections=Array(),this.originalRings=Array(),this.originalRingConnections=Array(),this.bridgedRing=!1,this.doubleBondConfigCount=null,this.doubleBondConfig=null,this.highlight_atoms=i,this.initRings(),this.initHydrogens()}processGraph(){this.position(),this.restoreRingInformation(),this.resolvePrimaryOverlaps();let t=this.getOverlapScore();this.totalOverlapScore=this.getOverlapScore().total;for(var e=0;e<this.opts.overlapResolutionIterations;e++)for(var r=0;r<this.graph.edges.length;r++){let e=this.graph.edges[r];if(this.isEdgeRotatable(e)){let r=this.graph.getTreeDepth(e.sourceId,e.targetId),i=this.graph.getTreeDepth(e.targetId,e.sourceId),n=e.targetId,s=e.sourceId;if(r>i&&(n=e.sourceId,s=e.targetId),this.getSubtreeOverlapScore(s,n,t.vertexScores).value>this.opts.overlapSensitivity){let e=this.graph.vertices[n],r=this.graph.vertices[s],i=r.getNeighbours(n);if(1===i.length){let t=this.graph.vertices[i[0]],n=t.position.getRotateAwayFromAngle(e.position,r.position,Ot.toRad(120));this.rotateSubtree(t.id,r.id,n,r.position);let s=this.getOverlapScore().total;s>this.totalOverlapScore?this.rotateSubtree(t.id,r.id,-n,r.position):this.totalOverlapScore=s}else if(2===i.length){if(0!==r.value.rings.length&&0!==e.value.rings.length)continue;let t=this.graph.vertices[i[0]],n=this.graph.vertices[i[1]];if(1===t.value.rings.length&&1===n.value.rings.length){if(t.value.rings[0]!==n.value.rings[0])continue}else{if(0!==t.value.rings.length||0!==n.value.rings.length)continue;{let i=t.position.getRotateAwayFromAngle(e.position,r.position,Ot.toRad(120)),s=n.position.getRotateAwayFromAngle(e.position,r.position,Ot.toRad(120));this.rotateSubtree(t.id,r.id,i,r.position),this.rotateSubtree(n.id,r.id,s,r.position);let c=this.getOverlapScore().total;c>this.totalOverlapScore?(this.rotateSubtree(t.id,r.id,-i,r.position),this.rotateSubtree(n.id,r.id,-s,r.position)):this.totalOverlapScore=c}}}t=this.getOverlapScore()}}}this.resolveSecondaryOverlaps(t.scores),this.opts.isomeric&&this.annotateStereochemistry(),this.opts.compactDrawing&&"default"===this.opts.atomVisualization&&this.initPseudoElements(),this.rotateDrawing()}initRings(){let t=new Map;for(var e=this.graph.vertices.length-1;e>=0;e--){let i=this.graph.vertices[e];if(0!==i.value.ringbonds.length)for(var r=0;r<i.value.ringbonds.length;r++){let e=i.value.ringbonds[r].id,n=i.value.ringbonds[r].bond;if(t.has(e)){let s=i.id,c=t.get(e)[0],a=t.get(e)[1],o=new At(s,c,1);o.setBondType(a||n||"-");let l=this.graph.addEdge(o),h=this.graph.vertices[c];i.addRingbondChild(c,r),i.value.addNeighbouringElement(h.value.element),h.addRingbondChild(s,r),h.value.addNeighbouringElement(i.value.element),i.edges.push(l),h.edges.push(l),t.delete(e)}else t.set(e,[i.id,n])}}let i=Tt.getRings(this.graph,this.opts.experimentalSSSR);if(null!==i){for(e=0;e<i.length;e++){let t=[...i[e]],n=this.addRing(new kt(t));for(r=0;r<t.length;r++)this.graph.vertices[t[r]].value.rings.push(n)}for(e=0;e<this.rings.length-1;e++)for(r=e+1;r<this.rings.length;r++){let t=this.rings[e],i=this.rings[r],n=new Ft(t,i);n.vertices.size>0&&this.addRingConnection(n)}for(e=0;e<this.rings.length;e++){let t=this.rings[e];t.neighbours=Ft.getNeighbours(this.ringConnections,t.id)}for(e=0;e<this.rings.length;e++){let t=this.rings[e];this.graph.vertices[t.members[0]].value.addAnchoredRing(t.id)}for(this.backupRingInformation();this.rings.length>0;){let t=-1;for(e=0;e<this.rings.length;e++){let r=this.rings[e];this.isPartOfBridgedRing(r.id)&&!r.isBridged&&(t=r.id)}if(-1===t)break;let r=this.getRing(t),i=this.getBridgedRingRings(r.id);this.bridgedRing=!0,this.createBridgedRing(i,r.members[0]);for(e=0;e<i.length;e++)this.removeRing(i[e])}}}initHydrogens(){if(!this.opts.explicitHydrogens)for(var t=0;t<this.graph.vertices.length;t++){let e=this.graph.vertices[t];if("H"!==e.value.element)continue;let r=this.graph.vertices[e.neighbours[0]];r.value.hasHydrogen=!0,(!r.value.isStereoCenter||r.value.rings.length<2&&!r.value.bridgedRing||r.value.bridgedRing&&r.value.originalRings.length<2)&&(e.value.isDrawn=!1)}}getBridgedRingRings(t){let e=Array(),r=this,i=function(t){let n=r.getRing(t);e.push(t);for(var s=0;s<n.neighbours.length;s++){let c=n.neighbours[s];-1===e.indexOf(c)&&c!==t&&Ft.isBridge(r.ringConnections,r.graph.vertices,t,c)&&i(c)}};return i(t),Nt.unique(e)}isPartOfBridgedRing(t){for(var e=0;e<this.ringConnections.length;e++)if(this.ringConnections[e].containsRing(t)&&this.ringConnections[e].isBridge(this.graph.vertices))return!0;return!1}createBridgedRing(t,e){let r=new Set,i=new Set,n=new Set;for(var s=0;s<t.length;s++){let e=this.getRing(t[s]);e.isPartOfBridged=!0;for(var c=0;c<e.members.length;c++)i.add(e.members[c]);for(c=0;c<e.neighbours.length;c++){let r=e.neighbours[c];-1===t.indexOf(r)&&n.add(e.neighbours[c])}}let a=new Set;for(let e of i){let i=this.graph.vertices[e],n=Nt.intersection(t,i.value.rings);1===i.value.rings.length||1===n.length?r.add(i.id):a.add(i.id)}Array();let o=Array();for(let t of a){let e=this.graph.vertices[t],i=!1;for(let t=0;t<e.edges.length;t++)1===this.edgeRingCount(e.edges[t])&&(i=!0);i?(e.value.isBridgeNode=!0,r.add(e.id)):(e.value.isBridge=!0,r.add(e.id))}let l=new kt([...r]);this.addRing(l),l.isBridged=!0,l.neighbours=[...n];for(s=0;s<t.length;s++)l.rings.push(this.getRing(t[s]).clone());for(s=0;s<l.members.length;s++)this.graph.vertices[l.members[s]].value.bridgedRing=l.id;for(s=0;s<o.length;s++){this.graph.vertices[o[s]].value.rings=Array()}for(let e of r){let r=this.graph.vertices[e];r.value.rings=Nt.removeAll(r.value.rings,t),r.value.rings.push(l.id)}for(s=0;s<t.length;s++)for(c=s+1;c<t.length;c++)this.removeRingConnectionsBetween(t[s],t[c]);for(let e of n){let r=this.getRingConnections(e,t);for(c=0;c<r.length;c++)this.getRingConnection(r[c]).updateOther(l.id,e);this.getRing(e).neighbours.push(l.id)}return l}areVerticesInSameRing(t,e){for(var r=0;r<t.value.rings.length;r++)for(var i=0;i<e.value.rings.length;i++)if(t.value.rings[r]===e.value.rings[i])return!0;return!1}getCommonRings(t,e){let r=Array();for(var i=0;i<t.value.rings.length;i++)for(var n=0;n<e.value.rings.length;n++)t.value.rings[i]==e.value.rings[n]&&r.push(t.value.rings[i]);return r}getLargestOrAromaticCommonRing(t,e){let r=this.getCommonRings(t,e),i=0,n=null;for(var s=0;s<r.length;s++){let t=this.getRing(r[s]),e=t.getSize();if(t.isBenzeneLike(this.graph.vertices))return t;e>i&&(i=e,n=t)}return n}getVerticesAt(t,e,r){let i=Array();for(var n=0;n<this.graph.vertices.length;n++){let s=this.graph.vertices[n];s.id!==r&&s.positioned&&(t.distanceSq(s.position)<=e*e&&i.push(s.id))}return i}getClosestVertex(t){let e=99999,r=null;for(var i=0;i<this.graph.vertices.length;i++){let n=this.graph.vertices[i];if(n.id===t.id)continue;let s=t.position.distanceSq(n.position);s<e&&(e=s,r=n)}return r}addRing(t){return t.id=this.ringIdCounter++,this.rings.push(t),t.id}removeRing(t){this.rings=this.rings.filter((function(e){return e.id!==t})),this.ringConnections=this.ringConnections.filter((function(e){return e.firstRingId!==t&&e.secondRingId!==t}));for(var e=0;e<this.rings.length;e++){let r=this.rings[e];r.neighbours=r.neighbours.filter((function(e){return e!==t}))}}getRing(t){for(var e=0;e<this.rings.length;e++)if(this.rings[e].id==t)return this.rings[e]}addRingConnection(t){return t.id=this.ringConnectionIdCounter++,this.ringConnections.push(t),t.id}removeRingConnection(t){this.ringConnections=this.ringConnections.filter((function(e){return e.id!==t}))}removeRingConnectionsBetween(t,e){let r=Array();for(var i=0;i<this.ringConnections.length;i++){let n=this.ringConnections[i];(n.firstRingId===t&&n.secondRingId===e||n.firstRingId===e&&n.secondRingId===t)&&r.push(n.id)}for(i=0;i<r.length;i++)this.removeRingConnection(r[i])}getRingConnection(t){for(var e=0;e<this.ringConnections.length;e++)if(this.ringConnections[e].id==t)return this.ringConnections[e]}getRingConnections(t,e){let r=Array();for(var i=0;i<this.ringConnections.length;i++){let s=this.ringConnections[i];for(var n=0;n<e.length;n++){let i=e[n];(s.firstRingId===t&&s.secondRingId===i||s.firstRingId===i&&s.secondRingId===t)&&r.push(s.id)}}return r}getOverlapScore(){let t=0,e=new Float32Array(this.graph.vertices.length);for(var r=0;r<this.graph.vertices.length;r++)e[r]=0;for(r=0;r<this.graph.vertices.length;r++)for(var i=this.graph.vertices.length;--i>r;){let n=this.graph.vertices[r],s=this.graph.vertices[i];if(!n.value.isDrawn||!s.value.isDrawn)continue;let c=St.subtract(n.position,s.position).lengthSq();if(c<this.opts.bondLengthSq){let n=(this.opts.bondLength-Math.sqrt(c))/this.opts.bondLength;t+=n,e[r]+=n,e[i]+=n}}let n=Array();for(r=0;r<this.graph.vertices.length;r++)n.push({id:r,score:e[r]});return n.sort((function(t,e){return e.score-t.score})),{total:t,scores:n,vertexScores:e}}chooseSide(t,e,r){let i=t.getNeighbours(e.id),n=e.getNeighbours(t.id),s=i.length,c=n.length,a=Nt.merge(i,n),o=[0,0];for(var l=0;l<a.length;l++){this.graph.vertices[a[l]].position.sameSideAs(t.position,e.position,r[0])?o[0]++:o[1]++}let h=[0,0];for(l=0;l<this.graph.vertices.length;l++){this.graph.vertices[l].position.sameSideAs(t.position,e.position,r[0])?h[0]++:h[1]++}return{totalSideCount:h,totalPosition:h[0]>h[1]?0:1,sideCount:o,position:o[0]>o[1]?0:1,anCount:s,bnCount:c}}setRingCenter(t){let e=t.getSize(),r=new St(0,0);for(var i=0;i<e;i++)r.add(this.graph.vertices[t.members[i]].position);t.center=r.divide(e)}getSubringCenter(t,e){let r=e.value.originalRings,i=t.center,n=Number.MAX_VALUE;for(var s=0;s<r.length;s++)for(var c=0;c<t.rings.length;c++)r[s]===t.rings[c].id&&t.rings[c].getSize()<n&&(i=t.rings[c].center,n=t.rings[c].getSize());return i}drawEdges(t){let e=this,r=Array(this.graph.edges.length);if(r.fill(!1),this.graph.traverseBF(0,(function(i){let n=e.graph.getEdges(i.id);for(var s=0;s<n.length;s++){let i=n[s];r[i]||(r[i]=!0,e.drawEdge(i,t))}})),!this.bridgedRing)for(var i=0;i<this.rings.length;i++){let t=this.rings[i];this.isRingAromatic(t)&&this.canvasWrapper.drawAromaticityRing(t)}}drawEdge(t,e){let r=this,i=this.graph.edges[t],n=this.graph.vertices[i.sourceId],s=this.graph.vertices[i.targetId],c=n.value.element,a=s.value.element;if(!(n.value.isDrawn&&s.value.isDrawn||"default"!==this.opts.atomVisualization))return;let o=n.position,l=s.position,h=this.getEdgeNormals(i),C=Nt.clone(h);if(C[0].multiplyScalar(10).add(o),C[1].multiplyScalar(10).add(o),"="===i.bondType||"="===this.getRingbondType(n,s)||i.isPartOfAromaticRing&&this.bridgedRing){let t=this.areVerticesInSameRing(n,s),e=this.chooseSide(n,s,C);if(t){let t=this.getLargestOrAromaticCommonRing(n,s).center;h[0].multiplyScalar(r.opts.bondSpacing),h[1].multiplyScalar(r.opts.bondSpacing);let e=null;e=t.sameSideAs(n.position,s.position,St.add(o,h[0]))?new xt(St.add(o,h[0]),St.add(l,h[0]),c,a):new xt(St.add(o,h[1]),St.add(l,h[1]),c,a),e.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),i.isPartOfAromaticRing?this.canvasWrapper.drawLine(e,!0):this.canvasWrapper.drawLine(e),this.canvasWrapper.drawLine(new xt(o,l,c,a))}else if(i.center||n.isTerminal()&&s.isTerminal()){h[0].multiplyScalar(r.opts.halfBondSpacing),h[1].multiplyScalar(r.opts.halfBondSpacing);let t=new xt(St.add(o,h[0]),St.add(l,h[0]),c,a),e=new xt(St.add(o,h[1]),St.add(l,h[1]),c,a);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e)}else if(0==e.anCount&&e.bnCount>1||0==e.bnCount&&e.anCount>1){h[0].multiplyScalar(r.opts.halfBondSpacing),h[1].multiplyScalar(r.opts.halfBondSpacing);let t=new xt(St.add(o,h[0]),St.add(l,h[0]),c,a),e=new xt(St.add(o,h[1]),St.add(l,h[1]),c,a);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e)}else if(e.sideCount[0]>e.sideCount[1]){h[0].multiplyScalar(r.opts.bondSpacing),h[1].multiplyScalar(r.opts.bondSpacing);let t=new xt(St.add(o,h[0]),St.add(l,h[0]),c,a);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new xt(o,l,c,a))}else if(e.sideCount[0]<e.sideCount[1]){h[0].multiplyScalar(r.opts.bondSpacing),h[1].multiplyScalar(r.opts.bondSpacing);let t=new xt(St.add(o,h[1]),St.add(l,h[1]),c,a);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new xt(o,l,c,a))}else if(e.totalSideCount[0]>e.totalSideCount[1]){h[0].multiplyScalar(r.opts.bondSpacing),h[1].multiplyScalar(r.opts.bondSpacing);let t=new xt(St.add(o,h[0]),St.add(l,h[0]),c,a);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new xt(o,l,c,a))}else if(e.totalSideCount[0]<=e.totalSideCount[1]){h[0].multiplyScalar(r.opts.bondSpacing),h[1].multiplyScalar(r.opts.bondSpacing);let t=new xt(St.add(o,h[1]),St.add(l,h[1]),c,a);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new xt(o,l,c,a))}}else if("#"===i.bondType){h[0].multiplyScalar(r.opts.bondSpacing/1.5),h[1].multiplyScalar(r.opts.bondSpacing/1.5);let t=new xt(St.add(o,h[0]),St.add(l,h[0]),c,a),e=new xt(St.add(o,h[1]),St.add(l,h[1]),c,a);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e),this.canvasWrapper.drawLine(new xt(o,l,c,a))}else if("."===i.bondType);else{let t=n.value.isStereoCenter,e=s.value.isStereoCenter;"up"===i.wedge?this.canvasWrapper.drawWedge(new xt(o,l,c,a,t,e)):"down"===i.wedge?this.canvasWrapper.drawDashedWedge(new xt(o,l,c,a,t,e)):this.canvasWrapper.drawLine(new xt(o,l,c,a,t,e))}if(e){let e=St.midpoint(o,l);this.canvasWrapper.drawDebugText(e.x,e.y,"e: "+t)}}drawVertices(t){var e=this.graph.vertices.length;for(e=0;e<this.graph.vertices.length;e++){let r=this.graph.vertices[e],i=r.value,n=0,s=0,c=r.value.bondCount,a=i.element,o=Rt.maxBonds[a]-c,l=r.getTextDirection(this.graph.vertices),h=!(!this.opts.terminalCarbons&&"C"===a&&!i.hasAttachedPseudoElements)&&r.isTerminal(),C="C"===i.element;if("N"===i.element&&i.isPartOfAromaticRing&&(o=0),i.bracket&&(o=i.bracket.hcount,n=i.bracket.charge,s=i.bracket.isotope),"allballs"===this.opts.atomVisualization)this.canvasWrapper.drawBall(r.position.x,r.position.y,a);else if(i.isDrawn&&(!C||i.drawExplicit||h||i.hasAttachedPseudoElements)||1===this.graph.vertices.length)"default"===this.opts.atomVisualization?this.canvasWrapper.drawText(r.position.x,r.position.y,a,o,l,h,n,s,this.graph.vertices.length,i.getAttachedPseudoElements()):"balls"===this.opts.atomVisualization&&this.canvasWrapper.drawBall(r.position.x,r.position.y,a);else if(2===r.getNeighbourCount()&&1==r.forcePositioned){let t=this.graph.vertices[r.neighbours[0]].position,e=this.graph.vertices[r.neighbours[1]].position,i=St.threePointangle(r.position,t,e);Math.abs(Math.PI-i)<.1&&this.canvasWrapper.drawPoint(r.position.x,r.position.y,a)}if(t){let t="v: "+r.id+" "+Nt.print(i.ringbonds);this.canvasWrapper.drawDebugText(r.position.x,r.position.y,t)}}if(this.opts.debug)for(e=0;e<this.rings.length;e++){let t=this.rings[e].center;this.canvasWrapper.drawDebugPoint(t.x,t.y,"r: "+this.rings[e].id)}}position(){let t=null;for(var e=0;e<this.graph.vertices.length;e++)if(null!==this.graph.vertices[e].value.bridgedRing){t=this.graph.vertices[e];break}for(e=0;e<this.rings.length;e++)this.rings[e].isBridged&&(t=this.graph.vertices[this.rings[e].members[0]]);this.rings.length>0&&null===t&&(t=this.graph.vertices[this.rings[0].members[0]]),null===t&&(t=this.graph.vertices[0]),this.createNextBond(t,null,0)}backupRingInformation(){this.originalRings=Array(),this.originalRingConnections=Array();for(var t=0;t<this.rings.length;t++)this.originalRings.push(this.rings[t]);for(t=0;t<this.ringConnections.length;t++)this.originalRingConnections.push(this.ringConnections[t]);for(t=0;t<this.graph.vertices.length;t++)this.graph.vertices[t].value.backupRings()}restoreRingInformation(){let t=this.getBridgedRings();this.rings=Array(),this.ringConnections=Array();for(var e=0;e<t.length;e++){let i=t[e];for(var r=0;r<i.rings.length;r++){let t=i.rings[r];this.originalRings[t.id].center=t.center}}for(e=0;e<this.originalRings.length;e++)this.rings.push(this.originalRings[e]);for(e=0;e<this.originalRingConnections.length;e++)this.ringConnections.push(this.originalRingConnections[e]);for(e=0;e<this.graph.vertices.length;e++)this.graph.vertices[e].value.restoreRings()}createRing(t,e=null,r=null,i=null){if(t.positioned)return;e=e||new St(0,0);let n=t.getOrderedNeighbours(this.ringConnections),s=r?St.subtract(r.position,e).angle():0,c=Ot.polyCircumradius(this.opts.bondLength,t.getSize()),a=Ot.centralAngle(t.getSize());t.centralAngle=a;let o=s,l=this,h=r?r.id:null;if(-1===t.members.indexOf(h)&&(r&&(r.positioned=!1),h=t.members[0]),t.isBridged){this.graph.kkLayout(t.members.slice(),e,r.id,t,this.opts.bondLength,this.opts.kkThreshold,this.opts.kkInnerThreshold,this.opts.kkMaxIteration,this.opts.kkMaxInnerIteration,this.opts.kkMaxEnergy),t.positioned=!0,this.setRingCenter(t),e=t.center;for(var C=0;C<t.rings.length;C++)this.setRingCenter(t.rings[C])}else t.eachMember(this.graph.vertices,(function(r){let i=l.graph.vertices[r];i.positioned||i.setPosition(e.x+Math.cos(o)*c,e.y+Math.sin(o)*c),o+=a,(!t.isBridged||t.rings.length<3)&&(i.angle=o,i.positioned=!0)}),h,i?i.id:null);t.positioned=!0,t.center=e;for(C=0;C<n.length;C++){let r=this.getRing(n[C].neighbour);if(r.positioned)continue;let i=Ft.getVertices(this.ringConnections,t.id,r.id);if(2===i.length){t.isFused=!0,r.isFused=!0;let n=this.graph.vertices[i[0]],s=this.graph.vertices[i[1]],c=St.midpoint(n.position,s.position),a=St.normals(n.position,s.position);a[0].normalize(),a[1].normalize();let o=Ot.polyCircumradius(this.opts.bondLength,r.getSize()),l=Ot.apothem(o,r.getSize());a[0].multiplyScalar(l).add(c),a[1].multiplyScalar(l).add(c);let h=a[0];St.subtract(e,a[1]).lengthSq()>St.subtract(e,a[0]).lengthSq()&&(h=a[1]);let C=St.subtract(n.position,h),u=St.subtract(s.position,h);-1===C.clockwise(u)?r.positioned||this.createRing(r,h,n,s):r.positioned||this.createRing(r,h,s,n)}else if(1===i.length){t.isSpiro=!0,r.isSpiro=!0;let n=this.graph.vertices[i[0]],s=St.subtract(e,n.position);s.invert(),s.normalize();let c=Ot.polyCircumradius(this.opts.bondLength,r.getSize());s.multiplyScalar(c),s.add(n.position),r.positioned||this.createRing(r,s,n)}}for(C=0;C<t.members.length;C++){let e=this.graph.vertices[t.members[C]],r=e.neighbours;for(var u=0;u<r.length;u++){let t=this.graph.vertices[r[u]];t.positioned||(t.value.isConnectedToRing=!0,this.createNextBond(t,e,0))}}}rotateSubtree(t,e,r,i){let n=this;this.graph.traverseTree(t,e,(function(t){t.position.rotateAround(r,i);for(var e=0;e<t.value.anchoredRings.length;e++){let s=n.rings[t.value.anchoredRings[e]];s&&s.center.rotateAround(r,i)}}))}getSubtreeOverlapScore(t,e,r){let i=this,n=0,s=new St(0,0),c=0;return this.graph.traverseTree(t,e,(function(t){if(!t.value.isDrawn)return;let e=r[t.id];e>i.opts.overlapSensitivity&&(n+=e,c++);let a=i.graph.vertices[t.id].position.clone();a.multiplyScalar(e),s.add(a)})),s.divide(n),{value:n/c,center:s}}getCurrentCenterOfMass(){let t=new St(0,0),e=0;for(var r=0;r<this.graph.vertices.length;r++){let i=this.graph.vertices[r];i.positioned&&(t.add(i.position),e++)}return t.divide(e)}getCurrentCenterOfMassInNeigbourhood(t,e=2*this.opts.bondLength){let r=new St(0,0),i=0,n=e*e;for(var s=0;s<this.graph.vertices.length;s++){let e=this.graph.vertices[s];e.positioned&&t.distanceSq(e.position)<n&&(r.add(e.position),i++)}return r.divide(i)}resolvePrimaryOverlaps(){let t=Array(),e=Array(this.graph.vertices.length);for(var r=0;r<this.rings.length;r++){let s=this.rings[r];for(var i=0;i<s.members.length;i++){let r=this.graph.vertices[s.members[i]];if(e[r.id])continue;e[r.id]=!0;let c=this.getNonRingNeighbours(r.id);if(c.length>1){let e=Array();for(var n=0;n<r.value.rings.length;n++)e.push(r.value.rings[n]);t.push({common:r,rings:e,vertices:c})}else if(1===c.length&&2===r.value.rings.length){let e=Array();for(n=0;n<r.value.rings.length;n++)e.push(r.value.rings[n]);t.push({common:r,rings:e,vertices:c})}}}for(r=0;r<t.length;r++){let e=t[r];if(2===e.vertices.length){let t=e.vertices[0],r=e.vertices[1];if(!t.value.isDrawn||!r.value.isDrawn)continue;let i=(2*Math.PI-this.getRing(e.rings[0]).getAngle())/6;this.rotateSubtree(t.id,e.common.id,i,e.common.position),this.rotateSubtree(r.id,e.common.id,-i,e.common.position);let n=this.getOverlapScore(),s=this.getSubtreeOverlapScore(t.id,e.common.id,n.vertexScores),c=this.getSubtreeOverlapScore(r.id,e.common.id,n.vertexScores),a=s.value+c.value;this.rotateSubtree(t.id,e.common.id,-2*i,e.common.position),this.rotateSubtree(r.id,e.common.id,2*i,e.common.position),n=this.getOverlapScore(),s=this.getSubtreeOverlapScore(t.id,e.common.id,n.vertexScores),c=this.getSubtreeOverlapScore(r.id,e.common.id,n.vertexScores),s.value+c.value>a&&(this.rotateSubtree(t.id,e.common.id,2*i,e.common.position),this.rotateSubtree(r.id,e.common.id,-2*i,e.common.position))}else 1===e.vertices.length&&e.rings.length}}resolveSecondaryOverlaps(t){for(var e=0;e<t.length;e++)if(t[e].score>this.opts.overlapSensitivity){let r=this.graph.vertices[t[e].id];if(r.isTerminal()){let t=this.getClosestVertex(r);if(t){let e=null;e=t.isTerminal()?0===t.id?this.graph.vertices[1].position:t.previousPosition:0===t.id?this.graph.vertices[1].position:t.position;let i=0===r.id?this.graph.vertices[1].position:r.previousPosition;r.position.rotateAwayFrom(e,i,Ot.toRad(20))}}}}getLastVertexWithAngle(t){let e=0,r=null;for(;!e&&t;)r=this.graph.vertices[t],e=r.angle,t=r.parentVertexId;return r}createNextBond(t,e=null,r=0,i=!1,n=!1){if(t.positioned&&!n)return;let s=!1;if(e){let r=this.graph.getEdge(t.id,e.id);"/"!==r.bondType&&"\\"!==r.bondType||++this.doubleBondConfigCount%2!=1||null===this.doubleBondConfig&&(this.doubleBondConfig=r.bondType,s=!0,null===e.parentVertexId&&t.value.branchBond&&("/"===this.doubleBondConfig?this.doubleBondConfig="\\":"\\"===this.doubleBondConfig&&(this.doubleBondConfig="/")))}if(!n)if(e)if(e.value.rings.length>0){let r=e.neighbours,i=null,n=new St(0,0);if(null===e.value.bridgedRing&&e.value.rings.length>1)for(var c=0;c<r.length;c++){let t=this.graph.vertices[r[c]];if(Nt.containsAll(t.value.rings,e.value.rings)){i=t;break}}if(null===i){for(c=0;c<r.length;c++){let t=this.graph.vertices[r[c]];t.positioned&&this.areVerticesInSameRing(t,e)&&n.add(St.subtract(t.position,e.position))}n.invert().normalize().multiplyScalar(this.opts.bondLength).add(e.position)}else n=i.position.clone().rotateAround(Math.PI,e.position);t.previousPosition=e.position,t.setPositionFromVector(n),t.positioned=!0}else{let i=new St(this.opts.bondLength,0);i.rotate(r),i.add(e.position),t.setPositionFromVector(i),t.previousPosition=e.position,t.positioned=!0}else{let e=new St(this.opts.bondLength,0);e.rotate(Ot.toRad(-60)),t.previousPosition=e,t.setPosition(this.opts.bondLength,0),t.angle=Ot.toRad(-60),null===t.value.bridgedRing&&(t.positioned=!0)}if(null!==t.value.bridgedRing){let e=this.getRing(t.value.bridgedRing);if(!e.positioned){let r=St.subtract(t.previousPosition,t.position);r.invert(),r.normalize();let i=Ot.polyCircumradius(this.opts.bondLength,e.members.length);r.multiplyScalar(i),r.add(t.position),this.createRing(e,r,t)}}else if(t.value.rings.length>0){let e=this.getRing(t.value.rings[0]);if(!e.positioned){let r=St.subtract(t.previousPosition,t.position);r.invert(),r.normalize();let i=Ot.polyCircumradius(this.opts.bondLength,e.getSize());r.multiplyScalar(i),r.add(t.position),this.createRing(e,r,t)}}else{t.value.isStereoCenter;let r=t.getNeighbours(),n=Array();for(c=0;c<r.length;c++)this.graph.vertices[r[c]].value.isDrawn&&n.push(r[c]);e&&(n=Nt.remove(n,e.id));let a=t.getAngle();if(1===n.length){let r=this.graph.vertices[n[0]];if("#"===t.value.bondType||e&&"#"===e.value.bondType||"="===t.value.bondType&&e&&0===e.value.rings.length&&"="===e.value.bondType&&"-"!==t.value.branchBond){if(t.value.drawExplicit=!1,e){this.graph.getEdge(t.id,e.id).center=!0}this.graph.getEdge(t.id,r.id).center=!0,("#"===t.value.bondType||e&&"#"===e.value.bondType)&&(r.angle=0),r.drawExplicit=!0,this.createNextBond(r,t,a+r.angle)}else if(e&&e.value.rings.length>0){let e=Ot.toRad(60),i=-e,n=new St(this.opts.bondLength,0),s=new St(this.opts.bondLength,0);n.rotate(e).add(t.position),s.rotate(i).add(t.position);let c=this.getCurrentCenterOfMass(),o=n.distanceSq(c),l=s.distanceSq(c);r.angle=o<l?i:e,this.createNextBond(r,t,a+r.angle)}else{let n=t.angle;if(e&&e.neighbours.length>3)n=n>0?Math.min(1.0472,n):n<0?Math.max(-1.0472,n):1.0472;else if(!n){n=this.getLastVertexWithAngle(t.id).angle,n||(n=1.0472)}if(e&&!s){let e=this.graph.getEdge(t.id,r.id).bondType;"/"===e?("/"===this.doubleBondConfig||"\\"===this.doubleBondConfig&&(n=-n),this.doubleBondConfig=null):"\\"===e&&("/"===this.doubleBondConfig?n=-n:this.doubleBondConfig,this.doubleBondConfig=null)}r.angle=i?n:-n,this.createNextBond(r,t,a+r.angle)}}else if(2===n.length){let r=t.angle;r||(r=1.0472);let i=this.graph.getTreeDepth(n[0],t.id),s=this.graph.getTreeDepth(n[1],t.id),c=this.graph.vertices[n[0]],o=this.graph.vertices[n[1]];c.value.subtreeDepth=i,o.value.subtreeDepth=s;let l=this.graph.getTreeDepth(e?e.id:null,t.id);e&&(e.value.subtreeDepth=l);let h=0,C=1;"C"===o.value.element&&"C"!==c.value.element&&s>1&&i<5?(h=1,C=0):"C"!==o.value.element&&"C"===c.value.element&&i>1&&s<5?(h=0,C=1):s>i&&(h=1,C=0);let u=this.graph.vertices[n[h]],g=this.graph.vertices[n[C]];this.graph.getEdge(t.id,u.id),this.graph.getEdge(t.id,g.id);let d=!1;l<i&&l<s&&(d=!0),g.angle=r,u.angle=-r,"\\"===this.doubleBondConfig?"\\"===g.value.branchBond&&(g.angle=-r,u.angle=r):"/"===this.doubleBondConfig&&"/"===g.value.branchBond&&(g.angle=-r,u.angle=r),this.createNextBond(g,t,a+g.angle,d),this.createNextBond(u,t,a+u.angle,d)}else if(3===n.length){let r=this.graph.getTreeDepth(n[0],t.id),i=this.graph.getTreeDepth(n[1],t.id),s=this.graph.getTreeDepth(n[2],t.id),c=this.graph.vertices[n[0]],o=this.graph.vertices[n[1]],l=this.graph.vertices[n[2]];c.value.subtreeDepth=r,o.value.subtreeDepth=i,l.value.subtreeDepth=s,i>r&&i>s?(c=this.graph.vertices[n[1]],o=this.graph.vertices[n[0]],l=this.graph.vertices[n[2]]):s>r&&s>i&&(c=this.graph.vertices[n[2]],o=this.graph.vertices[n[0]],l=this.graph.vertices[n[1]]),e&&e.value.rings.length<1&&c.value.rings.length<1&&o.value.rings.length<1&&l.value.rings.length<1&&1===this.graph.getTreeDepth(o.id,t.id)&&1===this.graph.getTreeDepth(l.id,t.id)&&this.graph.getTreeDepth(c.id,t.id)>1?(c.angle=-t.angle,t.angle>=0?(o.angle=Ot.toRad(30),l.angle=Ot.toRad(90)):(o.angle=-Ot.toRad(30),l.angle=-Ot.toRad(90)),this.createNextBond(c,t,a+c.angle),this.createNextBond(o,t,a+o.angle),this.createNextBond(l,t,a+l.angle)):(c.angle=0,o.angle=Ot.toRad(90),l.angle=-Ot.toRad(90),this.createNextBond(c,t,a+c.angle),this.createNextBond(o,t,a+o.angle),this.createNextBond(l,t,a+l.angle))}else if(4===n.length){let e=this.graph.getTreeDepth(n[0],t.id),r=this.graph.getTreeDepth(n[1],t.id),i=this.graph.getTreeDepth(n[2],t.id),s=this.graph.getTreeDepth(n[3],t.id),c=this.graph.vertices[n[0]],o=this.graph.vertices[n[1]],l=this.graph.vertices[n[2]],h=this.graph.vertices[n[3]];c.value.subtreeDepth=e,o.value.subtreeDepth=r,l.value.subtreeDepth=i,h.value.subtreeDepth=s,r>e&&r>i&&r>s?(c=this.graph.vertices[n[1]],o=this.graph.vertices[n[0]],l=this.graph.vertices[n[2]],h=this.graph.vertices[n[3]]):i>e&&i>r&&i>s?(c=this.graph.vertices[n[2]],o=this.graph.vertices[n[0]],l=this.graph.vertices[n[1]],h=this.graph.vertices[n[3]]):s>e&&s>r&&s>i&&(c=this.graph.vertices[n[3]],o=this.graph.vertices[n[0]],l=this.graph.vertices[n[1]],h=this.graph.vertices[n[2]]),c.angle=-Ot.toRad(36),o.angle=Ot.toRad(36),l.angle=-Ot.toRad(108),h.angle=Ot.toRad(108),this.createNextBond(c,t,a+c.angle),this.createNextBond(o,t,a+o.angle),this.createNextBond(l,t,a+l.angle),this.createNextBond(h,t,a+h.angle)}}}getCommonRingbondNeighbour(t){let e=t.neighbours;for(var r=0;r<e.length;r++){let i=this.graph.vertices[e[r]];if(Nt.containsAll(i.value.rings,t.value.rings))return i}return null}isPointInRing(t){for(var e=0;e<this.rings.length;e++){let r=this.rings[e];if(!r.positioned)continue;let i=Ot.polyCircumradius(this.opts.bondLength,r.getSize()),n=i*i;if(t.distanceSq(r.center)<n)return!0}return!1}isEdgeInRing(t){let e=this.graph.vertices[t.sourceId],r=this.graph.vertices[t.targetId];return this.areVerticesInSameRing(e,r)}isEdgeRotatable(t){let e=this.graph.vertices[t.sourceId],r=this.graph.vertices[t.targetId];return"-"===t.bondType&&(!e.isTerminal()&&!r.isTerminal()&&!(e.value.rings.length>0&&r.value.rings.length>0&&this.areVerticesInSameRing(e,r)))}isRingAromatic(t){for(var e=0;e<t.members.length;e++){if(!this.graph.vertices[t.members[e]].value.isPartOfAromaticRing)return!1}return!0}getEdgeNormals(t){let e=this.graph.vertices[t.sourceId].position,r=this.graph.vertices[t.targetId].position;return St.units(e,r)}getNonRingNeighbours(t){let e=Array(),r=this.graph.vertices[t],i=r.neighbours;for(var n=0;n<i.length;n++){let t=this.graph.vertices[i[n]];0===Nt.intersection(r.value.rings,t.value.rings).length&&0==t.value.isBridge&&e.push(t)}return e}annotateStereochemistry(){for(var t=0;t<this.graph.vertices.length;t++){let n=this.graph.vertices[t];if(!n.value.isStereoCenter)continue;let s=n.getNeighbours(),c=s.length,a=Array(c);for(var e=0;e<c;e++){let t=new Uint8Array(this.graph.vertices.length),i=Array(Array());t[n.id]=1,this.visitStereochemistry(s[e],n.id,t,i,10,0);for(var r=0;r<i.length;r++)i[r].sort((function(t,e){return e-t}));a[e]=[e,i]}let o=0,l=0;for(e=0;e<a.length;e++){a[e][1].length>o&&(o=a[e][1].length);for(r=0;r<a[e][1].length;r++)a[e][1][r].length>l&&(l=a[e][1][r].length)}for(e=0;e<a.length;e++){let t=o-a[e][1].length;for(r=0;r<t;r++)a[e][1].push([]);a[e][1].push([s[e]]);for(r=0;r<a[e][1].length;r++){let t=l-a[e][1][r].length;for(var i=0;i<t;i++)a[e][1][r].push(0)}}a.sort((function(t,e){for(var r=0;r<t[1].length;r++)for(var i=0;i<t[1][r].length;i++){if(t[1][r][i]>e[1][r][i])return-1;if(t[1][r][i]<e[1][r][i])return 1}return 0}));let h=new Uint8Array(c);for(e=0;e<c;e++)h[e]=a[e][0],n.value.priority=e;let C=this.graph.vertices[s[h[0]]].position,u=this.graph.vertices[s[h[1]]].position,g=this.graph.vertices[s[h[2]]].position,d=C.relativeClockwise(u,n.position);C.relativeClockwise(g,n.position);let f=-1===d,p="@"===n.value.bracket.chirality?-1:1,m=Ot.parityOfPermutation(h)*p==1?"R":"S",v="down",b="up";(f&&"R"!==m||!f&&"S"!==m)&&(n.value.hydrogenDirection="up",v="up",b="down"),n.value.hasHydrogen&&(this.graph.getEdge(n.id,s[h[h.length-1]]).wedge=v);let w=new Array(s.length-1),y=n.value.rings.length>1&&n.value.hasHydrogen,O=n.value.hasHydrogen?1:0;for(e=0;e<h.length-O;e++){w[e]=new Uint32Array(2);let t=this.graph.vertices[s[h[e]]];w[e][0]+=t.value.isStereoCenter?0:1e5,w[e][0]+=this.areVerticesInSameRing(t,n)?0:1e4,w[e][0]+=t.value.isHeteroAtom()?1e3:0,w[e][0]-=0===t.value.subtreeDepth?1e3:0,w[e][0]+=1e3-t.value.subtreeDepth,w[e][1]=s[h[e]]}if(w.sort((function(t,e){return t[0]>e[0]?-1:t[0]<e[0]?1:0})),!y){let t=w[0][1];if(n.value.hasHydrogen)this.graph.getEdge(n.id,t).wedge=b;else{let r=b;for(e=h.length-1;e>=0&&(r=r===v?b:v,s[h[e]]!==t);e--);this.graph.getEdge(n.id,t).wedge=r}}n.value.chirality=m}}visitStereochemistry(t,e,r,i,n,s,c=0){r[t]=1;let a=this.graph.vertices[t],o=a.value.getAtomicNumber();i.length<=s&&i.push(Array());for(var l=0;l<this.graph.getEdge(t,e).weight;l++)i[s].push(1e3*c+o);let h=this.graph.vertices[t].neighbours;for(l=0;l<h.length;l++)1!==r[h[l]]&&s<n-1&&this.visitStereochemistry(h[l],t,r.slice(),i,n,s+1,o);if(s<n-1){let e=0;for(l=0;l<h.length;l++)e+=this.graph.getEdge(t,h[l]).weight;for(l=0;l<a.value.getMaxBonds()-e;l++)i.length<=s+1&&i.push(Array()),i[s+1].push(1e3*o+1)}}initPseudoElements(){for(var t=0;t<this.graph.vertices.length;t++){const r=this.graph.vertices[t],i=r.neighbours;let n=Array(i.length);for(var e=0;e<i.length;e++)n[e]=this.graph.vertices[i[e]];if(r.getNeighbourCount()<3||r.value.rings.length>0)continue;if("P"===r.value.element)continue;if("C"===r.value.element&&3===n.length&&"N"===n[0].value.element&&"N"===n[1].value.element&&"N"===n[2].value.element)continue;let s=0,c=0;for(e=0;e<n.length;e++){let t=n[e],r=t.value.element,i=t.getNeighbourCount();"C"!==r&&"H"!==r&&1===i&&s++,i>1&&c++}if(c>1||s<2)continue;let a=null;for(e=0;e<n.length;e++){let t=n[e];t.getNeighbourCount()>1&&(a=t)}for(e=0;e<n.length;e++){let t=n[e];if(t.getNeighbourCount()>1)continue;t.value.isDrawn=!1;let i=Rt.maxBonds[t.value.element]-t.value.bondCount,s="";t.value.bracket&&(i=t.value.bracket.hcount,s=t.value.bracket.charge||0),r.value.attachPseudoElement(t.value.element,a?a.value.element:null,i,s)}}for(t=0;t<this.graph.vertices.length;t++){const r=this.graph.vertices[t],i=r.value,n=i.element;if("C"===n||"H"===n||!i.isDrawn)continue;const s=r.neighbours;let c=Array(s.length);for(e=0;e<s.length;e++)c[e]=this.graph.vertices[s[e]];for(e=0;e<c.length;e++){let t=c[e].value;if(!t.hasAttachedPseudoElements||2!==t.getAttachedPseudoElementsCount())continue;const i=t.getAttachedPseudoElements();i.hasOwnProperty("0O")&&i.hasOwnProperty("3C")&&(t.isDrawn=!1,r.value.attachPseudoElement("Ac","",0))}}}};const Pt=ct,Dt=tt,Ht=U;var zt=class t{constructor(t,e,r,i=!0){if(this.svg="string"==typeof e||e instanceof String?document.getElementById(e):e,this.container=null,this.opts=r,this.uid=function(t){for(var e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=r.length,n=0;n<t;n++)e+=r.charAt(Math.floor(Math.random()*i));return e}(5),this.gradientId=0,this.backgroundItems=[],this.paths=[],this.vertices=[],this.gradients=[],this.highlights=[],this.drawingWidth=0,this.drawingHeight=0,this.halfBondThickness=this.opts.bondThickness/2,this.themeManager=t,this.maskElements=[],this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE,this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,i)for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);this.style=document.createElementNS("http://www.w3.org/2000/svg","style"),this.style.appendChild(document.createTextNode(`\n                .element {\n                    font: ${this.opts.fontSizeLarge}pt ${this.opts.fontFamily};\n                }\n                .sub {\n                    font: ${this.opts.fontSizeSmall}pt ${this.opts.fontFamily};\n                }\n            `)),this.svg?this.svg.appendChild(this.style):(this.container=document.createElementNS("http://www.w3.org/2000/svg","g"),container.appendChild(this.style))}constructSvg(){let t=document.createElementNS("http://www.w3.org/2000/svg","defs"),e=document.createElementNS("http://www.w3.org/2000/svg","mask"),r=document.createElementNS("http://www.w3.org/2000/svg","g"),i=document.createElementNS("http://www.w3.org/2000/svg","g"),n=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","g"),c=this.paths,a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttributeNS(null,"x",this.minX),a.setAttributeNS(null,"y",this.minY),a.setAttributeNS(null,"width",this.maxX-this.minX),a.setAttributeNS(null,"height",this.maxY-this.minY),a.setAttributeNS(null,"fill","white"),e.appendChild(a),e.setAttributeNS(null,"id",this.uid+"-text-mask");for(let t of c)n.appendChild(t);for(let t of this.backgroundItems)r.appendChild(t);for(let t of this.highlights)i.appendChild(t);for(let t of this.vertices)s.appendChild(t);for(let t of this.maskElements)e.appendChild(t);for(let e of this.gradients)t.appendChild(e);if(n.setAttributeNS(null,"mask","url(#"+this.uid+"-text-mask)"),this.updateViewbox(this.opts.scale),r.setAttributeNS(null,"style",`transform: translateX(${this.minX}px) translateY(${this.minY}px)`),!this.svg)return this.container.appendChild(t),this.container.appendChild(e),this.container.appendChild(r),this.container.appendChild(n),this.container.appendChild(s),this.container;this.svg.appendChild(t),this.svg.appendChild(e),this.svg.appendChild(r),this.svg.appendChild(i),this.svg.appendChild(n),this.svg.appendChild(s)}addLayer(t){this.backgroundItems.push(t.firstChild)}createGradient(t){let e=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),r=this.uid+"-line-"+this.gradientId++,i=t.getLeftVector(),n=t.getRightVector(),s=i.x,c=i.y,a=n.x,o=n.y;e.setAttributeNS(null,"id",r),e.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),e.setAttributeNS(null,"x1",s),e.setAttributeNS(null,"y1",c),e.setAttributeNS(null,"x2",a),e.setAttributeNS(null,"y2",o);let l=document.createElementNS("http://www.w3.org/2000/svg","stop");l.setAttributeNS(null,"stop-color",this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),l.setAttributeNS(null,"offset","20%");let h=document.createElementNS("http://www.w3.org/2000/svg","stop");return h.setAttributeNS(null,"stop-color",this.themeManager.getColor(t.getRightElement()||this.themeManager.getColor("C"))),h.setAttributeNS(null,"offset","100%"),e.appendChild(l),e.appendChild(h),this.gradients.push(e),r}createSubSuperScripts(t,e){let r=document.createElementNS("http://www.w3.org/2000/svg","tspan");return r.setAttributeNS(null,"baseline-shift",e),r.appendChild(document.createTextNode(t)),r.setAttributeNS(null,"class","sub"),r}static createUnicodeCharge(e){return 1===e?"":-1===e?"":e>1?t.createUnicodeSuperscript(e)+"":e<-1?t.createUnicodeSuperscript(e)+"":""}determineDimensions(t){for(var e=0;e<t.length;e++){if(!t[e].value.isDrawn)continue;let r=t[e].position;this.maxX<r.x&&(this.maxX=r.x),this.maxY<r.y&&(this.maxY=r.y),this.minX>r.x&&(this.minX=r.x),this.minY>r.y&&(this.minY=r.y)}let r=this.opts.padding;this.maxX+=r,this.maxY+=r,this.minX-=r,this.minY-=r,this.drawingWidth=this.maxX-this.minX,this.drawingHeight=this.maxY-this.minY}updateViewbox(t){let e=this.minX,r=this.minY,i=this.maxX-this.minX,n=this.maxY-this.minY;if(t<=0)if(i>n){let t=i-n;n=i,r-=t/2}else{let t=n-i;i=n,e-=t/2}else this.svg&&(this.svg.style.width=t*i+"px",this.svg.style.height=t*n+"px");this.svg.setAttributeNS(null,"viewBox",`${e} ${r} ${i} ${n}`)}drawBall(t,e,r){let i=this.opts.bondLength/4.5;t-i<this.minX&&(this.minX=t-i),t+i>this.maxX&&(this.maxX=t+i),e-i<this.minY&&(this.minY=e-i),e+i>this.maxY&&(this.maxY=e+i);let n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttributeNS(null,"cx",t),n.setAttributeNS(null,"cy",e),n.setAttributeNS(null,"r",i),n.setAttributeNS(null,"fill",this.themeManager.getColor(r)),this.vertices.push(n)}drawWedge(t){let e=t.getLeftVector().clone(),r=t.getRightVector().clone(),i=Dt.normals(e,r);i[0].normalize(),i[1].normalize();let n=e,s=r;t.getRightChiral()&&(n=r,s=e);let c=Dt.add(n,Dt.multiplyScalar(i[0],this.halfBondThickness)),a=Dt.add(s,Dt.multiplyScalar(i[0],3+this.opts.fontSizeLarge/4)),o=Dt.add(s,Dt.multiplyScalar(i[1],3+this.opts.fontSizeLarge/4)),l=Dt.add(n,Dt.multiplyScalar(i[1],this.halfBondThickness)),h=document.createElementNS("http://www.w3.org/2000/svg","polygon"),C=this.createGradient(t,e.x,e.y,r.x,r.y);h.setAttributeNS(null,"points",`${c.x},${c.y} ${a.x},${a.y} ${o.x},${o.y} ${l.x},${l.y}`),h.setAttributeNS(null,"fill",`url('#${C}')`),this.paths.push(h)}drawAtomHighlight(t,e,r="#03fc9d"){let i=document.createElementNS("http://www.w3.org/2000/svg","circle");i.setAttributeNS(null,"cx",t),i.setAttributeNS(null,"cy",e),i.setAttributeNS(null,"r",this.opts.bondLength/3),i.setAttributeNS(null,"fill",r),this.highlights.push(i)}drawDashedWedge(t){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let e,r,i=t.getLeftVector().clone(),n=t.getRightVector().clone(),s=Dt.normals(i,n);s[0].normalize(),s[1].normalize(),t.getRightChiral()?(e=n,r=i):(e=i,r=n);let c=Dt.subtract(r,e).normalize(),a=t.getLength(),o=1.25/(a/(this.opts.bondLength/10)),l=this.createGradient(t);for(let t=0;t<1;t+=o){let r=Dt.multiplyScalar(c,t*a),i=Dt.add(e,r),n=this.opts.fontSizeLarge/2*t,o=Dt.multiplyScalar(s[0],n);i.subtract(o);let h=i.clone();h.add(Dt.multiplyScalar(o,2)),this.drawLine(new Pt(i,h),null,l)}}drawDebugPoint(t,e,r="",i="#f00"){let n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttributeNS(null,"cx",t),n.setAttributeNS(null,"cy",e),n.setAttributeNS(null,"r","2"),n.setAttributeNS(null,"fill","#f00"),this.vertices.push(n),this.drawDebugText(t,e,r)}drawDebugText(t,e,r){let i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttributeNS(null,"x",t),i.setAttributeNS(null,"y",e),i.setAttributeNS(null,"class","debug"),i.setAttributeNS(null,"fill","#ff0000"),i.setAttributeNS(null,"style","\n                font: 5px Droid Sans, sans-serif;\n            "),i.appendChild(document.createTextNode(r)),this.vertices.push(i)}drawRing(t,e,r){let i=document.createElementNS("http://www.w3.org/2000/svg","circle"),n=Ht.apothemFromSideLength(this.opts.bondLength,r);i.setAttributeNS(null,"cx",t),i.setAttributeNS(null,"cy",e),i.setAttributeNS(null,"r",n-this.opts.bondSpacing),i.setAttributeNS(null,"stroke",this.themeManager.getColor("C")),i.setAttributeNS(null,"stroke-width",this.opts.bondThickness),i.setAttributeNS(null,"fill","none"),this.paths.push(i)}drawLine(t,e=!1,r=null,i="round"){this.opts;let n=[["stroke-width",this.opts.bondThickness],["stroke-linecap",i],["stroke-dasharray",e?"5, 5":"none"]],s=t.getLeftVector(),c=t.getRightVector(),a=s.x,o=s.y,l=c.x,h=c.y,C=n.map((t=>t.join(":"))).join(";"),u=document.createElementNS("http://www.w3.org/2000/svg","line");u.setAttributeNS(null,"x1",a),u.setAttributeNS(null,"y1",o),u.setAttributeNS(null,"x2",l),u.setAttributeNS(null,"y2",h),u.setAttributeNS(null,"style",C),this.paths.push(u),null==r&&(r=this.createGradient(t,a,o,l,h)),u.setAttributeNS(null,"stroke",`url('#${r}')`)}drawPoint(t,e,r){let i=.75;t-i<this.minX&&(this.minX=t-i),t+i>this.maxX&&(this.maxX=t+i),e-i<this.minY&&(this.minY=e-i),e+i>this.maxY&&(this.maxY=e+i);let n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttributeNS(null,"cx",t),n.setAttributeNS(null,"cy",e),n.setAttributeNS(null,"r","1.5"),n.setAttributeNS(null,"fill","black"),this.maskElements.push(n);let s=document.createElementNS("http://www.w3.org/2000/svg","circle");s.setAttributeNS(null,"cx",t),s.setAttributeNS(null,"cy",e),s.setAttributeNS(null,"r",i),s.setAttributeNS(null,"fill",this.themeManager.getColor(r)),this.vertices.push(s)}drawText(e,r,i,n,s,c,a,o,l,h={}){let C=[],u=i;0!==a&&null!==a&&(u+=t.createUnicodeCharge(a)),0!==o&&null!==o&&(u=t.createUnicodeSuperscript(o)+u),C.push([u,i]),1===n?C.push(["H","H"]):n>1&&C.push(["H"+t.createUnicodeSubscript(n),"H"]),1===a&&"N"===i&&h.hasOwnProperty("0O")&&h.hasOwnProperty("0O-1")&&(h={"0O":{element:"O",count:2,hydrogenCount:0,previousElement:"C",charge:""}},a=0);for(let e in h){if(!h.hasOwnProperty(e))continue;let r=h[e],i=r.element;r.count>1&&(i+=t.createUnicodeSubscript(r.count)),""!==r.charge&&(i+=t.createUnicodeCharge(a)),C.push([i,r.element]),1===r.hydrogenCount?C.push(["H","H"]):r.hydrogenCount>1&&C.push(["H"+t.createUnicodeSubscript(r.hydrogenCount),"H"])}this.write(C,s,e,r,1===l)}write(e,r,i,n,s){let c=t.measureText(e[0][1],this.opts.fontSizeLarge,this.opts.fontFamily);"left"===r&&e[0][0]!==e[0][1]&&(c.width*=2),s?(i+c.width*e.length>this.maxX&&(this.maxX=i+c.width*e.length),i-c.width/2<this.minX&&(this.minX=i-c.width/2),n-c.height<this.minY&&(this.minY=n-c.height),n+c.height>this.maxY&&(this.maxY=n+c.height)):("right"!==r?(i+c.width*e.length>this.maxX&&(this.maxX=i+c.width*e.length),i-c.width*e.length<this.minX&&(this.minX=i-c.width*e.length)):"left"!==r&&(i+c.width*e.length>this.maxX&&(this.maxX=i+c.width*e.length),i-c.width/2<this.minX&&(this.minX=i-c.width/2)),n-c.height<this.minY&&(this.minY=n-c.height),n+c.height>this.maxY&&(this.maxY=n+c.height),"down"===r&&n+.8*c.height*e.length>this.maxY&&(this.maxY=n+.8*c.height*e.length),"up"===r&&n-.8*c.height*e.length<this.minY&&(this.minY=n-.8*c.height*e.length));let a=i,o=n,l=document.createElementNS("http://www.w3.org/2000/svg","text");l.setAttributeNS(null,"class","element");let h=document.createElementNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill","#ffffff"),"left"===r&&(e=e.reverse()),"right"!==r&&"down"!==r&&"up"!==r||(i-=c.width/2),"left"===r&&(i+=c.width/2),e.forEach(((t,e)=>{const i=t[0],n=t[1];let s=document.createElementNS("http://www.w3.org/2000/svg","tspan");s.setAttributeNS(null,"fill",this.themeManager.getColor(n)),s.textContent=i,"up"!==r&&"down"!==r||(s.setAttributeNS(null,"x","0px"),"up"===r?s.setAttributeNS(null,"y",`-${.9*e}em`):s.setAttributeNS(null,"y",.9*e+"em")),l.appendChild(s)})),l.setAttributeNS(null,"data-direction",r),"left"===r||"right"===r?(l.setAttributeNS(null,"dominant-baseline","alphabetic"),l.setAttributeNS(null,"y","0.36em")):l.setAttributeNS(null,"dominant-baseline","central"),"left"===r&&l.setAttributeNS(null,"text-anchor","end"),h.appendChild(l),h.setAttributeNS(null,"style",`transform: translateX(${i}px) translateY(${n}px)`);let C=.75*this.opts.fontSizeLarge;e[0][1].length>1&&(C=1.1*this.opts.fontSizeLarge);let u=document.createElementNS("http://www.w3.org/2000/svg","circle");u.setAttributeNS(null,"cx",a),u.setAttributeNS(null,"cy",o),u.setAttributeNS(null,"r",C),u.setAttributeNS(null,"fill","black"),this.maskElements.push(u),this.vertices.push(h)}toCanvas(t,e,r){("string"==typeof t||t instanceof String)&&(t=document.getElementById(t));let i=new Image;i.onload=function(){t.width=e,t.height=r,t.getContext("2d").drawImage(i,0,0,e,r)},i.src="data:image/svg+xml;charset-utf-8,"+encodeURIComponent(this.svg.outerHTML)}static createUnicodeSubscript(t){let e="";return t.toString().split("").forEach((t=>{e+=["","","","","","","","","",""][parseInt(t)]})),e}static createUnicodeSuperscript(t){let e="";return t.toString().split("").forEach((t=>{parseInt(t)&&(e+=["","","","","","","","","",""][parseInt(t)])})),e}static replaceNumbersWithSubscript(t){let e={0:"",1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:""};for(const[r,i]of Object.entries(e))t=t.replaceAll(r,i);return t}static measureText(t,e,r,i=.9){const n=document.createElement("canvas").getContext("2d");n.font=`${e}pt ${r}`;let s=n.measureText(t),c=Math.abs(s.actualBoundingBoxLeft)+Math.abs(s.actualBoundingBoxRight);return{width:s.width>c?s.width:c,height:(Math.abs(s.actualBoundingBoxAscent)+Math.abs(s.actualBoundingBoxAscent))*i}}static svgToCanvas(t,e,r,i,n=null){t.setAttributeNS(null,"width",r),t.setAttributeNS(null,"height",i);let s=new Image;return s.onload=function(){e.width=r,e.height=i;let t=e.getContext("2d");t.imageSmoothingEnabled=!1,t.drawImage(s,0,0,r,i),n&&n(e)},s.onerror=function(t){console.log(t)},s.src="data:image/svg+xml;charset-utf-8,"+encodeURIComponent(t.outerHTML),e}static svgToImg(t,e,r,i){let n=document.createElement("canvas");this.svgToCanvas(t,n,r,i,(t=>{e.src=n.toDataURL("image/png")}))}static writeText(e,r,i,n,s=Number.MAX_SAFE_INTEGER){let c=document.createElementNS("http://www.w3.org/2000/svg","svg"),a=document.createElementNS("http://www.w3.org/2000/svg","style");a.appendChild(document.createTextNode(`\n        .text {\n            font: ${i}pt ${n};\n            dominant-baseline: ideographic;\n        }\n    `)),c.appendChild(a);let o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttributeNS(null,"class","text");let l=0,h=0,C=[];return e.split("\n").forEach((e=>{let r=t.measureText(e,i,n,1);if(r.width>=s){let r=0,c=0,a=e.split(" "),o=0;for(let e=0;e<a.length;e++){let l=t.measureText(a[e],i,n,1);r+l.width>s&&(C.push({text:a.slice(o,e).join(" "),width:r,height:c}),r=0,c=0,o=e),l.height>c&&(c=l.height),r+=l.width}o<a.length&&C.push({text:a.slice(o,a.length).join(" "),width:r,height:c})}else C.push({text:e,width:r.width,height:r.height})})),C.forEach(((t,e)=>{h+=t.height;let i=document.createElementNS("http://www.w3.org/2000/svg","tspan");i.setAttributeNS(null,"fill",r.getColor("C")),i.textContent=t.text,i.setAttributeNS(null,"x","0px"),i.setAttributeNS(null,"y",`${h}px`),o.appendChild(i),t.width>l&&(l=t.width)})),c.appendChild(o),{svg:c,width:l,height:h}}};var $t=function(t){function e(t,e){var r=t.length,i=0;if(0===r||r>0&&r-1 in t)for(;i<r&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break}function r(t){var e=parseInt(t).toString(16);return 1==e.length?"0"+e:e}function i(t,e,i,n){return void 0===(n=parseInt(n))||255===n?"#"+r(t)+r(e)+r(i):0!==n&&"rgba("+t+","+e+","+i+","+n/255+")"}function n(t,e,r){return"M"+t+" "+e+"h"+r}let s=function(t){var r="";return e(t,(function(t,s){if(!1!==(t=i.apply(null,t.split(",")))){var c,a=[],o=1;e(s,(function(){c&&this[1]===c[1]&&this[0]===c[0]+o?o++:(c&&(a.push(n(c[0],c[1],o)),o=1),c=this)})),a.push(n(c[0],c[1],o)),r+=function(t,e){return'<path stroke="'+t+'" d="'+e+'" />\n'}(t,a.join(""))}})),r}(function(t){var e={},r=t.data,i=r.length,n=t.width;t.height;for(var s,c=0,a=0,o=0;o<i;o+=4)r[o+3]>0&&(e[s=r[o]+","+r[o+1]+","+r[o+2]+","+r[o+3]]=e[s]||[],c=o/4%n,a=Math.floor(o/4/n),e[s].push([c,a]));return e}(t)),c='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -0.5 '+t.width+" "+t.height+'" shape-rendering="crispEdges"><g shape-rendering="crispEdges">'+s+"</g></svg>";var a=document.createElement("div");return a.innerHTML=c,a.firstChild},_t={};({get exports(){return _t},set exports(t){_t=t}}).exports=function(){for(var t=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),t<e?e:t>r?r:t},e=t,r=function(t){t._clipped=!1,t._unclipped=t.slice(0);for(var r=0;r<=3;r++)r<3?((t[r]<0||t[r]>255)&&(t._clipped=!0),t[r]=e(t[r],0,255)):3===r&&(t[r]=e(t[r],0,1));return t},i={},n=0,s=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];n<s.length;n+=1){var c=s[n];i["[object "+c+"]"]=c.toLowerCase()}var a=function(t){return i[Object.prototype.toString.call(t)]||"object"},o=a,l=function(t,e){return void 0===e&&(e=null),t.length>=3?Array.prototype.slice.call(t):"object"==o(t[0])&&e?e.split("").filter((function(e){return void 0!==t[0][e]})).map((function(e){return t[0][e]})):t[0]},h=a,C=function(t){if(t.length<2)return null;var e=t.length-1;return"string"==h(t[e])?t[e].toLowerCase():null},u=Math.PI,g={clip_rgb:r,limit:t,type:a,unpack:l,last:C,PI:u,TWOPI:2*u,PITHIRD:u/3,DEG2RAD:u/180,RAD2DEG:180/u},d={format:{},autodetect:[]},f=g.last,p=g.clip_rgb,m=g.type,v=d,b=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=this;if("object"===m(t[0])&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];var i=f(t),n=!1;if(!i){n=!0,v.sorted||(v.autodetect=v.autodetect.sort((function(t,e){return e.p-t.p})),v.sorted=!0);for(var s=0,c=v.autodetect;s<c.length;s+=1){var a=c[s];if(i=a.test.apply(a,t))break}}if(!v.format[i])throw new Error("unknown format: "+t);var o=v.format[i].apply(null,n?t:t.slice(0,-1));r._rgb=p(o),3===r._rgb.length&&r._rgb.push(1)};b.prototype.toString=function(){return"function"==m(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var w=b,y=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(y.Color,[null].concat(t)))};y.Color=w,y.version="2.4.2";var O=y,N=g.unpack,S=Math.max,x=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=N(t,"rgb"),i=r[0],n=r[1],s=r[2],c=1-S(i/=255,S(n/=255,s/=255)),a=c<1?1/(1-c):0;return[(1-i-c)*a,(1-n-c)*a,(1-s-c)*a,c]},A=x,R=g.unpack,k=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=(t=R(t,"cmyk"))[0],i=t[1],n=t[2],s=t[3],c=t.length>4?t[4]:1;return 1===s?[0,0,0,c]:[r>=1?0:255*(1-r)*(1-s),i>=1?0:255*(1-i)*(1-s),n>=1?0:255*(1-n)*(1-s),c]},F=k,M=O,E=w,T=d,I=g.unpack,B=g.type,L=A;E.prototype.cmyk=function(){return L(this._rgb)},M.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(E,[null].concat(t,["cmyk"])))},T.format.cmyk=F,T.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=I(t,"cmyk"),"array"===B(t)&&4===t.length)return"cmyk"}});var P=g.unpack,D=g.last,H=function(t){return Math.round(100*t)/100},z=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=P(t,"hsla"),i=D(t)||"lsa";return r[0]=H(r[0]||0),r[1]=H(100*r[1])+"%",r[2]=H(100*r[2])+"%","hsla"===i||r.length>3&&r[3]<1?(r[3]=r.length>3?r[3]:1,i="hsla"):r.length=3,i+"("+r.join(",")+")"},$=z,_=g.unpack,V=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=(t=_(t,"rgba"))[0],i=t[1],n=t[2];r/=255,i/=255,n/=255;var s,c,a=Math.min(r,i,n),o=Math.max(r,i,n),l=(o+a)/2;return o===a?(s=0,c=Number.NaN):s=l<.5?(o-a)/(o+a):(o-a)/(2-o-a),r==o?c=(i-n)/(o-a):i==o?c=2+(n-r)/(o-a):n==o&&(c=4+(r-i)/(o-a)),(c*=60)<0&&(c+=360),t.length>3&&void 0!==t[3]?[c,s,l,t[3]]:[c,s,l]},W=V,X=g.unpack,U=g.last,Y=$,q=W,G=Math.round,j=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=X(t,"rgba"),i=U(t)||"rgb";return"hsl"==i.substr(0,3)?Y(q(r),i):(r[0]=G(r[0]),r[1]=G(r[1]),r[2]=G(r[2]),("rgba"===i||r.length>3&&r[3]<1)&&(r[3]=r.length>3?r[3]:1,i="rgba"),i+"("+r.slice(0,"rgb"===i?3:4).join(",")+")")},K=j,Z=g.unpack,J=Math.round,Q=function(){for(var t,e=[],r=arguments.length;r--;)e[r]=arguments[r];var i,n,s,c=(e=Z(e,"hsl"))[0],a=e[1],o=e[2];if(0===a)i=n=s=255*o;else{var l=[0,0,0],h=[0,0,0],C=o<.5?o*(1+a):o+a-o*a,u=2*o-C,g=c/360;l[0]=g+1/3,l[1]=g,l[2]=g-1/3;for(var d=0;d<3;d++)l[d]<0&&(l[d]+=1),l[d]>1&&(l[d]-=1),6*l[d]<1?h[d]=u+6*(C-u)*l[d]:2*l[d]<1?h[d]=C:3*l[d]<2?h[d]=u+(C-u)*(2/3-l[d])*6:h[d]=u;i=(t=[J(255*h[0]),J(255*h[1]),J(255*h[2])])[0],n=t[1],s=t[2]}return e.length>3?[i,n,s,e[3]]:[i,n,s,1]},tt=Q,et=tt,rt=d,it=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,nt=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,st=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ct=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,at=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ot=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,lt=Math.round,ht=function(t){var e;if(t=t.toLowerCase().trim(),rt.format.named)try{return rt.format.named(t)}catch(t){}if(e=t.match(it)){for(var r=e.slice(1,4),i=0;i<3;i++)r[i]=+r[i];return r[3]=1,r}if(e=t.match(nt)){for(var n=e.slice(1,5),s=0;s<4;s++)n[s]=+n[s];return n}if(e=t.match(st)){for(var c=e.slice(1,4),a=0;a<3;a++)c[a]=lt(2.55*c[a]);return c[3]=1,c}if(e=t.match(ct)){for(var o=e.slice(1,5),l=0;l<3;l++)o[l]=lt(2.55*o[l]);return o[3]=+o[3],o}if(e=t.match(at)){var h=e.slice(1,4);h[1]*=.01,h[2]*=.01;var C=et(h);return C[3]=1,C}if(e=t.match(ot)){var u=e.slice(1,4);u[1]*=.01,u[2]*=.01;var g=et(u);return g[3]=+e[4],g}};ht.test=function(t){return it.test(t)||nt.test(t)||st.test(t)||ct.test(t)||at.test(t)||ot.test(t)};var Ct=ht,ut=O,gt=w,dt=d,ft=g.type,pt=K,mt=Ct;gt.prototype.css=function(t){return pt(this._rgb,t)},ut.css=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(gt,[null].concat(t,["css"])))},dt.format.css=mt,dt.autodetect.push({p:5,test:function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];if(!e.length&&"string"===ft(t)&&mt.test(t))return"css"}});var vt=w,bt=O,wt=d,yt=g.unpack;wt.format.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=yt(t,"rgba");return r[0]*=255,r[1]*=255,r[2]*=255,r},bt.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(vt,[null].concat(t,["gl"])))},vt.prototype.gl=function(){var t=this._rgb;return[t[0]/255,t[1]/255,t[2]/255,t[3]]};var Ot=g.unpack,Nt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r,i=Ot(t,"rgb"),n=i[0],s=i[1],c=i[2],a=Math.min(n,s,c),o=Math.max(n,s,c),l=o-a,h=100*l/255,C=a/(255-l)*100;return 0===l?r=Number.NaN:(n===o&&(r=(s-c)/l),s===o&&(r=2+(c-n)/l),c===o&&(r=4+(n-s)/l),(r*=60)<0&&(r+=360)),[r,h,C]},St=Nt,xt=g.unpack,At=Math.floor,Rt=function(){for(var t,e,r,i,n,s,c=[],a=arguments.length;a--;)c[a]=arguments[a];var o,l,h,C=(c=xt(c,"hcg"))[0],u=c[1],g=c[2];g*=255;var d=255*u;if(0===u)o=l=h=g;else{360===C&&(C=0),C>360&&(C-=360),C<0&&(C+=360);var f=At(C/=60),p=C-f,m=g*(1-u),v=m+d*(1-p),b=m+d*p,w=m+d;switch(f){case 0:o=(t=[w,b,m])[0],l=t[1],h=t[2];break;case 1:o=(e=[v,w,m])[0],l=e[1],h=e[2];break;case 2:o=(r=[m,w,b])[0],l=r[1],h=r[2];break;case 3:o=(i=[m,v,w])[0],l=i[1],h=i[2];break;case 4:o=(n=[b,m,w])[0],l=n[1],h=n[2];break;case 5:o=(s=[w,m,v])[0],l=s[1],h=s[2]}}return[o,l,h,c.length>3?c[3]:1]},kt=Rt,Ft=g.unpack,Mt=g.type,Et=O,Tt=w,It=d,Bt=St;Tt.prototype.hcg=function(){return Bt(this._rgb)},Et.hcg=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Tt,[null].concat(t,["hcg"])))},It.format.hcg=kt,It.autodetect.push({p:1,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Ft(t,"hcg"),"array"===Mt(t)&&3===t.length)return"hcg"}});var Lt=g.unpack,Pt=g.last,Dt=Math.round,Ht=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=Lt(t,"rgba"),i=r[0],n=r[1],s=r[2],c=r[3],a=Pt(t)||"auto";void 0===c&&(c=1),"auto"===a&&(a=c<1?"rgba":"rgb");var o="000000"+((i=Dt(i))<<16|(n=Dt(n))<<8|(s=Dt(s))).toString(16);o=o.substr(o.length-6);var l="0"+Dt(255*c).toString(16);switch(l=l.substr(l.length-2),a.toLowerCase()){case"rgba":return"#"+o+l;case"argb":return"#"+l+o;default:return"#"+o}},zt=Ht,$t=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,_t=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Vt=function(t){if(t.match($t)){4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=parseInt(t,16);return[e>>16,e>>8&255,255&e,1]}if(t.match(_t)){5!==t.length&&9!==t.length||(t=t.substr(1)),4===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);var r=parseInt(t,16);return[r>>24&255,r>>16&255,r>>8&255,Math.round((255&r)/255*100)/100]}throw new Error("unknown hex color: "+t)},Wt=O,Xt=w,Ut=g.type,Yt=d,qt=zt;Xt.prototype.hex=function(t){return qt(this._rgb,t)},Wt.hex=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Xt,[null].concat(t,["hex"])))},Yt.format.hex=Vt,Yt.autodetect.push({p:4,test:function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];if(!e.length&&"string"===Ut(t)&&[3,4,5,6,7,8,9].indexOf(t.length)>=0)return"hex"}});var Gt=g.unpack,jt=g.TWOPI,Kt=Math.min,Zt=Math.sqrt,Jt=Math.acos,Qt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r,i=Gt(t,"rgb"),n=i[0],s=i[1],c=i[2],a=Kt(n/=255,s/=255,c/=255),o=(n+s+c)/3,l=o>0?1-a/o:0;return 0===l?r=NaN:(r=(n-s+(n-c))/2,r/=Zt((n-s)*(n-s)+(n-c)*(s-c)),r=Jt(r),c>s&&(r=jt-r),r/=jt),[360*r,l,o]},te=Qt,ee=g.unpack,re=g.limit,ie=g.TWOPI,ne=g.PITHIRD,se=Math.cos,ce=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r,i,n,s=(t=ee(t,"hsi"))[0],c=t[1],a=t[2];return isNaN(s)&&(s=0),isNaN(c)&&(c=0),s>360&&(s-=360),s<0&&(s+=360),(s/=360)<1/3?i=1-((n=(1-c)/3)+(r=(1+c*se(ie*s)/se(ne-ie*s))/3)):s<2/3?n=1-((r=(1-c)/3)+(i=(1+c*se(ie*(s-=1/3))/se(ne-ie*s))/3)):r=1-((i=(1-c)/3)+(n=(1+c*se(ie*(s-=2/3))/se(ne-ie*s))/3)),[255*(r=re(a*r*3)),255*(i=re(a*i*3)),255*(n=re(a*n*3)),t.length>3?t[3]:1]},ae=ce,oe=g.unpack,le=g.type,he=O,Ce=w,ue=d,ge=te;Ce.prototype.hsi=function(){return ge(this._rgb)},he.hsi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ce,[null].concat(t,["hsi"])))},ue.format.hsi=ae,ue.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=oe(t,"hsi"),"array"===le(t)&&3===t.length)return"hsi"}});var de=g.unpack,fe=g.type,pe=O,me=w,ve=d,be=W;me.prototype.hsl=function(){return be(this._rgb)},pe.hsl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(me,[null].concat(t,["hsl"])))},ve.format.hsl=tt,ve.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=de(t,"hsl"),"array"===fe(t)&&3===t.length)return"hsl"}});var we=g.unpack,ye=Math.min,Oe=Math.max,Ne=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r,i,n,s=(t=we(t,"rgb"))[0],c=t[1],a=t[2],o=ye(s,c,a),l=Oe(s,c,a),h=l-o;return n=l/255,0===l?(r=Number.NaN,i=0):(i=h/l,s===l&&(r=(c-a)/h),c===l&&(r=2+(a-s)/h),a===l&&(r=4+(s-c)/h),(r*=60)<0&&(r+=360)),[r,i,n]},Se=Ne,xe=g.unpack,Ae=Math.floor,Re=function(){for(var t,e,r,i,n,s,c=[],a=arguments.length;a--;)c[a]=arguments[a];var o,l,h,C=(c=xe(c,"hsv"))[0],u=c[1],g=c[2];if(g*=255,0===u)o=l=h=g;else{360===C&&(C=0),C>360&&(C-=360),C<0&&(C+=360);var d=Ae(C/=60),f=C-d,p=g*(1-u),m=g*(1-u*f),v=g*(1-u*(1-f));switch(d){case 0:o=(t=[g,v,p])[0],l=t[1],h=t[2];break;case 1:o=(e=[m,g,p])[0],l=e[1],h=e[2];break;case 2:o=(r=[p,g,v])[0],l=r[1],h=r[2];break;case 3:o=(i=[p,m,g])[0],l=i[1],h=i[2];break;case 4:o=(n=[v,p,g])[0],l=n[1],h=n[2];break;case 5:o=(s=[g,p,m])[0],l=s[1],h=s[2]}}return[o,l,h,c.length>3?c[3]:1]},ke=Re,Fe=g.unpack,Me=g.type,Ee=O,Te=w,Ie=d,Be=Se;Te.prototype.hsv=function(){return Be(this._rgb)},Ee.hsv=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Te,[null].concat(t,["hsv"])))},Ie.format.hsv=ke,Ie.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Fe(t,"hsv"),"array"===Me(t)&&3===t.length)return"hsv"}});var Le={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Pe=Le,De=g.unpack,He=Math.pow,ze=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=De(t,"rgb"),i=r[0],n=r[1],s=r[2],c=Ve(i,n,s),a=c[0],o=c[1],l=116*o-16;return[l<0?0:l,500*(a-o),200*(o-c[2])]},$e=function(t){return(t/=255)<=.04045?t/12.92:He((t+.055)/1.055,2.4)},_e=function(t){return t>Pe.t3?He(t,1/3):t/Pe.t2+Pe.t0},Ve=function(t,e,r){return t=$e(t),e=$e(e),r=$e(r),[_e((.4124564*t+.3575761*e+.1804375*r)/Pe.Xn),_e((.2126729*t+.7151522*e+.072175*r)/Pe.Yn),_e((.0193339*t+.119192*e+.9503041*r)/Pe.Zn)]},We=ze,Xe=Le,Ue=g.unpack,Ye=Math.pow,qe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r,i,n,s=(t=Ue(t,"lab"))[0],c=t[1],a=t[2];return i=(s+16)/116,r=isNaN(c)?i:i+c/500,n=isNaN(a)?i:i-a/200,i=Xe.Yn*je(i),r=Xe.Xn*je(r),n=Xe.Zn*je(n),[Ge(3.2404542*r-1.5371385*i-.4985314*n),Ge(-.969266*r+1.8760108*i+.041556*n),Ge(.0556434*r-.2040259*i+1.0572252*n),t.length>3?t[3]:1]},Ge=function(t){return 255*(t<=.00304?12.92*t:1.055*Ye(t,1/2.4)-.055)},je=function(t){return t>Xe.t1?t*t*t:Xe.t2*(t-Xe.t0)},Ke=qe,Ze=g.unpack,Je=g.type,Qe=O,tr=w,er=d,rr=We;tr.prototype.lab=function(){return rr(this._rgb)},Qe.lab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(tr,[null].concat(t,["lab"])))},er.format.lab=Ke,er.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Ze(t,"lab"),"array"===Je(t)&&3===t.length)return"lab"}});var ir=g.unpack,nr=g.RAD2DEG,sr=Math.sqrt,cr=Math.atan2,ar=Math.round,or=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=ir(t,"lab"),i=r[0],n=r[1],s=r[2],c=sr(n*n+s*s),a=(cr(s,n)*nr+360)%360;return 0===ar(1e4*c)&&(a=Number.NaN),[i,c,a]},lr=or,hr=g.unpack,Cr=We,ur=lr,gr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=hr(t,"rgb"),i=r[0],n=r[1],s=r[2],c=Cr(i,n,s),a=c[0],o=c[1],l=c[2];return ur(a,o,l)},dr=gr,fr=g.unpack,pr=g.DEG2RAD,mr=Math.sin,vr=Math.cos,br=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=fr(t,"lch"),i=r[0],n=r[1],s=r[2];return isNaN(s)&&(s=0),[i,vr(s*=pr)*n,mr(s)*n]},wr=br,yr=g.unpack,Or=wr,Nr=Ke,Sr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=(t=yr(t,"lch"))[0],i=t[1],n=t[2],s=Or(r,i,n),c=s[0],a=s[1],o=s[2],l=Nr(c,a,o);return[l[0],l[1],l[2],t.length>3?t[3]:1]},xr=Sr,Ar=g.unpack,Rr=xr,kr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=Ar(t,"hcl").reverse();return Rr.apply(void 0,r)},Fr=kr,Mr=g.unpack,Er=g.type,Tr=O,Ir=w,Br=d,Lr=dr;Ir.prototype.lch=function(){return Lr(this._rgb)},Ir.prototype.hcl=function(){return Lr(this._rgb).reverse()},Tr.lch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ir,[null].concat(t,["lch"])))},Tr.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ir,[null].concat(t,["hcl"])))},Br.format.lch=xr,Br.format.hcl=Fr,["lch","hcl"].forEach((function(t){return Br.autodetect.push({p:2,test:function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];if(e=Mr(e,t),"array"===Er(e)&&3===e.length)return t}})}));var Pr={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Dr=w,Hr=d,zr=g.type,$r=Pr,_r=Vt,Vr=zt;Dr.prototype.name=function(){for(var t=Vr(this._rgb,"rgb"),e=0,r=Object.keys($r);e<r.length;e+=1){var i=r[e];if($r[i]===t)return i.toLowerCase()}return t},Hr.format.named=function(t){if(t=t.toLowerCase(),$r[t])return _r($r[t]);throw new Error("unknown color name: "+t)},Hr.autodetect.push({p:5,test:function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];if(!e.length&&"string"===zr(t)&&$r[t.toLowerCase()])return"named"}});var Wr=g.unpack,Xr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=Wr(t,"rgb");return(r[0]<<16)+(r[1]<<8)+r[2]},Ur=Xr,Yr=g.type,qr=function(t){if("number"==Yr(t)&&t>=0&&t<=16777215)return[t>>16,t>>8&255,255&t,1];throw new Error("unknown num color: "+t)},Gr=O,jr=w,Kr=d,Zr=g.type,Jr=Ur;jr.prototype.num=function(){return Jr(this._rgb)},Gr.num=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(jr,[null].concat(t,["num"])))},Kr.format.num=qr,Kr.autodetect.push({p:5,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(1===t.length&&"number"===Zr(t[0])&&t[0]>=0&&t[0]<=16777215)return"num"}});var Qr=O,ti=w,ei=d,ri=g.unpack,ii=g.type,ni=Math.round;ti.prototype.rgb=function(t){return void 0===t&&(t=!0),!1===t?this._rgb.slice(0,3):this._rgb.slice(0,3).map(ni)},ti.prototype.rgba=function(t){return void 0===t&&(t=!0),this._rgb.slice(0,4).map((function(e,r){return r<3?!1===t?e:ni(e):e}))},Qr.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(ti,[null].concat(t,["rgb"])))},ei.format.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=ri(t,"rgba");return void 0===r[3]&&(r[3]=1),r},ei.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=ri(t,"rgba"),"array"===ii(t)&&(3===t.length||4===t.length&&"number"==ii(t[3])&&t[3]>=0&&t[3]<=1))return"rgb"}});var si=Math.log,ci=function(t){var e,r,i,n=t/100;return n<66?(e=255,r=n<6?0:-155.25485562709179-.44596950469579133*(r=n-2)+104.49216199393888*si(r),i=n<20?0:.8274096064007395*(i=n-10)-254.76935184120902+115.67994401066147*si(i)):(e=351.97690566805693+.114206453784165*(e=n-55)-40.25366309332127*si(e),r=325.4494125711974+.07943456536662342*(r=n-50)-28.0852963507957*si(r),i=255),[e,r,i,1]},ai=ci,oi=g.unpack,li=Math.round,hi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var r,i=oi(t,"rgb"),n=i[0],s=i[2],c=1e3,a=4e4,o=.4;a-c>o;){var l=ai(r=.5*(a+c));l[2]/l[0]>=s/n?a=r:c=r}return li(r)},Ci=O,ui=w,gi=d,di=hi;ui.prototype.temp=ui.prototype.kelvin=ui.prototype.temperature=function(){return di(this._rgb)},Ci.temp=Ci.kelvin=Ci.temperature=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(ui,[null].concat(t,["temp"])))},gi.format.temp=gi.format.kelvin=gi.format.temperature=ci;var fi=g.unpack,pi=Math.cbrt,mi=Math.pow,vi=Math.sign,bi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=fi(t,"rgb"),i=r[0],n=r[1],s=r[2],c=[yi(i/255),yi(n/255),yi(s/255)],a=c[0],o=c[1],l=c[2],h=pi(.4122214708*a+.5363325363*o+.0514459929*l),C=pi(.2119034982*a+.6806995451*o+.1073969566*l),u=pi(.0883024619*a+.2817188376*o+.6299787005*l);return[.2104542553*h+.793617785*C-.0040720468*u,1.9779984951*h-2.428592205*C+.4505937099*u,.0259040371*h+.7827717662*C-.808675766*u]},wi=bi;function yi(t){var e=Math.abs(t);return e<.04045?t/12.92:(vi(t)||1)*mi((e+.055)/1.055,2.4)}var Oi=g.unpack,Ni=Math.pow,Si=Math.sign,xi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=(t=Oi(t,"lab"))[0],i=t[1],n=t[2],s=Ni(r+.3963377774*i+.2158037573*n,3),c=Ni(r-.1055613458*i-.0638541728*n,3),a=Ni(r-.0894841775*i-1.291485548*n,3);return[255*Ri(4.0767416621*s-3.3077115913*c+.2309699292*a),255*Ri(-1.2684380046*s+2.6097574011*c-.3413193965*a),255*Ri(-.0041960863*s-.7034186147*c+1.707614701*a),t.length>3?t[3]:1]},Ai=xi;function Ri(t){var e=Math.abs(t);return e>.0031308?(Si(t)||1)*(1.055*Ni(e,1/2.4)-.055):12.92*t}var ki=g.unpack,Fi=g.type,Mi=O,Ei=w,Ti=d,Ii=wi;Ei.prototype.oklab=function(){return Ii(this._rgb)},Mi.oklab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ei,[null].concat(t,["oklab"])))},Ti.format.oklab=Ai,Ti.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=ki(t,"oklab"),"array"===Fi(t)&&3===t.length)return"oklab"}});var Bi=g.unpack,Li=wi,Pi=lr,Di=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=Bi(t,"rgb"),i=r[0],n=r[1],s=r[2],c=Li(i,n,s),a=c[0],o=c[1],l=c[2];return Pi(a,o,l)},Hi=Di,zi=g.unpack,$i=wr,_i=Ai,Vi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=(t=zi(t,"lch"))[0],i=t[1],n=t[2],s=$i(r,i,n),c=s[0],a=s[1],o=s[2],l=_i(c,a,o);return[l[0],l[1],l[2],t.length>3?t[3]:1]},Wi=Vi,Xi=g.unpack,Ui=g.type,Yi=O,qi=w,Gi=d,ji=Hi;qi.prototype.oklch=function(){return ji(this._rgb)},Yi.oklch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(qi,[null].concat(t,["oklch"])))},Gi.format.oklch=Wi,Gi.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Xi(t,"oklch"),"array"===Ui(t)&&3===t.length)return"oklch"}});var Ki=w,Zi=g.type;Ki.prototype.alpha=function(t,e){return void 0===e&&(e=!1),void 0!==t&&"number"===Zi(t)?e?(this._rgb[3]=t,this):new Ki([this._rgb[0],this._rgb[1],this._rgb[2],t],"rgb"):this._rgb[3]},w.prototype.clipped=function(){return this._rgb._clipped||!1};var Ji=w,Qi=Le;Ji.prototype.darken=function(t){void 0===t&&(t=1);var e=this,r=e.lab();return r[0]-=Qi.Kn*t,new Ji(r,"lab").alpha(e.alpha(),!0)},Ji.prototype.brighten=function(t){return void 0===t&&(t=1),this.darken(-t)},Ji.prototype.darker=Ji.prototype.darken,Ji.prototype.brighter=Ji.prototype.brighten,w.prototype.get=function(t){var e=t.split("."),r=e[0],i=e[1],n=this[r]();if(i){var s=r.indexOf(i)-("ok"===r.substr(0,2)?2:0);if(s>-1)return n[s];throw new Error("unknown channel "+i+" in mode "+r)}return n};var tn=w,en=g.type,rn=Math.pow,nn=1e-7,sn=20;tn.prototype.luminance=function(t){if(void 0!==t&&"number"===en(t)){if(0===t)return new tn([0,0,0,this._rgb[3]],"rgb");if(1===t)return new tn([255,255,255,this._rgb[3]],"rgb");var e=this.luminance(),r="rgb",i=sn,n=function(e,s){var c=e.interpolate(s,.5,r),a=c.luminance();return Math.abs(t-a)<nn||!i--?c:a>t?n(e,c):n(c,s)},s=(e>t?n(new tn([0,0,0]),this):n(this,new tn([255,255,255]))).rgb();return new tn(s.concat([this._rgb[3]]))}return cn.apply(void 0,this._rgb.slice(0,3))};var cn=function(t,e,r){return.2126*(t=an(t))+.7152*(e=an(e))+.0722*(r=an(r))},an=function(t){return(t/=255)<=.03928?t/12.92:rn((t+.055)/1.055,2.4)},on={},ln=w,hn=g.type,Cn=on,un=function(t,e,r){void 0===r&&(r=.5);for(var i=[],n=arguments.length-3;n-- >0;)i[n]=arguments[n+3];var s=i[0]||"lrgb";if(Cn[s]||i.length||(s=Object.keys(Cn)[0]),!Cn[s])throw new Error("interpolation mode "+s+" is not defined");return"object"!==hn(t)&&(t=new ln(t)),"object"!==hn(e)&&(e=new ln(e)),Cn[s](t,e,r).alpha(t.alpha()+r*(e.alpha()-t.alpha()))},gn=w,dn=un;gn.prototype.mix=gn.prototype.interpolate=function(t,e){void 0===e&&(e=.5);for(var r=[],i=arguments.length-2;i-- >0;)r[i]=arguments[i+2];return dn.apply(void 0,[this,t,e].concat(r))};var fn=w;fn.prototype.premultiply=function(t){void 0===t&&(t=!1);var e=this._rgb,r=e[3];return t?(this._rgb=[e[0]*r,e[1]*r,e[2]*r,r],this):new fn([e[0]*r,e[1]*r,e[2]*r,r],"rgb")};var pn=w,mn=Le;pn.prototype.saturate=function(t){void 0===t&&(t=1);var e=this,r=e.lch();return r[1]+=mn.Kn*t,r[1]<0&&(r[1]=0),new pn(r,"lch").alpha(e.alpha(),!0)},pn.prototype.desaturate=function(t){return void 0===t&&(t=1),this.saturate(-t)};var vn=w,bn=g.type;vn.prototype.set=function(t,e,r){void 0===r&&(r=!1);var i=t.split("."),n=i[0],s=i[1],c=this[n]();if(s){var a=n.indexOf(s)-("ok"===n.substr(0,2)?2:0);if(a>-1){if("string"==bn(e))switch(e.charAt(0)){case"+":case"-":c[a]+=+e;break;case"*":c[a]*=+e.substr(1);break;case"/":c[a]/=+e.substr(1);break;default:c[a]=+e}else{if("number"!==bn(e))throw new Error("unsupported value for Color.set");c[a]=e}var o=new vn(c,n);return r?(this._rgb=o._rgb,this):o}throw new Error("unknown channel "+s+" in mode "+n)}return c};var wn=w,yn=function(t,e,r){var i=t._rgb,n=e._rgb;return new wn(i[0]+r*(n[0]-i[0]),i[1]+r*(n[1]-i[1]),i[2]+r*(n[2]-i[2]),"rgb")};on.rgb=yn;var On=w,Nn=Math.sqrt,Sn=Math.pow,xn=function(t,e,r){var i=t._rgb,n=i[0],s=i[1],c=i[2],a=e._rgb,o=a[0],l=a[1],h=a[2];return new On(Nn(Sn(n,2)*(1-r)+Sn(o,2)*r),Nn(Sn(s,2)*(1-r)+Sn(l,2)*r),Nn(Sn(c,2)*(1-r)+Sn(h,2)*r),"rgb")};on.lrgb=xn;var An=w,Rn=function(t,e,r){var i=t.lab(),n=e.lab();return new An(i[0]+r*(n[0]-i[0]),i[1]+r*(n[1]-i[1]),i[2]+r*(n[2]-i[2]),"lab")};on.lab=Rn;var kn=w,Fn=function(t,e,r,i){var n,s,c,a,o,l,h,C,u,g,d,f,p;return"hsl"===i?(c=t.hsl(),a=e.hsl()):"hsv"===i?(c=t.hsv(),a=e.hsv()):"hcg"===i?(c=t.hcg(),a=e.hcg()):"hsi"===i?(c=t.hsi(),a=e.hsi()):"lch"===i||"hcl"===i?(i="hcl",c=t.hcl(),a=e.hcl()):"oklch"===i&&(c=t.oklch().reverse(),a=e.oklch().reverse()),"h"!==i.substr(0,1)&&"oklch"!==i||(o=(n=c)[0],h=n[1],u=n[2],l=(s=a)[0],C=s[1],g=s[2]),isNaN(o)||isNaN(l)?isNaN(o)?isNaN(l)?f=Number.NaN:(f=l,1!=u&&0!=u||"hsv"==i||(d=C)):(f=o,1!=g&&0!=g||"hsv"==i||(d=h)):f=o+r*(l>o&&l-o>180?l-(o+360):l<o&&o-l>180?l+360-o:l-o),void 0===d&&(d=h+r*(C-h)),p=u+r*(g-u),new kn("oklch"===i?[p,d,f]:[f,d,p],i)},Mn=Fn,En=function(t,e,r){return Mn(t,e,r,"lch")};on.lch=En,on.hcl=En;var Tn=w,In=function(t,e,r){var i=t.num(),n=e.num();return new Tn(i+r*(n-i),"num")};on.num=In;var Bn=Fn,Ln=function(t,e,r){return Bn(t,e,r,"hcg")};on.hcg=Ln;var Pn=Fn,Dn=function(t,e,r){return Pn(t,e,r,"hsi")};on.hsi=Dn;var Hn=Fn,zn=function(t,e,r){return Hn(t,e,r,"hsl")};on.hsl=zn;var $n=Fn,_n=function(t,e,r){return $n(t,e,r,"hsv")};on.hsv=_n;var Vn=w,Wn=function(t,e,r){var i=t.oklab(),n=e.oklab();return new Vn(i[0]+r*(n[0]-i[0]),i[1]+r*(n[1]-i[1]),i[2]+r*(n[2]-i[2]),"oklab")};on.oklab=Wn;var Xn=Fn,Un=function(t,e,r){return Xn(t,e,r,"oklch")};on.oklch=Un;var Yn=w,qn=g.clip_rgb,Gn=Math.pow,jn=Math.sqrt,Kn=Math.PI,Zn=Math.cos,Jn=Math.sin,Qn=Math.atan2,ts=function(t,e,r){void 0===e&&(e="lrgb"),void 0===r&&(r=null);var i=t.length;r||(r=Array.from(new Array(i)).map((function(){return 1})));var n=i/r.reduce((function(t,e){return t+e}));if(r.forEach((function(t,e){r[e]*=n})),t=t.map((function(t){return new Yn(t)})),"lrgb"===e)return es(t,r);for(var s=t.shift(),c=s.get(e),a=[],o=0,l=0,h=0;h<c.length;h++)if(c[h]=(c[h]||0)*r[0],a.push(isNaN(c[h])?0:r[0]),"h"===e.charAt(h)&&!isNaN(c[h])){var C=c[h]/180*Kn;o+=Zn(C)*r[0],l+=Jn(C)*r[0]}var u=s.alpha()*r[0];t.forEach((function(t,i){var n=t.get(e);u+=t.alpha()*r[i+1];for(var s=0;s<c.length;s++)if(!isNaN(n[s]))if(a[s]+=r[i+1],"h"===e.charAt(s)){var h=n[s]/180*Kn;o+=Zn(h)*r[i+1],l+=Jn(h)*r[i+1]}else c[s]+=n[s]*r[i+1]}));for(var g=0;g<c.length;g++)if("h"===e.charAt(g)){for(var d=Qn(l/a[g],o/a[g])/Kn*180;d<0;)d+=360;for(;d>=360;)d-=360;c[g]=d}else c[g]=c[g]/a[g];return u/=i,new Yn(c,e).alpha(u>.99999?1:u,!0)},es=function(t,e){for(var r=t.length,i=[0,0,0,0],n=0;n<t.length;n++){var s=t[n],c=e[n]/r,a=s._rgb;i[0]+=Gn(a[0],2)*c,i[1]+=Gn(a[1],2)*c,i[2]+=Gn(a[2],2)*c,i[3]+=a[3]*c}return i[0]=jn(i[0]),i[1]=jn(i[1]),i[2]=jn(i[2]),i[3]>.9999999&&(i[3]=1),new Yn(qn(i))},rs=O,is=g.type,ns=Math.pow,ss=function(t){var e="rgb",r=rs("#ccc"),i=0,n=[0,1],s=[],c=[0,0],a=!1,o=[],l=!1,h=0,C=1,u=!1,g={},d=!0,f=1,p=function(t){if((t=t||["#fff","#000"])&&"string"===is(t)&&rs.brewer&&rs.brewer[t.toLowerCase()]&&(t=rs.brewer[t.toLowerCase()]),"array"===is(t)){1===t.length&&(t=[t[0],t[0]]),t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=rs(t[e]);s.length=0;for(var r=0;r<t.length;r++)s.push(r/(t.length-1))}return y(),o=t},m=function(t){if(null!=a){for(var e=a.length-1,r=0;r<e&&t>=a[r];)r++;return r-1}return 0},v=function(t){return t},b=function(t){return t},w=function(t,i){var n,l;if(null==i&&(i=!1),isNaN(t)||null===t)return r;l=i?t:a&&a.length>2?m(t)/(a.length-2):C!==h?(t-h)/(C-h):1,l=b(l),i||(l=v(l)),1!==f&&(l=ns(l,f)),l=c[0]+l*(1-c[0]-c[1]),l=Math.min(1,Math.max(0,l));var u=Math.floor(1e4*l);if(d&&g[u])n=g[u];else{if("array"===is(o))for(var p=0;p<s.length;p++){var w=s[p];if(l<=w){n=o[p];break}if(l>=w&&p===s.length-1){n=o[p];break}if(l>w&&l<s[p+1]){l=(l-w)/(s[p+1]-w),n=rs.interpolate(o[p],o[p+1],l,e);break}}else"function"===is(o)&&(n=o(l));d&&(g[u]=n)}return n},y=function(){return g={}};p(t);var O=function(t){var e=rs(w(t));return l&&e[l]?e[l]():e};return O.classes=function(t){if(null!=t){if("array"===is(t))a=t,n=[t[0],t[t.length-1]];else{var e=rs.analyze(n);a=0===t?[e.min,e.max]:rs.limits(e,"e",t)}return O}return a},O.domain=function(t){if(!arguments.length)return n;h=t[0],C=t[t.length-1],s=[];var e=o.length;if(t.length===e&&h!==C)for(var r=0,i=Array.from(t);r<i.length;r+=1){var c=i[r];s.push((c-h)/(C-h))}else{for(var a=0;a<e;a++)s.push(a/(e-1));if(t.length>2){var l=t.map((function(e,r){return r/(t.length-1)})),u=t.map((function(t){return(t-h)/(C-h)}));u.every((function(t,e){return l[e]===t}))||(b=function(t){if(t<=0||t>=1)return t;for(var e=0;t>=u[e+1];)e++;var r=(t-u[e])/(u[e+1]-u[e]);return l[e]+r*(l[e+1]-l[e])})}}return n=[h,C],O},O.mode=function(t){return arguments.length?(e=t,y(),O):e},O.range=function(t,e){return p(t),O},O.out=function(t){return l=t,O},O.spread=function(t){return arguments.length?(i=t,O):i},O.correctLightness=function(t){return null==t&&(t=!0),u=t,y(),v=u?function(t){for(var e=w(0,!0).lab()[0],r=w(1,!0).lab()[0],i=e>r,n=w(t,!0).lab()[0],s=e+(r-e)*t,c=n-s,a=0,o=1,l=20;Math.abs(c)>.01&&l-- >0;)i&&(c*=-1),c<0?(a=t,t+=.5*(o-t)):(o=t,t+=.5*(a-t)),n=w(t,!0).lab()[0],c=n-s;return t}:function(t){return t},O},O.padding=function(t){return null!=t?("number"===is(t)&&(t=[t,t]),c=t,O):c},O.colors=function(e,r){arguments.length<2&&(r="hex");var i=[];if(0===arguments.length)i=o.slice(0);else if(1===e)i=[O(.5)];else if(e>1){var s=n[0],c=n[1]-s;i=cs(0,e,!1).map((function(t){return O(s+t/(e-1)*c)}))}else{t=[];var l=[];if(a&&a.length>2)for(var h=1,C=a.length,u=1<=C;u?h<C:h>C;u?h++:h--)l.push(.5*(a[h-1]+a[h]));else l=n;i=l.map((function(t){return O(t)}))}return rs[r]&&(i=i.map((function(t){return t[r]()}))),i},O.cache=function(t){return null!=t?(d=t,O):d},O.gamma=function(t){return null!=t?(f=t,O):f},O.nodata=function(t){return null!=t?(r=rs(t),O):r},O};function cs(t,e,r){for(var i=[],n=t<e,s=r?n?e+1:e-1:e,c=t;n?c<s:c>s;n?c++:c--)i.push(c);return i}var as=w,os=ss,ls=function(t){for(var e=[1,1],r=1;r<t;r++){for(var i=[1],n=1;n<=e.length;n++)i[n]=(e[n]||0)+e[n-1];e=i}return e},hs=function(t){var e,r,i,n,s,c,a;if(2===(t=t.map((function(t){return new as(t)}))).length)e=t.map((function(t){return t.lab()})),s=e[0],c=e[1],n=function(t){var e=[0,1,2].map((function(e){return s[e]+t*(c[e]-s[e])}));return new as(e,"lab")};else if(3===t.length)r=t.map((function(t){return t.lab()})),s=r[0],c=r[1],a=r[2],n=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*s[e]+2*(1-t)*t*c[e]+t*t*a[e]}));return new as(e,"lab")};else if(4===t.length){var o;i=t.map((function(t){return t.lab()})),s=i[0],c=i[1],a=i[2],o=i[3],n=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*(1-t)*s[e]+3*(1-t)*(1-t)*t*c[e]+3*(1-t)*t*t*a[e]+t*t*t*o[e]}));return new as(e,"lab")}}else{if(!(t.length>=5))throw new RangeError("No point in running bezier with only one color.");var l,h,C;l=t.map((function(t){return t.lab()})),C=t.length-1,h=ls(C),n=function(t){var e=1-t,r=[0,1,2].map((function(r){return l.reduce((function(i,n,s){return i+h[s]*Math.pow(e,C-s)*Math.pow(t,s)*n[r]}),0)}));return new as(r,"lab")}}return n},Cs=function(t){var e=hs(t);return e.scale=function(){return os(e)},e},us=O,gs=function(t,e,r){if(!gs[r])throw new Error("unknown blend mode "+r);return gs[r](t,e)},ds=function(t){return function(e,r){var i=us(r).rgb(),n=us(e).rgb();return us.rgb(t(i,n))}},fs=function(t){return function(e,r){var i=[];return i[0]=t(e[0],r[0]),i[1]=t(e[1],r[1]),i[2]=t(e[2],r[2]),i}},ps=function(t){return t},ms=function(t,e){return t*e/255},vs=function(t,e){return t>e?e:t},bs=function(t,e){return t>e?t:e},ws=function(t,e){return 255*(1-(1-t/255)*(1-e/255))},ys=function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))},Os=function(t,e){return 255*(1-(1-e/255)/(t/255))},Ns=function(t,e){return 255===t||(t=e/255*255/(1-t/255))>255?255:t};gs.normal=ds(fs(ps)),gs.multiply=ds(fs(ms)),gs.screen=ds(fs(ws)),gs.overlay=ds(fs(ys)),gs.darken=ds(fs(vs)),gs.lighten=ds(fs(bs)),gs.dodge=ds(fs(Ns)),gs.burn=ds(fs(Os));for(var Ss=gs,xs=g.type,As=g.clip_rgb,Rs=g.TWOPI,ks=Math.pow,Fs=Math.sin,Ms=Math.cos,Es=O,Ts=function(t,e,r,i,n){void 0===t&&(t=300),void 0===e&&(e=-1.5),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=[0,1]);var s,c=0;"array"===xs(n)?s=n[1]-n[0]:(s=0,n=[n,n]);var a=function(a){var o=Rs*((t+120)/360+e*a),l=ks(n[0]+s*a,i),h=(0!==c?r[0]+a*c:r)*l*(1-l)/2,C=Ms(o),u=Fs(o);return Es(As([255*(l+h*(-.14861*C+1.78277*u)),255*(l+h*(-.29227*C-.90649*u)),255*(l+h*(1.97294*C)),1]))};return a.start=function(e){return null==e?t:(t=e,a)},a.rotations=function(t){return null==t?e:(e=t,a)},a.gamma=function(t){return null==t?i:(i=t,a)},a.hue=function(t){return null==t?r:("array"===xs(r=t)?0==(c=r[1]-r[0])&&(r=r[1]):c=0,a)},a.lightness=function(t){return null==t?n:("array"===xs(t)?(n=t,s=t[1]-t[0]):(n=[t,t],s=0),a)},a.scale=function(){return Es.scale(a)},a.hue(r),a},Is=w,Bs="0123456789abcdef",Ls=Math.floor,Ps=Math.random,Ds=function(){for(var t="#",e=0;e<6;e++)t+=Bs.charAt(Ls(16*Ps()));return new Is(t,"hex")},Hs=a,zs=Math.log,$s=Math.pow,_s=Math.floor,Vs=Math.abs,Ws=function(t,e){void 0===e&&(e=null);var r={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===Hs(t)&&(t=Object.values(t)),t.forEach((function(t){e&&"object"===Hs(t)&&(t=t[e]),null==t||isNaN(t)||(r.values.push(t),r.sum+=t,t<r.min&&(r.min=t),t>r.max&&(r.max=t),r.count+=1)})),r.domain=[r.min,r.max],r.limits=function(t,e){return Xs(r,t,e)},r},Xs=function(t,e,r){void 0===e&&(e="equal"),void 0===r&&(r=7),"array"==Hs(t)&&(t=Ws(t));var i=t.min,n=t.max,s=t.values.sort((function(t,e){return t-e}));if(1===r)return[i,n];var c=[];if("c"===e.substr(0,1)&&(c.push(i),c.push(n)),"e"===e.substr(0,1)){c.push(i);for(var a=1;a<r;a++)c.push(i+a/r*(n-i));c.push(n)}else if("l"===e.substr(0,1)){if(i<=0)throw new Error("Logarithmic scales are only possible for values > 0");var o=Math.LOG10E*zs(i),l=Math.LOG10E*zs(n);c.push(i);for(var h=1;h<r;h++)c.push($s(10,o+h/r*(l-o)));c.push(n)}else if("q"===e.substr(0,1)){c.push(i);for(var C=1;C<r;C++){var u=(s.length-1)*C/r,g=_s(u);if(g===u)c.push(s[g]);else{var d=u-g;c.push(s[g]*(1-d)+s[g+1]*d)}}c.push(n)}else if("k"===e.substr(0,1)){var f,p=s.length,m=new Array(p),v=new Array(r),b=!0,w=0,y=null;(y=[]).push(i);for(var O=1;O<r;O++)y.push(i+O/r*(n-i));for(y.push(n);b;){for(var N=0;N<r;N++)v[N]=0;for(var S=0;S<p;S++)for(var x=s[S],A=Number.MAX_VALUE,R=void 0,k=0;k<r;k++){var F=Vs(y[k]-x);F<A&&(A=F,R=k),v[R]++,m[S]=R}for(var M=new Array(r),E=0;E<r;E++)M[E]=null;for(var T=0;T<p;T++)null===M[f=m[T]]?M[f]=s[T]:M[f]+=s[T];for(var I=0;I<r;I++)M[I]*=1/v[I];b=!1;for(var B=0;B<r;B++)if(M[B]!==y[B]){b=!0;break}y=M,++w>200&&(b=!1)}for(var L={},P=0;P<r;P++)L[P]=[];for(var D=0;D<p;D++)L[f=m[D]].push(s[D]);for(var H=[],z=0;z<r;z++)H.push(L[z][0]),H.push(L[z][L[z].length-1]);H=H.sort((function(t,e){return t-e})),c.push(H[0]);for(var $=1;$<H.length;$+=2){var _=H[$];isNaN(_)||-1!==c.indexOf(_)||c.push(_)}}return c},Us={analyze:Ws,limits:Xs},Ys=w,qs=function(t,e){t=new Ys(t),e=new Ys(e);var r=t.luminance(),i=e.luminance();return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)},Gs=w,js=Math.sqrt,Ks=Math.pow,Zs=Math.min,Js=Math.max,Qs=Math.atan2,tc=Math.abs,ec=Math.cos,rc=Math.sin,ic=Math.exp,nc=Math.PI,sc=function(t,e,r,i,n){void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=1);var s=function(t){return 360*t/(2*nc)},c=function(t){return 2*nc*t/360};t=new Gs(t),e=new Gs(e);var a=Array.from(t.lab()),o=a[0],l=a[1],h=a[2],C=Array.from(e.lab()),u=C[0],g=C[1],d=C[2],f=(o+u)/2,p=(js(Ks(l,2)+Ks(h,2))+js(Ks(g,2)+Ks(d,2)))/2,m=.5*(1-js(Ks(p,7)/(Ks(p,7)+Ks(25,7)))),v=l*(1+m),b=g*(1+m),w=js(Ks(v,2)+Ks(h,2)),y=js(Ks(b,2)+Ks(d,2)),O=(w+y)/2,N=s(Qs(h,v)),S=s(Qs(d,b)),x=N>=0?N:N+360,A=S>=0?S:S+360,R=tc(x-A)>180?(x+A+360)/2:(x+A)/2,k=1-.17*ec(c(R-30))+.24*ec(c(2*R))+.32*ec(c(3*R+6))-.2*ec(c(4*R-63)),F=A-x;F=tc(F)<=180?F:A<=x?F+360:F-360,F=2*js(w*y)*rc(c(F)/2);var M=u-o,E=y-w,T=1+.015*Ks(f-50,2)/js(20+Ks(f-50,2)),I=1+.045*O,B=1+.015*O*k,L=30*ic(-Ks((R-275)/25,2)),P=-2*js(Ks(O,7)/(Ks(O,7)+Ks(25,7)))*rc(2*c(L)),D=js(Ks(M/(r*T),2)+Ks(E/(i*I),2)+Ks(F/(n*B),2)+P*(E/(i*I))*(F/(n*B)));return Js(0,Zs(100,D))},cc=w,ac=function(t,e,r){void 0===r&&(r="lab"),t=new cc(t),e=new cc(e);var i=t.get(r),n=e.get(r),s=0;for(var c in i){var a=(i[c]||0)-(n[c]||0);s+=a*a}return Math.sqrt(s)},oc=w,lc=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];try{return new(Function.prototype.bind.apply(oc,[null].concat(t))),!0}catch(t){return!1}},hc=O,Cc=ss,uc={cool:function(){return Cc([hc.hsl(180,1,.9),hc.hsl(250,.7,.4)])},hot:function(){return Cc(["#000","#f00","#ff0","#fff"]).mode("rgb")}},gc={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},dc=0,fc=Object.keys(gc);dc<fc.length;dc+=1){var pc=fc[dc];gc[pc.toLowerCase()]=gc[pc]}var mc=gc,vc=O;vc.average=ts,vc.bezier=Cs,vc.blend=Ss,vc.cubehelix=Ts,vc.mix=vc.interpolate=un,vc.random=Ds,vc.scale=ss,vc.analyze=Us.analyze,vc.contrast=qs,vc.deltaE=sc,vc.distance=ac,vc.limits=Us.limits,vc.valid=lc,vc.scales=uc,vc.colors=Pr,vc.brewer=mc;var bc=vc;return bc}();const Vt=tt,Wt=$t,Xt=_t;var Ut=class{constructor(t,e,r,i,n=.3,s=0,c=null,a=1,o=!1){if(this.points=t,this.weights=e,this.width=r,this.height=i,this.sigma=n,this.interval=s,this.opacity=a,this.normalized=o,null===c){c=["#c51b7d","#de77ae","#f1b6da","#fde0ef","#ffffff","#e6f5d0","#b8e186","#7fbc41","#4d9221"]}this.colormap=c,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=this.width,this.canvas.height=this.height}setFromArray(t,e){this.points=[],t.forEach((t=>{this.points.push(new Vt(t[0],t[1]))})),this.weights=[],e.forEach((t=>{this.weights.push(t)}))}draw(){let t=[];for(let e=0;e<this.width;e++){let e=[];for(let t=0;t<this.height;t++)e.push(0);t.push(e)}let e=1/(2*this.sigma**2);for(let r=0;r<this.points.length;r++){let i=this.points[r],n=this.weights[r];for(let r=0;r<this.width;r++)for(let s=0;s<this.height;s++){let c=((r-i.x)**2+(s-i.y)**2)*e,a=n*Math.exp(-c);t[r][s]+=a}}let r=1;if(!this.normalized){let e=-Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(let r=0;r<this.width;r++)for(let n=0;n<this.height;n++)t[r][n]<i&&(i=t[r][n]),t[r][n]>e&&(e=t[r][n]);r=Math.max(Math.abs(i),Math.abs(e))}const i=Xt.scale(this.colormap).domain([-1,1]);for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++){this.normalized||(t[e][n]=t[e][n]/r),0!==this.interval&&(t[e][n]=Math.round(t[e][n]/this.interval)*this.interval);let[s,c,a]=i(t[e][n]).rgb();this.setPixel(new Vt(e,n),s,c,a)}}getImage(t){let e=new Image;e.onload=()=>{this.context.imageSmoothingEnabled=!1,this.context.drawImage(e,0,0,this.width,this.height),t&&t(e)},e.onerror=function(t){console.log(t)},e.src=this.canvas.toDataURL()}getSVG(){return Wt(this.context.getImageData(0,0,this.width,this.height))}setPixel(t,e,r,i){this.context.fillStyle="rgba("+e+","+r+","+i+","+this.opacity+")",this.context.fillRect(t.x,t.y,1,1)}};const Yt=X,qt=nt(),Gt=Lt,jt=ct,Kt=zt,Zt=wt,Jt=tt,Qt=Ut;var te=class{constructor(t,e=!0){this.preprocessor=new Gt(t),this.opts=this.preprocessor.opts,this.clear=e,this.svgWrapper=null}draw(t,e,r="light",i=null,n=!1,s=[],c=!1){null===e||"svg"===e?((e=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.setAttributeNS(null,"width",this.opts.width),e.setAttributeNS(null,"height",this.opts.height)):e instanceof String&&(e=document.getElementById(e));let a={padding:this.opts.padding,compactDrawing:this.opts.compactDrawing};null!==i&&(this.opts.padding+=this.opts.weights.additionalPadding,this.opts.compactDrawing=!1);let o=this.preprocessor;return o.initDraw(t,r,n,s),n||(this.themeManager=new Zt(this.opts.themes,r),(null===this.svgWrapper||this.clear)&&(this.svgWrapper=new Kt(this.themeManager,e,this.opts,this.clear))),o.processGraph(),this.svgWrapper.determineDimensions(o.graph.vertices),this.drawAtomHighlights(o.opts.debug),this.drawEdges(o.opts.debug),this.drawVertices(o.opts.debug),null!==i&&this.drawWeights(i,c),o.opts.debug&&(console.log(o.graph),console.log(o.rings),console.log(o.ringConnections)),this.svgWrapper.constructSvg(),null!==i&&(this.opts.padding=a.padding,this.opts.compactDrawing=a.padding),e}drawCanvas(t,e,r="light",i=!1){let n=null;n="string"==typeof e||e instanceof String?document.getElementById(e):e;let s=document.createElementNS("http://www.w3.org/2000/svg","svg");return s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttributeNS(null,"viewBox","0 0 500 500"),s.setAttributeNS(null,"width","500"),s.setAttributeNS(null,"height","500"),s.setAttributeNS(null,"style","visibility: hidden: position: absolute; left: -1000px"),document.body.appendChild(s),this.svgDrawer.draw(t,s,r,i),this.svgDrawer.svgWrapper.toCanvas(n,this.svgDrawer.opts.width,this.svgDrawer.opts.height),document.body.removeChild(s),e}drawAromaticityRing(t){this.svgWrapper.drawRing(t.center.x,t.center.y,t.getSize())}drawEdges(t){let e=this.preprocessor,r=e.graph,i=e.rings,n=Array(this.preprocessor.graph.edges.length);if(n.fill(!1),r.traverseBF(0,(e=>{let i=r.getEdges(e.id);for(var s=0;s<i.length;s++){let e=i[s];n[e]||(n[e]=!0,this.drawEdge(e,t))}})),!this.bridgedRing)for(var s=0;s<i.length;s++){let t=i[s];e.isRingAromatic(t)&&this.drawAromaticityRing(t)}}drawEdge(t,e){let r=this.preprocessor,i=r.opts,n=this.svgWrapper,s=r.graph.edges[t],c=r.graph.vertices[s.sourceId],a=r.graph.vertices[s.targetId],o=c.value.element,l=a.value.element;if(!(c.value.isDrawn&&a.value.isDrawn||"default"!==r.opts.atomVisualization))return;let h=c.position,C=a.position,u=r.getEdgeNormals(s),g=Yt.clone(u);if(g[0].multiplyScalar(10).add(h),g[1].multiplyScalar(10).add(h),"="===s.bondType||"="===r.getRingbondType(c,a)||s.isPartOfAromaticRing&&r.bridgedRing){let t=r.areVerticesInSameRing(c,a),e=r.chooseSide(c,a,g);if(t){let t=r.getLargestOrAromaticCommonRing(c,a).center;u[0].multiplyScalar(i.bondSpacing),u[1].multiplyScalar(i.bondSpacing);let e=null;e=t.sameSideAs(c.position,a.position,Jt.add(h,u[0]))?new jt(Jt.add(h,u[0]),Jt.add(C,u[0]),o,l):new jt(Jt.add(h,u[1]),Jt.add(C,u[1]),o,l),e.shorten(i.bondLength-i.shortBondLength*i.bondLength),s.isPartOfAromaticRing?n.drawLine(e,!0):n.drawLine(e),n.drawLine(new jt(h,C,o,l))}else if(s.center||c.isTerminal()&&a.isTerminal()||0==e.anCount&&e.bnCount>1||0==e.bnCount&&e.anCount>1){this.multiplyNormals(u,i.halfBondSpacing);let t=new jt(Jt.add(h,u[0]),Jt.add(C,u[0]),o,l),e=new jt(Jt.add(h,u[1]),Jt.add(C,u[1]),o,l);n.drawLine(t),n.drawLine(e)}else if(e.sideCount[0]>e.sideCount[1]||e.totalSideCount[0]>e.totalSideCount[1]){this.multiplyNormals(u,i.bondSpacing);let t=new jt(Jt.add(h,u[0]),Jt.add(C,u[0]),o,l);t.shorten(i.bondLength-i.shortBondLength*i.bondLength),n.drawLine(t),n.drawLine(new jt(h,C,o,l))}else if(e.sideCount[0]<e.sideCount[1]||e.totalSideCount[0]<=e.totalSideCount[1]){this.multiplyNormals(u,i.bondSpacing);let t=new jt(Jt.add(h,u[1]),Jt.add(C,u[1]),o,l);t.shorten(i.bondLength-i.shortBondLength*i.bondLength),n.drawLine(t),n.drawLine(new jt(h,C,o,l))}}else if("#"===s.bondType){u[0].multiplyScalar(i.bondSpacing/1.5),u[1].multiplyScalar(i.bondSpacing/1.5);let t=new jt(Jt.add(h,u[0]),Jt.add(C,u[0]),o,l),e=new jt(Jt.add(h,u[1]),Jt.add(C,u[1]),o,l);n.drawLine(t),n.drawLine(e),n.drawLine(new jt(h,C,o,l))}else if("."===s.bondType);else{let t=c.value.isStereoCenter,e=a.value.isStereoCenter;"up"===s.wedge?n.drawWedge(new jt(h,C,o,l,t,e)):"down"===s.wedge?n.drawDashedWedge(new jt(h,C,o,l,t,e)):n.drawLine(new jt(h,C,o,l,t,e))}if(e){let e=Jt.midpoint(h,C);n.drawDebugText(e.x,e.y,"e: "+t)}}drawAtomHighlights(t){let e=this.preprocessor;e.opts;let r=e.graph;e.rings;let i=this.svgWrapper;for(var n=0;n<r.vertices.length;n++){let t=r.vertices[n],c=t.value;for(var s=0;s<e.highlight_atoms.length;s++){let r=e.highlight_atoms[s];c.class===r[0]&&i.drawAtomHighlight(t.position.x,t.position.y,r[1])}}}drawVertices(t){let e=this.preprocessor,r=e.opts,i=e.graph,n=e.rings,s=this.svgWrapper;var c=i.vertices.length;for(c=0;c<i.vertices.length;c++){let e=i.vertices[c],n=e.value,a=0,o=0,l=e.value.bondCount,h=n.element,C=qt.maxBonds[h]-l,u=e.getTextDirection(i.vertices,n.hasAttachedPseudoElements),g=!(!r.terminalCarbons&&"C"===h&&!n.hasAttachedPseudoElements)&&e.isTerminal(),d="C"===n.element;if(i.vertices.length<3&&(d=!1),"N"===n.element&&n.isPartOfAromaticRing&&(C=0),n.bracket&&(C=n.bracket.hcount,a=n.bracket.charge,o=n.bracket.isotope),"allballs"===r.atomVisualization)s.drawBall(e.position.x,e.position.y,h);else if(n.isDrawn&&(!d||n.drawExplicit||g||n.hasAttachedPseudoElements)||1===i.vertices.length)if("default"===r.atomVisualization){let t=n.getAttachedPseudoElements();n.hasAttachedPseudoElements&&i.vertices.length===Object.keys(t).length+1&&(u="right"),s.drawText(e.position.x,e.position.y,h,C,u,g,a,o,i.vertices.length,t)}else"balls"===r.atomVisualization&&s.drawBall(e.position.x,e.position.y,h);else if(2===e.getNeighbourCount()&&1==e.forcePositioned){let t=i.vertices[e.neighbours[0]].position,r=i.vertices[e.neighbours[1]].position,n=Jt.threePointangle(e.position,t,r);Math.abs(Math.PI-n)<.1&&s.drawPoint(e.position.x,e.position.y,h)}if(t){let t="v: "+e.id+" "+Yt.print(n.ringbonds);s.drawDebugText(e.position.x,e.position.y,t)}}if(r.debug)for(c=0;c<n.length;c++){let t=n[c].center;s.drawDebugPoint(t.x,t.y,"r: "+n[c].id)}}drawWeights(t,e){if(t.every((t=>0===t)))return;if(t.length!==this.preprocessor.graph.atomIdxToVertexId.length)throw new Error("The number of weights supplied must be equal to the number of (heavy) atoms in the molecule.");let r=[];for(const t of this.preprocessor.graph.atomIdxToVertexId){let e=this.preprocessor.graph.vertices[t];r.push(new Jt(e.position.x-this.svgWrapper.minX,e.position.y-this.svgWrapper.minY))}let i=new Qt(r,t,this.svgWrapper.drawingWidth,this.svgWrapper.drawingHeight,this.opts.weights.sigma,this.opts.weights.interval,this.opts.weights.colormap,this.opts.weights.opacity,e);i.draw(),this.svgWrapper.addLayer(i.getSVG())}getTotalOverlapScore(){return this.preprocessor.getTotalOverlapScore()}getMolecularFormula(t=null){return this.preprocessor.getMolecularFormula(t)}multiplyNormals(t,e){t[0].multiplyScalar(e),t[1].multiplyScalar(e)}};const ee=te;var re=class{constructor(t){this.svgDrawer=new ee(t)}draw(t,e,r="light",i=!1,n=[]){let s=null;s="string"==typeof e||e instanceof String?document.getElementById(e):e;let c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttributeNS(null,"viewBox","0 0 "+this.svgDrawer.opts.width+" "+this.svgDrawer.opts.height),c.setAttributeNS(null,"width",this.svgDrawer.opts.width+""),c.setAttributeNS(null,"height",this.svgDrawer.opts.height+""),this.svgDrawer.draw(t,c,r,i,n),this.svgDrawer.svgWrapper.toCanvas(s,this.svgDrawer.opts.width,this.svgDrawer.opts.height)}getTotalOverlapScore(){return this.svgDrawer.getTotalOverlapScore()}getMolecularFormula(){this.svgDrawer.getMolecularFormula()}},ie=function(){function t(e,r,i,n){this.message=e,this.expected=r,this.found=i,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(t,Error),t.buildMessage=function(t,e){var r={literal:function(t){return'"'+n(t.text)+'"'},class:function(t){var e,r="";for(e=0;e<t.parts.length;e++)r+=t.parts[e]instanceof Array?s(t.parts[e][0])+"-"+s(t.parts[e][1]):s(t.parts[e]);return"["+(t.inverted?"^":"")+r+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function i(t){return t.charCodeAt(0).toString(16).toUpperCase()}function n(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+i(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+i(t)}))}function s(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+i(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+i(t)}))}return"Expected "+function(t){var e,i,n,s=new Array(t.length);for(e=0;e<t.length;e++)s[e]=(n=t[e],r[n.type](n));if(s.sort(),s.length>0){for(e=1,i=1;e<s.length;e++)s[e-1]!==s[e]&&(s[i]=s[e],i++);s.length=i}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(t)+" but "+function(t){return t?'"'+n(t)+'"':"end of input"}(e)+" found."},{SyntaxError:t,parse:function(e,r){if(r=void 0!==r?r:{},e.split("(").length-1!==e.split(")").length-1)throw Ut("The number of opening parentheses does not match the number of closing parentheses.",0);var i,n,s,c,a={},o={chain:Yt},l=Yt,h=function(t){for(var e=[],r=[],i=0;i<t[1].length;i++)e.push(t[1][i]);for(i=0;i<t[2].length;i++){var n=t[2][i][0]?t[2][i][0]:"-";r.push({bond:n,id:t[2][i][1]})}for(i=0;i<t[3].length;i++)e.push(t[3][i]);for(i=0;i<t[6].length;i++)e.push(t[6][i]);return{atom:t[0],isBracket:!!t[0].element,branches:e,branchCount:e.length,ringbonds:r,ringbondCount:r.length,bond:t[4]?t[4]:"-",next:t[5],hasNext:!!t[5]}},C="(",u=$t("(",!1),g=")",d=$t(")",!1),f=function(t){var e=t[1]?t[1]:"-";return t[2].branchBond=e,t[2]},p=function(t){return t},m=/^[\-=#$:\/\\.]/,v=_t(["-","=","#","$",":","/","\\","."],!1,!1),b=function(t){return t},w="[",y=$t("[",!1),O="se",N=$t("se",!1),S="as",x=$t("as",!1),A="]",R=$t("]",!1),k=function(t){return{isotope:t[1],element:t[2],chirality:t[3],hcount:t[4],charge:t[5],class:t[6]}},F="B",M=$t("B",!1),E="r",T=$t("r",!1),I="C",B=$t("C",!1),L="l",P=$t("l",!1),D=/^[NOPSFI]/,H=_t(["N","O","P","S","F","I"],!1,!1),z=function(t){return t.length>1?t.join(""):t},$=/^[bcnops]/,_=_t(["b","c","n","o","p","s"],!1,!1),V="*",W=$t("*",!1),X=function(t){return t},U=/^[A-Z]/,Y=_t([["A","Z"]],!1,!1),q=/^[a-z]/,G=_t([["a","z"]],!1,!1),j=function(t){return t.join("")},K="%",Z=$t("%",!1),J=/^[1-9]/,Q=_t([["1","9"]],!1,!1),tt=/^[0-9]/,et=_t([["0","9"]],!1,!1),rt=function(t){return 1==t.length?Number(t):Number(t.join("").replace("%",""))},it="@",nt=$t("@",!1),st="TH",ct=$t("TH",!1),at=/^[12]/,ot=_t(["1","2"],!1,!1),lt="AL",ht=$t("AL",!1),Ct="SP",ut=$t("SP",!1),gt=/^[1-3]/,dt=_t([["1","3"]],!1,!1),ft="TB",pt=$t("TB",!1),mt="OH",vt=$t("OH",!1),bt=function(t){return t[1]?"@"==t[1]?"@@":t[1].join("").replace(",",""):"@"},wt=function(t){return t},yt="+",Ot=$t("+",!1),Nt=function(t){return t[1]?"+"!=t[1]?Number(t[1].join("")):2:1},St="-",xt=$t("-",!1),At=function(t){return t[1]?"-"!=t[1]?-Number(t[1].join("")):-2:-1},Rt="H",kt=$t("H",!1),Ft=function(t){return t[1]?Number(t[1]):1},Mt=":",Et=$t(":",!1),Tt=/^[0]/,It=_t(["0"],!1,!1),Bt=function(t){return Number(t[1][0]+t[1][1].join(""))},Lt=function(t){return Number(t.join(""))},Pt=0,Dt=[{line:1,column:1}],Ht=0,zt=[];if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');l=o[r.startRule]}function $t(t,e){return{type:"literal",text:t,ignoreCase:e}}function _t(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function Vt(t){var r,i=Dt[t];if(i)return i;for(r=t-1;!Dt[r];)r--;for(i={line:(i=Dt[r]).line,column:i.column};r<t;)10===e.charCodeAt(r)?(i.line++,i.column=1):i.column++,r++;return Dt[t]=i,i}function Wt(t,e){var r=Vt(t),i=Vt(e);return{start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:i.line,column:i.column}}}function Xt(t){Pt<Ht||(Pt>Ht&&(Ht=Pt,zt=[]),zt.push(t))}function Ut(e,r){return new t(e,null,null,r)}function Yt(){var t,r,i,n,s,c,o,l,C;if(Pt,t=Pt,r=function(){var t,r;t=Pt,r=function(){var t,r,i,n;t=Pt,r=Pt,66===e.charCodeAt(Pt)?(i=F,Pt++):(i=a,Xt(M));i!==a?(114===e.charCodeAt(Pt)?(n=E,Pt++):(n=a,Xt(T)),n===a&&(n=null),n!==a?r=i=[i,n]:(Pt=r,r=a)):(Pt=r,r=a);r===a&&(r=Pt,67===e.charCodeAt(Pt)?(i=I,Pt++):(i=a,Xt(B)),i!==a?(108===e.charCodeAt(Pt)?(n=L,Pt++):(n=a,Xt(P)),n===a&&(n=null),n!==a?r=i=[i,n]:(Pt=r,r=a)):(Pt=r,r=a),r===a&&(D.test(e.charAt(Pt))?(r=e.charAt(Pt),Pt++):(r=a,Xt(H))));r!==a&&(r=z(r));return t=r,t}(),r===a&&(r=jt())===a&&(r=function(){var t,r,i,n,s,c,o,l,h,C;t=Pt,r=Pt,91===e.charCodeAt(Pt)?(i=w,Pt++):(i=a,Xt(y));i!==a?(n=function(){var t,r,i,n,s;t=Pt,r=Pt,J.test(e.charAt(Pt))?(i=e.charAt(Pt),Pt++):(i=a,Xt(Q));i!==a?(tt.test(e.charAt(Pt))?(n=e.charAt(Pt),Pt++):(n=a,Xt(et)),n===a&&(n=null),n!==a?(tt.test(e.charAt(Pt))?(s=e.charAt(Pt),Pt++):(s=a,Xt(et)),s===a&&(s=null),s!==a?r=i=[i,n,s]:(Pt=r,r=a)):(Pt=r,r=a)):(Pt=r,r=a);r!==a&&(r=Lt(r));return t=r,t}(),n===a&&(n=null),n!==a?(e.substr(Pt,2)===O?(s=O,Pt+=2):(s=a,Xt(N)),s===a&&(e.substr(Pt,2)===S?(s=S,Pt+=2):(s=a,Xt(x)),s===a&&(s=jt())===a&&(s=function(){var t,r,i,n;t=Pt,r=Pt,U.test(e.charAt(Pt))?(i=e.charAt(Pt),Pt++):(i=a,Xt(Y));i!==a?(q.test(e.charAt(Pt))?(n=e.charAt(Pt),Pt++):(n=a,Xt(G)),n===a&&(n=null),n!==a?r=i=[i,n]:(Pt=r,r=a)):(Pt=r,r=a);r!==a&&(r=j(r));return t=r,t}(),s===a&&(s=Kt()))),s!==a?(c=function(){var t,r,i,n,s,c,o;t=Pt,r=Pt,64===e.charCodeAt(Pt)?(i=it,Pt++):(i=a,Xt(nt));i!==a?(64===e.charCodeAt(Pt)?(n=it,Pt++):(n=a,Xt(nt)),n===a&&(n=Pt,e.substr(Pt,2)===st?(s=st,Pt+=2):(s=a,Xt(ct)),s!==a?(at.test(e.charAt(Pt))?(c=e.charAt(Pt),Pt++):(c=a,Xt(ot)),c!==a?n=s=[s,c]:(Pt=n,n=a)):(Pt=n,n=a),n===a&&(n=Pt,e.substr(Pt,2)===lt?(s=lt,Pt+=2):(s=a,Xt(ht)),s!==a?(at.test(e.charAt(Pt))?(c=e.charAt(Pt),Pt++):(c=a,Xt(ot)),c!==a?n=s=[s,c]:(Pt=n,n=a)):(Pt=n,n=a),n===a&&(n=Pt,e.substr(Pt,2)===Ct?(s=Ct,Pt+=2):(s=a,Xt(ut)),s!==a?(gt.test(e.charAt(Pt))?(c=e.charAt(Pt),Pt++):(c=a,Xt(dt)),c!==a?n=s=[s,c]:(Pt=n,n=a)):(Pt=n,n=a),n===a&&(n=Pt,e.substr(Pt,2)===ft?(s=ft,Pt+=2):(s=a,Xt(pt)),s!==a?(J.test(e.charAt(Pt))?(c=e.charAt(Pt),Pt++):(c=a,Xt(Q)),c!==a?(tt.test(e.charAt(Pt))?(o=e.charAt(Pt),Pt++):(o=a,Xt(et)),o===a&&(o=null),o!==a?n=s=[s,c,o]:(Pt=n,n=a)):(Pt=n,n=a)):(Pt=n,n=a),n===a&&(n=Pt,e.substr(Pt,2)===mt?(s=mt,Pt+=2):(s=a,Xt(vt)),s!==a?(J.test(e.charAt(Pt))?(c=e.charAt(Pt),Pt++):(c=a,Xt(Q)),c!==a?(tt.test(e.charAt(Pt))?(o=e.charAt(Pt),Pt++):(o=a,Xt(et)),o===a&&(o=null),o!==a?n=s=[s,c,o]:(Pt=n,n=a)):(Pt=n,n=a)):(Pt=n,n=a)))))),n===a&&(n=null),n!==a?r=i=[i,n]:(Pt=r,r=a)):(Pt=r,r=a);r!==a&&(r=bt(r));return t=r,t}(),c===a&&(c=null),c!==a?(o=function(){var t,r,i,n;t=Pt,r=Pt,72===e.charCodeAt(Pt)?(i=Rt,Pt++):(i=a,Xt(kt));i!==a?(tt.test(e.charAt(Pt))?(n=e.charAt(Pt),Pt++):(n=a,Xt(et)),n===a&&(n=null),n!==a?r=i=[i,n]:(Pt=r,r=a)):(Pt=r,r=a);r!==a&&(r=Ft(r));return t=r,t}(),o===a&&(o=null),o!==a?(l=function(){var t,r;t=Pt,r=function(){var t,r,i,n,s,c;t=Pt,r=Pt,43===e.charCodeAt(Pt)?(i=yt,Pt++):(i=a,Xt(Ot));i!==a?(43===e.charCodeAt(Pt)?(n=yt,Pt++):(n=a,Xt(Ot)),n===a&&(n=Pt,J.test(e.charAt(Pt))?(s=e.charAt(Pt),Pt++):(s=a,Xt(Q)),s!==a?(tt.test(e.charAt(Pt))?(c=e.charAt(Pt),Pt++):(c=a,Xt(et)),c===a&&(c=null),c!==a?n=s=[s,c]:(Pt=n,n=a)):(Pt=n,n=a)),n===a&&(n=null),n!==a?r=i=[i,n]:(Pt=r,r=a)):(Pt=r,r=a);r!==a&&(r=Nt(r));return t=r,t}(),r===a&&(r=function(){var t,r,i,n,s,c;t=Pt,r=Pt,45===e.charCodeAt(Pt)?(i=St,Pt++):(i=a,Xt(xt));i!==a?(45===e.charCodeAt(Pt)?(n=St,Pt++):(n=a,Xt(xt)),n===a&&(n=Pt,J.test(e.charAt(Pt))?(s=e.charAt(Pt),Pt++):(s=a,Xt(Q)),s!==a?(tt.test(e.charAt(Pt))?(c=e.charAt(Pt),Pt++):(c=a,Xt(et)),c===a&&(c=null),c!==a?n=s=[s,c]:(Pt=n,n=a)):(Pt=n,n=a)),n===a&&(n=null),n!==a?r=i=[i,n]:(Pt=r,r=a)):(Pt=r,r=a);r!==a&&(r=At(r));return t=r,t}());r!==a&&(r=wt(r));return t=r,t}(),l===a&&(l=null),l!==a?(h=function(){var t,r,i,n,s,c,o;t=Pt,r=Pt,58===e.charCodeAt(Pt)?(i=Mt,Pt++):(i=a,Xt(Et));if(i!==a){if(n=Pt,J.test(e.charAt(Pt))?(s=e.charAt(Pt),Pt++):(s=a,Xt(Q)),s!==a){for(c=[],tt.test(e.charAt(Pt))?(o=e.charAt(Pt),Pt++):(o=a,Xt(et));o!==a;)c.push(o),tt.test(e.charAt(Pt))?(o=e.charAt(Pt),Pt++):(o=a,Xt(et));c!==a?n=s=[s,c]:(Pt=n,n=a)}else Pt=n,n=a;n===a&&(Tt.test(e.charAt(Pt))?(n=e.charAt(Pt),Pt++):(n=a,Xt(It))),n!==a?r=i=[i,n]:(Pt=r,r=a)}else Pt=r,r=a;r!==a&&(r=Bt(r));return t=r,t}(),h===a&&(h=null),h!==a?(93===e.charCodeAt(Pt)?(C=A,Pt++):(C=a,Xt(R)),C!==a?r=i=[i,n,s,c,o,l,h,C]:(Pt=r,r=a)):(Pt=r,r=a)):(Pt=r,r=a)):(Pt=r,r=a)):(Pt=r,r=a)):(Pt=r,r=a)):(Pt=r,r=a)):(Pt=r,r=a);r!==a&&(r=k(r));return t=r,t}(),r===a&&(r=Kt()));r!==a&&(r=p(r));return t=r,t}(),r!==a){for(i=[],n=qt();n!==a;)i.push(n),n=qt();if(i!==a){for(n=[],s=Pt,(c=Gt())===a&&(c=null),c!==a&&(o=Zt())!==a?s=c=[c,o]:(Pt=s,s=a);s!==a;)n.push(s),s=Pt,(c=Gt())===a&&(c=null),c!==a&&(o=Zt())!==a?s=c=[c,o]:(Pt=s,s=a);if(n!==a){for(s=[],c=qt();c!==a;)s.push(c),c=qt();if(s!==a)if((c=Gt())===a&&(c=null),c!==a)if((o=Yt())===a&&(o=null),o!==a){for(l=[],C=qt();C!==a;)l.push(C),C=qt();l!==a?t=r=[r,i,n,s,c,o,l]:(Pt=t,t=a)}else Pt=t,t=a;else Pt=t,t=a;else Pt=t,t=a}else Pt=t,t=a}else Pt=t,t=a}else Pt=t,t=a;return t!==a&&(t=h(t)),t}function qt(){var t,r,i,n,s;return Pt,t=Pt,40===e.charCodeAt(Pt)?(r=C,Pt++):(r=a,Xt(u)),r!==a?((i=Gt())===a&&(i=null),i!==a&&(n=Yt())!==a?(41===e.charCodeAt(Pt)?(s=g,Pt++):(s=a,Xt(d)),s!==a?t=r=[r,i,n,s]:(Pt=t,t=a)):(Pt=t,t=a)):(Pt=t,t=a),t!==a&&(t=f(t)),t}function Gt(){var t;if(Pt,m.test(e.charAt(Pt))){if((t=e.charAt(Pt))===e.charAt(Pt+1))throw t=a,Ut("The parser encountered a bond repetition.",Pt+1);Pt++}else t=a,Xt(v);return t!==a&&(t=b(t)),t}function jt(){var t;return Pt,$.test(e.charAt(Pt))?(t=e.charAt(Pt),Pt++):(t=a,Xt(_)),t!==a&&(t=p(t)),t}function Kt(){var t;return Pt,42===e.charCodeAt(Pt)?(t=V,Pt++):(t=a,Xt(W)),t!==a&&(t=X(t)),t}function Zt(){var t,r,i,n;return Pt,t=Pt,37===e.charCodeAt(Pt)?(r=K,Pt++):(r=a,Xt(Z)),r!==a?(J.test(e.charAt(Pt))?(i=e.charAt(Pt),Pt++):(i=a,Xt(Q)),i!==a?(tt.test(e.charAt(Pt))?(n=e.charAt(Pt),Pt++):(n=a,Xt(et)),n!==a?t=r=[r,i,n]:(Pt=t,t=a)):(Pt=t,t=a)):(Pt=t,t=a),t===a&&(tt.test(e.charAt(Pt))?(t=e.charAt(Pt),Pt++):(t=a,Xt(et))),t!==a&&(t=rt(t)),t}if((i=l())!==a&&Pt===e.length)return i;throw i!==a&&Pt<e.length&&Xt({type:"end"}),n=zt,s=Ht<e.length?e.charAt(Ht):null,c=Ht<e.length?Wt(Ht,Ht+1):Wt(Ht,Ht),new t(t.buildMessage(n,s),n,s,c)}}}();const ne=ie;const se=class{constructor(t){this.reactantsSmiles=[],this.reagentsSmiles=[],this.productsSmiles=[],this.reactantsWeights=[],this.reagentsWeights=[],this.productsWeights=[],this.reactants=[],this.reagents=[],this.products=[];let e=t.split(">");if(3!==e.length)throw new Error("Invalid reaction SMILES. Did you add fewer than or more than two '>'?");""!==e[0]&&(this.reactantsSmiles=e[0].split(".")),""!==e[1]&&(this.reagentsSmiles=e[1].split(".")),""!==e[2]&&(this.productsSmiles=e[2].split("."));for(var r=0;r<this.reactantsSmiles.length;r++)this.reactants.push(ne.parse(this.reactantsSmiles[r]));for(r=0;r<this.reagentsSmiles.length;r++)this.reagents.push(ne.parse(this.reagentsSmiles[r]));for(r=0;r<this.productsSmiles.length;r++)this.products.push(ne.parse(this.productsSmiles[r]))}};var ce=class{static parse(t){return new se(t)}};const ae=te,oe=zt,le=yt,he=wt,Ce={C2H4O2:"acetic acid",C3H6O:"acetone",C2H3N:"acetonitrile",C6H6:"benzene",CCl4:"carbon tetrachloride",C6H5Cl:"chlorobenzene",CHCl3:"chloroform",C6H12:"cyclohexane",C2H4Cl2:"1,2-dichloroethane",C4H10O3:"diethylene glycol",C6H14O3:"diglyme",C4H10O2:"DME",C3H7NO:"DMF",C2H6OS:"DMSO",C2H6O:"ethanol",C2H6O2:"ethylene glycol",C3H8O3:"glycerin",C7H16:"heptane",C6H18N3OP:"HMPA",C6H18N3P:"HMPT",C6H14:"hexane",CH4O:"methanol",C5H12O:"MTBE",CH2Cl2:"methylene chloride",CH5H9NO:"NMP",CH3NO2:"nitromethane",C5H12:"pentane",C5H5N:"pyridine",C7H8:"toluene",C6H15N:"triethyl amine",H2O:"water"};var ue=class{constructor(t,e){this.defaultOptions={scale:e.scale>0?e.scale:1,fontSize:.8*e.fontSizeLarge,fontFamily:"Arial, Helvetica, sans-serif",spacing:10,plus:{size:9,thickness:1},arrow:{length:4*e.bondLength,headSize:6,thickness:1,margin:3},weights:{normalize:!1}},this.opts=le.extend(!0,this.defaultOptions,t),this.drawer=new ae(e),this.molOpts=this.drawer.opts}draw(t,e,r="light",i=null,n="{reagents}",s="",c=!1){if(this.themeManager=new he(this.molOpts.themes,r),this.opts.weights.normalize){let t=-Number.MAX_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER;if(i.hasOwnProperty("reactants"))for(let r=0;r<i.reactants.length;r++)for(let n=0;n<i.reactants[r].length;n++)i.reactants[r][n]<e&&(e=i.reactants[r][n]),i.reactants[r][n]>t&&(t=i.reactants[r][n]);if(i.hasOwnProperty("reagents"))for(let r=0;r<i.reagents.length;r++)for(let n=0;n<i.reagents[r].length;n++)i.reagents[r][n]<e&&(e=i.reagents[r][n]),i.reagents[r][n]>t&&(t=i.reagents[r][n]);if(i.hasOwnProperty("products"))for(let r=0;r<i.products.length;r++)for(let n=0;n<i.products[r].length;n++)i.products[r][n]<e&&(e=i.products[r][n]),i.products[r][n]>t&&(t=i.products[r][n]);let r=Math.max(Math.abs(e),Math.abs(t));if(0===r&&(r=1),i.hasOwnProperty("reactants"))for(let t=0;t<i.reactants.length;t++)for(let e=0;e<i.reactants[t].length;e++)i.reactants[t][e]/=r;if(i.hasOwnProperty("reagents"))for(let t=0;t<i.reagents.length;t++)for(let e=0;e<i.reagents[t].length;e++)i.reagents[t][e]/=r;if(i.hasOwnProperty("products"))for(let t=0;t<i.products.length;t++)for(let e=0;e<i.products[t].length;e++)i.products[t][e]/=r}let a=null;for(null===e||"svg"===e?(a=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttributeNS(null,"width","500"),a.setAttributeNS(null,"height","500")):a="string"==typeof e||e instanceof String?document.getElementById(e):e;a.firstChild;)a.removeChild(a.firstChild);let o=[],l=0;for(var h=0;h<t.reactants.length;h++){h>0&&o.push({width:this.opts.plus.size*this.opts.scale,height:this.opts.plus.size*this.opts.scale,svg:this.getPlus()});let e=null;i&&i.hasOwnProperty("reactants")&&i.reactants.length>h&&(e=i.reactants[h]);let n=document.createElementNS("http://www.w3.org/2000/svg","svg");this.drawer.draw(t.reactants[h],n,r,e,c,[],this.opts.weights.normalize);let s={width:n.viewBox.baseVal.width*this.opts.scale,height:n.viewBox.baseVal.height*this.opts.scale,svg:n};o.push(s),s.height>l&&(l=s.height)}o.push({width:this.opts.arrow.length*this.opts.scale,height:2*this.opts.arrow.headSize*this.opts.scale,svg:this.getArrow()});let C="";for(h=0;h<t.reagents.length;h++){h>0&&(C+=", ");let e=this.drawer.getMolecularFormula(t.reagents[h]);e in Ce&&(e=Ce[e]),C+=oe.replaceNumbersWithSubscript(e)}n=n.replace("{reagents}",C);const u=oe.writeText(n,this.themeManager,this.opts.fontSize*this.opts.scale,this.opts.fontFamily,this.opts.arrow.length*this.opts.scale);let g=(this.opts.arrow.length*this.opts.scale-u.width)/2;o.push({svg:u.svg,height:u.height,width:this.opts.arrow.length*this.opts.scale,offsetX:-(this.opts.arrow.length*this.opts.scale+this.opts.spacing)+g,offsetY:-u.height/2-this.opts.arrow.margin,position:"relative"});const d=oe.writeText(s,this.themeManager,this.opts.fontSize*this.opts.scale,this.opts.fontFamily,this.opts.arrow.length*this.opts.scale);g=(this.opts.arrow.length*this.opts.scale-d.width)/2,o.push({svg:d.svg,height:d.height,width:this.opts.arrow.length*this.opts.scale,offsetX:-(this.opts.arrow.length*this.opts.scale+this.opts.spacing)+g,offsetY:d.height/2+this.opts.arrow.margin,position:"relative"});for(h=0;h<t.products.length;h++){h>0&&o.push({width:this.opts.plus.size*this.opts.scale,height:this.opts.plus.size*this.opts.scale,svg:this.getPlus()});let e=null;i&&i.hasOwnProperty("products")&&i.products.length>h&&(e=i.products[h]);let n=document.createElementNS("http://www.w3.org/2000/svg","svg");this.drawer.draw(t.products[h],n,r,e,c,[],this.opts.weights.normalize);let s={width:n.viewBox.baseVal.width*this.opts.scale,height:n.viewBox.baseVal.height*this.opts.scale,svg:n};o.push(s),s.height>l&&(l=s.height)}let f=0;return o.forEach((t=>{let e=t.offsetX??0,r=t.offsetY??0;t.svg.setAttributeNS(null,"x",Math.round(f+e)),t.svg.setAttributeNS(null,"y",Math.round((l-t.height)/2+r)),t.svg.setAttributeNS(null,"width",Math.round(t.width)),t.svg.setAttributeNS(null,"height",Math.round(t.height)),a.appendChild(t.svg),"relative"!==t.position&&(f+=Math.round(t.width+this.opts.spacing+e))})),a.setAttributeNS(null,"viewBox",`0 0 ${f} ${l}`),a.style.width=f+"px",a.style.height=l+"px",a}getPlus(){let t=this.opts.plus.size,e=this.opts.plus.thickness,r=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","rect"),n=document.createElementNS("http://www.w3.org/2000/svg","rect");return r.setAttributeNS(null,"id","plus"),i.setAttributeNS(null,"x",0),i.setAttributeNS(null,"y",t/2-e/2),i.setAttributeNS(null,"width",t),i.setAttributeNS(null,"height",e),i.setAttributeNS(null,"fill",this.themeManager.getColor("C")),n.setAttributeNS(null,"x",t/2-e/2),n.setAttributeNS(null,"y",0),n.setAttributeNS(null,"width",e),n.setAttributeNS(null,"height",t),n.setAttributeNS(null,"fill",this.themeManager.getColor("C")),r.appendChild(i),r.appendChild(n),r.setAttributeNS(null,"viewBox",`0 0 ${t} ${t}`),r}getArrowhead(){let t=this.opts.arrow.headSize,e=document.createElementNS("http://www.w3.org/2000/svg","marker"),r=document.createElementNS("http://www.w3.org/2000/svg","polygon");return e.setAttributeNS(null,"id","arrowhead"),e.setAttributeNS(null,"viewBox",`0 0 ${t} ${t}`),e.setAttributeNS(null,"markerUnits","userSpaceOnUse"),e.setAttributeNS(null,"markerWidth",t),e.setAttributeNS(null,"markerHeight",t),e.setAttributeNS(null,"refX",0),e.setAttributeNS(null,"refY",t/2),e.setAttributeNS(null,"orient","auto"),e.setAttributeNS(null,"fill",this.themeManager.getColor("C")),r.setAttributeNS(null,"points",`0 0, ${t} ${t/2}, 0 ${t}`),e.appendChild(r),e}getCDArrowhead(){let t=this.opts.arrow.headSize,e=t*(7/4.5),r=document.createElementNS("http://www.w3.org/2000/svg","marker"),i=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"id","arrowhead"),r.setAttributeNS(null,"viewBox",`0 0 ${e} ${t}`),r.setAttributeNS(null,"markerUnits","userSpaceOnUse"),r.setAttributeNS(null,"markerWidth",2*e),r.setAttributeNS(null,"markerHeight",2*t),r.setAttributeNS(null,"refX",2.2),r.setAttributeNS(null,"refY",2.2),r.setAttributeNS(null,"orient","auto"),r.setAttributeNS(null,"fill",this.themeManager.getColor("C")),i.setAttributeNS(null,"style","fill-rule:nonzero;"),i.setAttributeNS(null,"d","m 0 0 l 7 2.25 l -7 2.25 c 0 0 0.735 -1.084 0.735 -2.28 c 0 -1.196 -0.735 -2.22 -0.735 -2.22 z"),r.appendChild(i),r}getArrow(){let t=this.opts.arrow.headSize,e=this.opts.arrow.length,r=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","defs"),n=document.createElementNS("http://www.w3.org/2000/svg","line");return i.appendChild(this.getCDArrowhead()),r.appendChild(i),r.setAttributeNS(null,"id","arrow"),n.setAttributeNS(null,"x1",0),n.setAttributeNS(null,"y1",-this.opts.arrow.thickness/2),n.setAttributeNS(null,"x2",e),n.setAttributeNS(null,"y2",-this.opts.arrow.thickness/2),n.setAttributeNS(null,"stroke-width",this.opts.arrow.thickness),n.setAttributeNS(null,"stroke",this.themeManager.getColor("C")),n.setAttributeNS(null,"marker-end","url(#arrowhead)"),r.appendChild(n),r.setAttributeNS(null,"viewBox",`0 ${-t/2} ${e+t*(7/4.5)} ${t}`),r}};const ge=ie,de=ce,fe=te,pe=ue,me=zt,ve=yt;var be=class t{constructor(t={},e={}){this.drawer=new fe(t),this.reactionDrawer=new pe(e,JSON.parse(JSON.stringify(this.drawer.opts)))}static apply(e={},r={},i="data-smiles",n="light",s=null,c=null){new t(e,r).apply(i,n,s,c)}apply(e="data-smiles",r="light",i=null,n=null){document.querySelectorAll(`[${e}]`).forEach((s=>{let c=s.getAttribute(e);if(null===c)throw Error("No SMILES provided.");let a=r,o=null;if(s.hasAttribute("data-smiles-theme")&&(a=s.getAttribute("data-smiles-theme")),s.hasAttribute("data-smiles-weights")&&(o=s.getAttribute("data-smiles-weights").split(",").map(parseFloat)),(s.hasAttribute("data-smiles-reactant-weights")||s.hasAttribute("data-smiles-reagent-weights")||s.hasAttribute("data-smiles-product-weights"))&&(o={reactants:[],reagents:[],products:[]},s.hasAttribute("data-smiles-reactant-weights")&&(o.reactants=s.getAttribute("data-smiles-reactant-weights").split(";").map((t=>t.split(",").map(parseFloat)))),s.hasAttribute("data-smiles-reagent-weights")&&(o.reagents=s.getAttribute("data-smiles-reagent-weights").split(";").map((t=>t.split(",").map(parseFloat)))),s.hasAttribute("data-smiles-product-weights")&&(o.products=s.getAttribute("data-smiles-product-weights").split(";").map((t=>t.split(",").map(parseFloat))))),s.hasAttribute("data-smiles-options")||s.hasAttribute("data-smiles-reaction-options")){let e={};s.hasAttribute("data-smiles-options")&&(e=JSON.parse(s.getAttribute("data-smiles-options").replaceAll("'",'"')));let r={};s.hasAttribute("data-smiles-reaction-options")&&(r=JSON.parse(s.getAttribute("data-smiles-reaction-options").replaceAll("'",'"'))),new t(e,r).draw(c,s,a,i,n,o)}else this.draw(c,s,a,i,n,o)}))}draw(t,e,r="light",i=null,n=null,s=null){let c=[];[t,...c]=t.split(" ");let a=c.join(" "),o={};if(a.includes("__")){let t=a.substring(a.indexOf("__")+2,a.lastIndexOf("__"));o=JSON.parse(t.replaceAll("'",'"'))}if(o=ve.extend(!0,{textAboveArrow:"{reagents}",textBelowArrow:""},o),t.includes(">"))try{this.drawReaction(t,e,r,o,s,i)}catch(t){n?n(t):console.error(t)}else try{this.drawMolecule(t,e,r,s,i)}catch(t){n?n(t):console.error(t)}}drawMolecule(t,e,r,i,n){let s=ge.parse(t);if(null===e||"svg"===e){let t=this.drawer.draw(s,null,r,i),e=this.getDimensions(t);t.setAttributeNS(null,"width",""+e.w),t.setAttributeNS(null,"height",""+e.h),n&&n(t)}else if("canvas"===e){let t=this.svgToCanvas(this.drawer.draw(s,null,r,i));n&&n(t)}else if("img"===e){let t=this.svgToImg(this.drawer.draw(s,null,r,i));n&&n(t)}else if(e instanceof HTMLImageElement)this.svgToImg(this.drawer.draw(s,null,r,i),e),n&&n(e);else if(e instanceof SVGElement)this.drawer.draw(s,e,r,i),n&&n(e);else{document.querySelectorAll(e).forEach((t=>{let e=t.nodeName.toLowerCase();"svg"===e?(this.drawer.draw(s,t,r,i),n&&n(t)):"canvas"===e?(this.svgToCanvas(this.drawer.draw(s,null,r,i),t),n&&n(t)):"img"===e&&(this.svgToImg(this.drawer.draw(s,null,r,i),t),n&&n(t))}))}}drawReaction(t,e,r,i,n,s){let c=de.parse(t);if(null===e||"svg"===e){let t=this.reactionDrawer.draw(c,null,r),e=this.getDimensions(t);t.setAttributeNS(null,"width",""+e.w),t.setAttributeNS(null,"height",""+e.h),s&&s(t)}else if("canvas"===e){let t=this.svgToCanvas(this.reactionDrawer.draw(c,null,r,n,i.textAboveArrow,i.textBelowArrow));s&&s(t)}else if("img"===e){let t=this.svgToImg(this.reactionDrawer.draw(c,null,r,n,i.textAboveArrow,i.textBelowArrow));s&&s(t)}else if(e instanceof HTMLImageElement)this.svgToImg(this.reactionDrawer.draw(c,null,r,n,i.textAboveArrow,i.textBelowArrow),e),s&&s(e);else if(e instanceof SVGElement)this.reactionDrawer.draw(c,e,r,n,i.textAboveArrow,i.textBelowArrow),s&&s(e);else{document.querySelectorAll(e).forEach((t=>{let e=t.nodeName.toLowerCase();"svg"===e?(this.reactionDrawer.draw(c,t,r,n,i.textAboveArrow,i.textBelowArrow),this.reactionDrawer.opts.scale<=0&&(t.style.width=null,t.style.height=null),s&&s(t)):"canvas"===e?(this.svgToCanvas(this.reactionDrawer.draw(c,null,r,n,i.textAboveArrow,i.textBelowArrow),t),s&&s(t)):"img"===e&&(this.svgToImg(this.reactionDrawer.draw(c,null,r,n,i.textAboveArrow,i.textBelowArrow),t),s&&s(t))}))}}svgToCanvas(t,e=null){null===e&&(e=document.createElement("canvas"));let r=this.getDimensions(e,t);return me.svgToCanvas(t,e,r.w,r.h),e}svgToImg(t,e=null){null===e&&(e=document.createElement("img"));let r=this.getDimensions(e,t);return me.svgToImg(t,e,r.w,r.h),e}getDimensions(t,e=null){let r=this.drawer.opts.width,i=this.drawer.opts.height;return this.drawer.opts.scale<=0?(null===r&&(r=t.width),null===i&&(i=t.height),""!==t.style.width&&(r=parseInt(t.style.width)),""!==t.style.height&&(i=parseInt(t.style.height))):e&&(r=parseFloat(e.style.width),i=parseFloat(e.style.height)),{w:r,h:i}}};const we=re,ye=ie,Oe=ce,Ne=te,Se=ue,xe=be,Ae=Ut;var Re=!("undefined"==typeof window||!window.document||!window.document.createElement),ke={Version:"1.0.0"};ke.Drawer=we,ke.Parser=ye,ke.SvgDrawer=Ne,ke.ReactionDrawer=Se,ke.ReactionParser=Oe,ke.GaussDrawer=Ae,ke.clean=function(t){return t.replace(/[^A-Za-z0-9@\.\+\-\?!\(\)\[\]\{\}/\\=#\$:\*]/g,"")},ke.apply=function(t,e="canvas[data-smiles]",r="light",i=null){let n=new we(t),s=document.querySelectorAll(e);for(var c=0;c<s.length;c++){let t=s[c];ke.parse(t.getAttribute("data-smiles"),(function(e){n.draw(e,t,r,!1)}),(function(t){i&&i(t)}))}},ke.parse=function(t,e,r){try{e&&e(ye.parse(t))}catch(t){r&&r(t)}},ke.parseReaction=function(t,e,r){try{e&&e(Oe.parse(t))}catch(t){r&&r(t)}},Re&&(window.SmilesDrawer=ke,window.SmiDrawer=xe),ke.SmiDrawer=xe,Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),r=e.length>>>0,i=arguments[1]>>0,n=i<0?Math.max(r+i,0):Math.min(i,r),s=arguments[2],c=void 0===s?r:s>>0,a=c<0?Math.max(r+c,0):Math.min(c,r);n<a;)e[n]=t,n++;return e}});var Fe=ke;function Me(e){let r,i;return{c(){var t;r=h("div"),t="svg",i=document.createElementNS("http://www.w3.org/2000/svg",t),d(i,"data-smiles",e[0]),d(i,"class","svelte-7bs7sp"),m(i,"small",e[1])},m(t,n){a(t,r,n),c(r,i),e[3](i)},p(t,[e]){1&e&&d(i,"data-smiles",t[0]),2&e&&m(i,"small",t[1])},i:t,o:t,d(t){t&&o(r),e[3](null)}}}function Ee(t,e,r){let{smiles:i="CCCCCCC"}=e,{small:n=!1}=e;const s={width:n?200:400,height:300};let c,a=new Fe.SvgDrawer(s);return w((()=>{r(2,c.innerHTML="",c),Fe.parse(i,(function(t){a.draw(t,c,"dark")}))})),t.$$set=t=>{"smiles"in t&&r(0,i=t.smiles),"small"in t&&r(1,n=t.small)},[i,n,c,function(t){O[t?"unshift":"push"]((()=>{c=t,r(2,c)}))}]}class Te extends W{constructor(t){super(),V(this,t,Ee,Me,s,{smiles:0,small:1})}}function Ie(t,e,r){const i=t.slice();return i[6]=e[r],i}function Be(t){let e,r,i,n,s,l=t[5][t[3]]+"";return n=new Te({props:{smiles:t[1]}}),{c(){e=h("div"),r=C(l),i=u(),H(n.$$.fragment),d(e,"class","plus svelte-s7kr30")},m(t,o){a(t,e,o),c(e,r),a(t,i,o),z(n,t,o),s=!0},p(t,e){(!s||8&e)&&l!==(l=t[5][t[3]]+"")&&f(r,l);const i={};2&e&&(i.smiles=t[1]),n.$set(i)},i(t){s||(P(n.$$.fragment,t),s=!0)},o(t){D(n.$$.fragment,t),s=!1},d(t){t&&o(e),t&&o(i),$(n,t)}}}function Le(t){let e,r;return e=new Te({props:{smiles:t[2]}}),{c(){H(e.$$.fragment)},m(t,i){z(e,t,i),r=!0},p(t,r){const i={};4&r&&(i.smiles=t[2]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function Pe(t){let e,r,i=t[2],n=[];for(let e=0;e<i.length;e+=1)n[e]=De(Ie(t,i,e));const s=t=>D(n[t],1,1,(()=>{n[t]=null}));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=C("")},m(t,i){for(let e=0;e<n.length;e+=1)n[e]&&n[e].m(t,i);a(t,e,i),r=!0},p(t,r){if(4&r){let c;for(i=t[2],c=0;c<i.length;c+=1){const s=Ie(t,i,c);n[c]?(n[c].p(s,r),P(n[c],1)):(n[c]=De(s),n[c].c(),P(n[c],1),n[c].m(e.parentNode,e))}for(B(),c=i.length;c<n.length;c+=1)s(c);L()}},i(t){if(!r){for(let t=0;t<i.length;t+=1)P(n[t]);r=!0}},o(t){n=n.filter(Boolean);for(let t=0;t<n.length;t+=1)D(n[t]);r=!1},d(t){l(n,t),t&&o(e)}}}function De(t){let e,r;return e=new Te({props:{smiles:t[6],small:!0}}),{c(){H(e.$$.fragment)},m(t,i){z(e,t,i),r=!0},p(t,r){const i={};4&r&&(i.smiles=t[6]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function He(t){let e,r,i,n,s,l,C,g,f;r=new Te({props:{smiles:t[0]}});let p=t[1]&&Be(t);const m=[Pe,Le],v=[];function b(t,e){return t[4]?0:1}return C=b(t),g=v[C]=m[C](t),{c(){e=h("div"),H(r.$$.fragment),i=u(),p&&p.c(),n=u(),s=h("div"),s.innerHTML='<span class="text svelte-s7kr30"></span>',l=u(),g.c(),d(s,"class","arrow svelte-s7kr30"),d(e,"class","equation svelte-s7kr30")},m(t,o){a(t,e,o),z(r,e,null),c(e,i),p&&p.m(e,null),c(e,n),c(e,s),c(e,l),v[C].m(e,null),f=!0},p(t,[i]){const s={};1&i&&(s.smiles=t[0]),r.$set(s),t[1]?p?(p.p(t,i),2&i&&P(p,1)):(p=Be(t),p.c(),P(p,1),p.m(e,n)):p&&(B(),D(p,1,1,(()=>{p=null})),L());let c=C;C=b(t),C===c?v[C].p(t,i):(B(),D(v[c],1,1,(()=>{v[c]=null})),L(),g=v[C],g?g.p(t,i):(g=v[C]=m[C](t),g.c()),P(g,1),g.m(e,null))},i(t){f||(P(r.$$.fragment,t),P(p),P(g),f=!0)},o(t){D(r.$$.fragment,t),D(p),D(g),f=!1},d(t){t&&o(e),$(r),p&&p.d(),v[C].d()}}}function ze(t,e,r){let i,{left:n}=e,{right:s}=e,{result:c}=e,{type:a}=e;return t.$$set=t=>{"left"in t&&r(0,n=t.left),"right"in t&&r(1,s=t.right),"result"in t&&r(2,c=t.result),"type"in t&&r(3,a=t.type)},t.$$.update=()=>{4&t.$$.dirty&&r(4,i=Array.isArray(c))},[n,s,c,a,i,{add:"+",sub:"-"}]}class $e extends W{constructor(t){super(),V(this,t,ze,He,s,{left:0,right:1,result:2,type:3})}}var _e=[{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",result:["CC(C)(C)c1ccc(C(=O)Nc2ccccc2O)c(c1)C(C)(C)","CC(C)(C)c1ccc(OCCN(C)C)c(c1)C(C)(C)","CC(C)(C)c1ccc(OCCNC(=O)c2ccccc2F)c(c1)C(C)(C)","CC(C)(C)c1ccc(O)nc1N(C)C(=O)CC2CC2","CC(C)(C)c1ccc(O)c(c1)NC(=O)C(C)(C)C"],model:"gpt-3.5-turbo",type:"mutate"},{left:"Cc1cccc(C=C)c1",result:["Cc1ccccc1C=C","Cc1cccc(C#N)c1","Cc1cccc(C=O)c1","Cc1cccc(C=CCN)c1","Cc1ccccc1C(CC)C"],model:"gpt-3.5-turbo",type:"mutate"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:["CCOC(=O)N1CCC(CC1)c2cccnc2","CCNC(=O)c1ccc(cc1)Nc2nccc(n2)c3cccnc3","CC(C)Nc1ccccc1Nc2nccc(n2)c3cccnc3","CC(C)NC(=O)c1ccc(cc1)Nc2nccc(n2)c3cccnc3","CC(C)Nc1ccc(cc1)Nc2nccc(n2)c3cccnc3"],model:"gpt-3.5-turbo",type:"mutate"},{left:"O=C(C)Oc1ccccc1C(=O)O",result:["O=C(C)Oc1ccccc1C(=O)N","O=C(C)Oc1ccccc1C(=O)N(C)C","O=C(C)Oc1ccccc1C(=O)OC","O=C(C)Oc1ccc(Cl)cc1C(=O)O","O=C(C)Oc1ccccc1C#N"],model:"gpt-3.5-turbo",type:"mutate"},{left:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:["C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12","CC1=C(OCCOCCN=C2C3=CC=CC=C3C(OCCOCC)=C2)C=CC(=C1)[N+]([O-])=O","CCCC(C)(C)C(=O)NC1=NN=C(C2=C1C=CC=C2)C(F)(F)F","COP(=O)(CC)OC1C2=CC=CC=C2C(=O)NC2=NC=C(N=C12)N","CC(=O)N[C@@H](CC1=CC=C(O)C=C1)C(=O)NC1=CN=C(N=C1)C1=CC=CC=C1"],model:"gpt-3.5-turbo",type:"mutate"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"Cc1cccc(C=C)c1",result:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C\\C=C\\c1ccccc1",type:"add",model:"gpt-3.5-turbo"},{left:"CC(C)(C)c1ccc(O)c(C(C)(C)C/C=C/c2ccccc2)c1",right:"Cc1cccc(C=C)c1",result:"CCCC1=CC=C(C=C1)C",type:"sub",model:"gpt-3.5-turbo"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C can be combined to form CC(C)(C)c1ccc(O)c(c1)C(C)(C)CNc2cccnc2NC(=O)c3ccc(cc3)CN4CCN(CC4)C",type:"add",model:"gpt-3.5-turbo"},{left:"Cc1ccc(NC(=O)c2ccc(CN3CCN(C)CC3)cc2)cc1Nc1nccc(-c2cccnc2)n1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"CCC1=CC=C(NC(=O)C2=CC=C(CN3CCN(C)CC3)C=C2)C=C1N1C=CC=C2C(NC3=NC=C(N3)C3=CC=CC=N3)=NC=CN12",type:"sub",model:"gpt-3.5-turbo"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)COC(=O)c1ccccc1C(=O)O",type:"add",model:"gpt-3.5-turbo"},{left:"CC(C)(C)c1ccc(O)c(C(C)(C)COC(=O)c2ccccc2C(=O)O)c1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"O=C(C)Oc1ccccc1C(=O)O - CC(C)(C)c1ccc(O)c(C(C)(C)COC(=O)c2ccccc2C(=O)O)c1  O=C(C)Oc1ccccc1C(=O)OCC(C)(C)c1ccc(O)c(C(C)(C)COC(=O)c2ccccc2C(=O)O)c1",type:"sub",model:"gpt-3.5-turbo"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"  [Si]1(C)(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]1(C)(C))C2N=C(F)C(F)=NC12",type:"add",model:"gpt-3.5-turbo"},{left:"Cc1cccc(C=C)c1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"c1ccc(C=C)c(C)c1Nc2nccc(n2)c3cccnc3NC(=O)c4ccc(CN5CCN(CC5)C)c(c4)C",type:"add",model:"gpt-3.5-turbo"},{left:"C=Cc1cccc(Nc2nccc(-c3cccnc3NC(=O)c3ccc(CN4CCN(C)CC4)c(C)c3)n2)c1C",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"CCc1ccc(C(=O)N2CCN(CC2)c2cccc(NC(=O)c3ccc(cc3)N3CCN(CC3)C)c2)c(C)c1",type:"sub",model:"gpt-3.5-turbo"},{left:"Cc1cccc(C=C)c1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"",type:"add",model:"gpt-3.5-turbo"},{left:"",right:"O=C(C)Oc1ccccc1C(=O)O",result:"OC(=O)c1ccccc1C(=O)O",type:"sub",model:"gpt-3.5-turbo"},{left:"Cc1cccc(C=C)c1",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"add",model:"gpt-3.5-turbo"},{left:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"",type:"sub",model:"gpt-3.5-turbo"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"O=C(C)Oc1ccccc1C(=O)O",type:"add",model:"gpt-3.5-turbo"},{left:"CC(=O)Oc1ccccc1C(=O)O",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC(=O)O",type:"sub",model:"gpt-3.5-turbo"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"add",model:"gpt-3.5-turbo"},{left:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"",type:"sub",model:"gpt-3.5-turbo"},{left:"O=C(C)Oc1ccccc1C(=O)O",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"[Si]12(CC(OC(C)=O)cccc1)C(C)(C)C(OCCOC1=CC=CC=C1C(OC(C)=O)=C1C=CC=C(C2=C3OCCOC3=C(F)C(F)=NC13)C1)=O",type:"add",model:"gpt-3.5-turbo"},{left:"C[Si]1C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"",type:"sub",model:"gpt-3.5-turbo"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",result:["CC(C)(C)c1ccc(O)c(N)c1C(C)(C)C","CC(C)(c1ccc(O)c(N)c1C(C)(C)C)C1CC1","CCc1ccc(O)cc1C(C)(C)C","C1CC1C(c2ccc(O)cc2C)C(C)(C)C","C1=CCCCC1c2ccc(O)c(c2)C(C)(C)C"],model:"gpt-4",type:"mutate"},{left:"Cc1cccc(C=C)c1",result:["CC1=CCCC=C1","Cc1ccc(C)cc1","CC1=CCC=CC1","CCCC1=CC=CC=C1","CC1=CCCCC1"],model:"gpt-4",type:"mutate"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:["Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)CCCCCC","Cc1ccc(cc1Nc2ncc(c(n2)c3ccc(nc3)C#N)N(=O)=O)NC(=O)c4ccc(cc4)CN5CCN(CC5)CC","Cc1ccc(cc1Nc2nccc(n2)c3ccc(nc3)C(=O)O)NC(=O)c4ccc(cc4)CN5CCN(CC5)COC","Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)N6CCOCC6","Cc1ccc(cc1Nc2nccc(n2)c3cc(ccn3)C)NC(=O)c4ccc(cc4)CN5CCN(CC5)CS"],model:"gpt-4",type:"mutate"},{left:"O=C(C)Oc1ccccc1C(=O)O",result:["C1=CC(=O)C2C(=O)C=C(OC2=C1)O","OC(=O)C1=C(CC=O)C(O)=CC=C1","O=C(O)C1=CC(OC2=CC=CC=C2)=CC=C1O","C1=CC(=O)OC(C(=O)O)C=C1","O=C(C(=O)O)c1ccc(OC2=CC=CC=C2C=O)cc1"],model:"gpt-4",type:"mutate"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"Cc1cccc(C=C)c1",result:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)CCc2cccc(C=C)c2",type:"add",model:"gpt-4"},{left:"C=Cc1cccc(CCC(C)(C)c2cc(C(C)(C)C)ccc2O)c1",right:"Cc1cccc(C=C)c1",result:"Cc1cccc(C)c1",type:"sub",model:"gpt-4"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)CCc2ccc(cc2Nc3nccc(n3)c4cccnc4)NC(=O)c5ccc(cc5)CN6CCN(CC6)C",type:"add",model:"gpt-4"},{left:"CN1CCN(Cc2ccc(C(=O)Nc3ccc(CCC(C)(C)c4cc(C(C)(C)C)ccc4O)c(Nc4nccc(-c5cccnc5)n4)c3)cc2)CC1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)C",type:"sub",model:"gpt-4"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC(C)(C)c1ccc(OCC(=O)Oc2ccccc2C(=O)O)c(c1)C(C)(C)C",type:"add",model:"gpt-4"},{left:"CC(C)(C)c1ccc(OCC(=O)Oc2ccccc2C(=O)O)c(C(C)(C)C)c1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC(C)(C)c1ccc(Oc2ccccc2C(=O)O)c(C(C)(C)C)c1",type:"sub",model:"gpt-4"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C[Si](C)(C)c1ccc(-c2ccc3c(c2)[SiH2]C(=C3OCCO1)C1=CC=C(-c3c4OCCOc4cc4N=C(F)C(F)=NC34)C2N=C(F)C(F)=NC12)C(C)(C)C",type:"add",model:"gpt-4"},{left:"Cc1cccc(C=C)c1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1cccc(C=CCc2ccc(cc2Nc3nccc(n3)c4cccnc4)NC(=O)c5ccc(cc5)CN6CCN(CC6)C)c1",type:"add",model:"gpt-4"},{left:"Cc1cccc(C=CCc2ccc(NC(=O)c3ccc(CN4CCN(C)CC4)cc3)cc2Nc2nccc(-c3cccnc3)n2)c1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1ccc(cc1Nc1nccc(n1)c1cccnc1)NC(=O)c1ccc(cc1)CN1CCN(CC1)C",type:"sub",model:"gpt-4"},{left:"Cc1cccc(C=C)c1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC(=O)Oc1ccccc1C(=O)OCCc1cccc(C=C)c1",type:"add",model:"gpt-4"},{left:"C=Cc1cccc(CCOC(=O)c2ccccc2OC(C)=O)c1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"O=C(C)Oc1ccccc1",type:"sub",model:"gpt-4"},{left:"Cc1cccc(C=C)c1",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C=CC1=CC=C(C2=C(Si(C)C=C2C)C2=CC=C(C3=C(Si(C)C=C3C)C3N=C(F)C(F)=NC3=N2)C2N=C(F)C(F)=NC12)C=C1",type:"add",model:"gpt-4"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC(=O)Nc1ccc(cc1Nc2nccc(n2)c3cccnc3)CN4CCN(CC4)COC(=O)C(=O)c5ccccc5",type:"add",model:"gpt-4"},{left:"CC(=O)Nc1ccc(CN2CCN(COC(=O)C(=O)c3ccccc3)CC2)cc1Nc1nccc(-c2cccnc2)n1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"O=C(C)Oc1ccccc1C(=O)OC(C(=O)Nc1ccc(CN2CCN(COC(=O)C(=O)c3ccccc3)CC2)cc1Nc1nccc(-c2cccnc2)n1)Nc1ccc(-c2cccnc2)nccc1N",type:"sub",model:"gpt-4"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"add",model:"gpt-4"},{left:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C)C2N=C(F)C(F)=NC12",type:"sub",model:"gpt-4"},{left:"O=C(C)Oc1ccccc1C(=O)O",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"O=C(C)Oc1ccccc1C(=O)OCC2=C(O[Si]1(C)C=C1C)C1=CC=C(C3=C4OCCOC4=[Si]C3(C)C)C3N=C(F)C(F)=NC123",type:"add",model:"gpt-4"},{left:"CC(=O)Oc1ccccc1C(=O)OCC1=C(O[Si]2(C)C=C2C)C2=CC=C(C3=C4OCCOC4=[Si]C3(C)C)C3N=C(F)C(F)=NC213",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C[Si](C)(C=C(O1CCOC1))C1=Cc2cc(C3NC(F)=NC(F)=C3)ncc2C(Cc2ccc(O1CCOC1)cc2)=[Si]C1CCC1",type:"sub",model:"gpt-4"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",result:["C(=O)c1ccc(O)c(c1)C(C)(C)C"],model:"text-curie-001",type:"mutate"},{left:"Cc1cccc(C=C)c1",result:["Cc1ccccc1","C=C","c1ccccc1","Cc1ccccc1","Cc1ccccc1","Cc1ccccc1","C=C","c1ccccc1","Cs1cccs1","Cc1ccccc1"],model:"text-curie-001",type:"mutate"},{left:"O=C(C)Oc1ccccc1C(=O)O",result:["O=C(C)Oc1ccccc1C(=O)O","O=C(C)Oc1ccccc1C(=O)O","O=C(C)Oc1ccccc1C(=O)O","O=C(C)Oc1ccccc1C(=O)O","O=C(C)Oc1ccccc1C(=O)O","O=C(C)Oc1ccccc1C(=O)O","O=C(C)Oc1ccccc1C(=O)O","O=C(C)Oc1ccccc1C(=O)O"],model:"text-curie-001",type:"mutate"},{left:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:["C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12"],model:"text-curie-001",type:"mutate"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"Cc1cccc(C=C)c1",result:"CC=C",type:"add",model:"text-curie-001"},{left:"C=C",right:"Cc1cccc(C=C)c1",result:"",type:"sub",model:"text-curie-001"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",type:"add",model:"text-curie-001"},{left:"Cc1ccc(NC(=O)c2ccc(CN3CCN(C)CC3)cc2)cc1Nc1nccc(-c2cccnc2)n1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C6",type:"sub",model:"text-curie-001"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"O=C(C)Oc1ccccc1C(=O)O",type:"add",model:"text-curie-001"},{left:"CC(C)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC-C-O-C-C-O-O",type:"sub",model:"text-curie-001"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"",type:"add",model:"text-curie-001"},{left:"Cc1cccc(C=C)c1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"c1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",type:"add",model:"text-curie-001"},{left:"C=Cc1ccccc1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C6",type:"sub",model:"text-curie-001"},{left:"Cc1cccc(C=C)c1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"Cc1cccc(C=C)c1C(=O)O",type:"add",model:"text-curie-001"},{left:"C=Cc1cccc(C)c1C(=O)O",right:"O=C(C)Oc1ccccc1C(=O)O",result:"c1ccccc1C(=O)O",type:"sub",model:"text-curie-001"},{left:"Cc1cccc(C=C)c1",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"CCCCCCCCC1=C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"add",model:"text-curie-001"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",type:"add",model:"text-curie-001"},{left:"Cc1ccc(NC(=O)c2ccc(CN3CCN(C)CC3)cc2)cc1Nc1nccc(-c2cccnc2)n1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"O-C1CCCCC1-C=O",type:"sub",model:"text-curie-001"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"add",model:"text-curie-001"},{left:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"sub",model:"text-curie-001"},{left:"O=C(C)Oc1ccccc1C(=O)O",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C=C(C)Oc1ccccc1C(=O)O",type:"add",model:"text-curie-001"},{left:"C=C(C)Oc1ccccc1C(=O)O",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"Subtract C=C(C)Oc1ccccc1C(=O)O from C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"sub",model:"text-curie-001"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",result:["CC1(C)C2(C)C3(C)C=C(C3C(C)(C)C2C1C)c4ccc(O)c(c4)C(C)(C)C","CC1(C)C2(C)C3(C)C=C(C3C(C)(C)C2C1C)c4ccc(N)c(c4)C(C)(C)C","CC1(C)C2(C)C3(C)C=C(C3C(C)(C)C2C1C)c4ccc(S)c(c4)C(C)(C)C","CC1(C)C2(C)C3(C)C=C(C3C(C)(C)C2C1C)c4ccc(F)c(c4)C(C)(C)C"],model:"text-davinci-003",type:"mutate"},{left:"Cc1cccc(C=C)c1",result:["CC1=C(C(C(C(C1)O)O)O)C","CC1=C(C(C(C(C1)O)O)N)C","CC1=C(C(C(C(C1)N)N)N)C","CC1=C(C(C(C(C1)S)S)S)C","CC1=C(C(C(C(C1)F)F)F)C"],model:"text-davinci-003",type:"mutate"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:["Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CNC(=O)C6CCN(CC6)C","Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CNC(=O)C6CCC(=O)N(CC6)C","Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CNC(=O)C6CC=CC(=O)N(C6)C","Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CNC(=O)C6C=CC(=O)N(CC6)C"],model:"text-davinci-003",type:"mutate"},{left:"O=C(C)Oc1ccccc1C(=O)O",result:["CC(C)(C)Oc1ccc(O)cc1C(=O)O","CC(=O)Oc1cc(O)ccc1C(C)(C)O","O=C(C)Oc1ccc(C(=O)O)cc1","CC(C)(C)Oc1ccc(C(=O)O)cc1","CC(=O)Oc1ccc(C)cc1C(C)(C)O"],model:"text-davinci-003",type:"mutate"},{left:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:["[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12","[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12","[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12","[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12"],model:"text-davinci-003",type:"mutate"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"Cc1cccc(C=C)c1",result:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)CC=Cc1ccccc1",type:"add",model:"text-davinci-003"},{left:"CC(C)(C)c1ccc(O)c(C(C)(C)CC=Cc2ccccc2)c1",right:"Cc1cccc(C=C)c1",result:"CC(=Cc1ccccc1)C(C)(C)CC(C)C",type:"sub",model:"text-davinci-003"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)CNC(=O)c1ccc(cc1Nc2nccc(n2)c3cccnc3)CN5CCN(CC5)C",type:"add",model:"text-davinci-003"},{left:"CN1CCN(Cc2ccc(C(=O)NCC(C)(C)c3cc(C(C)(C)C)ccc3O)c(Nc3nccc(-c4cccnc4)n3)c2)CC1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)Cc2ccc(C(=O)NCC(C)(C)c3cc(C(C)(C)C)ccc3O)c(Nc3nccc(-c4cccnc4)n3)c2",type:"sub",model:"text-davinci-003"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C(=O)Oc1ccccc1C(=O)O",type:"add",model:"text-davinci-003"},{left:"CC(C)(C)c1ccc(O)c(C(C)(C)C(=O)Oc2ccccc2C(=O)O)c1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC(C)(C)C(=O)Oc1ccccc1",type:"sub",model:"text-davinci-003"},{left:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"CC(C)(C)c1ccc(O)c(c1)C(C)(C)C1=C(C[Si]2(C)C=C3OCCOC3=C2C2=CC=C(C3=C4OCCOC4=C[Si]3(C)C)C4N=C(F)C(F)=NC24)C=CC=C1",type:"add",model:"text-davinci-003"},{left:"CC(C)(C)c1ccc(O)c(C(C)(C)c2ccccc2C[Si]2(C)C=C3OCCOC3=C2C2=CC=C(C3=C4OCCOC4=C[Si]3(C)C)C3N=C(F)C(F)=NC23)c1",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"CC(C)(C)c1ccc(O)c(C(C)(C)c2ccccc2C[Si]2(C)C=C3OCCOC3=C2C2=CC=CN2C3=C4OCCOC4=C[Si]3(C)C)c1",type:"sub",model:"text-davinci-003"},{left:"Cc1cccc(C=C)c1",right:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",result:"Cc1ccc2c(cc1C=C)c3ccc(Nc4nccc(n4)c5cccnc5)ccc23NC(=O)c6ccc(cc6)CN7CCN(CC7)C",type:"add",model:"text-davinci-003"},{left:"Cc1cccc(C=C)c1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"Cc1cccc(C=C)c1O=C(C)Oc1ccccc1C(=O)O",type:"add",model:"text-davinci-003"},{left:"Cc1cccc(C=C)c1",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"Cc1ccc(C=C)cc1C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"add",model:"text-davinci-003"},{left:"C=Cc1ccc(C)c(C[Si]2(C)C=C3OCCOC3=C2C2=CC=C(C3=C4OCCOC4=C[Si]3(C)C)C3N=C(F)C(F)=NC23)c1",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"C1[Si]2(C)C=C3OCCOC3=C2C2=CC=C(C3=C4OCCOC4=C[Si]3(C)C2N=C(F)C(F)=NC13)C1",type:"sub",model:"text-davinci-003"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC1=C(C(=O)Nc2ccc(cc2Nc3nccc(n3)c4cccnc4)C1)N(Cc5ccc(cc5)CN6CCN(CC6)C)C(=O)C7CCCCC7",type:"add",model:"text-davinci-003"},{left:"CC1=C(N(Cc2ccc(CN3CCN(C)CC3)cc2)C(=O)C2CCCCC2)C(=O)Nc2ccc(cc2Nc2nccc(-c3cccnc3)n2)C1",right:"O=C(C)Oc1ccccc1C(=O)O",result:"CC1=CN(Cc2ccc(CN3CCN(C)CC3)cc2)C(=O)C2CCCCC2Nc2ccc(cc2Nc2nccc(-c3cccnc3)n2)C1",type:"sub",model:"text-davinci-003"},{left:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"Cc1ccc(cc1Nc2nccc(n2)c3cccnc3)NC(=O)c4ccc(cc4)CN5CCN(CC5)C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"add",model:"text-davinci-003"},{left:"Cc1ccc(NC(=O)c2ccc(CN3CCN(C[Si]4(C)C=C5OCCOC5=C4C4=CC=C(C5=C6OCCOC6=C[Si]5(C)C)C5N=C(F)C(F)=NC45)CC3)cc2)cc1Nc1nccc(-c2cccnc2)n1",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"Cc1ccc(NC(=O)c2ccc(CN3CCN(C[Si]4(C)C=C5OCCOC5=C4C4=CC=C(C5=C6OCCOC6=C[Si]5(C)C)C5N=C(F)C(F)=NC45)CC3)cc2)cc1N",type:"sub",model:"text-davinci-003"},{left:"O=C(C)Oc1ccccc1C(=O)O",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"O=C(C)Oc1ccccc1C(=O)OC[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",type:"add",model:"text-davinci-003"},{left:"CC(=O)Oc1ccccc1C(=O)OC[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",right:"C[Si]1(C)C=C2OCCOC2=C1C1=CC=C(C2=C3OCCOC3=C[Si]2(C)C)C2N=C(F)C(F)=NC12",result:"CC(=O)Oc1ccccc1C(=O)OC",type:"sub",model:"text-davinci-003"}];function Ve(t,e,r){const i=t.slice();return i[10]=e[r].left,i[11]=e[r].right,i[12]=e[r].result,i[13]=e[r].type,i}function We(t,e,r){const i=t.slice();return i[16]=e[r],i}function Xe(t){let e,r,i,n=t[16]+"";return{c(){e=h("option"),r=C(n),e.__value=i=t[16],e.value=e.__value},m(t,i){a(t,e,i),c(e,r)},p(t,s){4&s&&n!==(n=t[16]+"")&&f(r,n),4&s&&i!==(i=t[16])&&(e.__value=i,e.value=e.__value)},d(t){t&&o(e)}}}function Ue(t){let e,r,i,n=t[4][t[1]]+"";return{c(){e=h("div"),r=C("Prompt: [omitted prefix] "),i=C(n),d(e,"class","prompt svelte-444h2t")},m(t,n){a(t,e,n),c(e,r),c(e,i)},p(t,e){2&e&&n!==(n=t[4][t[1]]+"")&&f(i,n)},d(t){t&&o(e)}}}function Ye(t){let e,r;return e=new $e({props:{left:t[10],right:t[11],result:t[12],type:t[13]}}),{c(){H(e.$$.fragment)},m(t,i){z(e,t,i),r=!0},p(t,r){const i={};3&r&&(i.left=t[10]),3&r&&(i.right=t[11]),3&r&&(i.result=t[12]),3&r&&(i.type=t[13]),e.$set(i)},i(t){r||(P(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function qe(t){let e,r,n,s,C,f,m,v,b,w,y,O,N,S,x,A,k,F,M=[...t[2]],E=[];for(let e=0;e<M.length;e+=1)E[e]=Xe(We(t,M,e));let T=t[0]&&t[1]&&Ue(t),I=t[3].filter(t[9]),H=[];for(let e=0;e<I.length;e+=1)H[e]=Ye(Ve(t,I,e));const z=t=>D(H[t],1,1,(()=>{H[t]=null}));return{c(){e=h("main"),r=h("h1"),r.textContent="mol_algebra",n=u(),s=h("select");for(let t=0;t<E.length;t+=1)E[t].c();C=u(),f=h("div"),m=h("button"),m.textContent="mutate",v=u(),b=h("button"),b.textContent="add",w=u(),y=h("button"),y.textContent="sub",O=u(),T&&T.c(),N=u(),S=h("div"),S.textContent="author: andrew",x=u();for(let t=0;t<H.length;t+=1)H[t].c();d(r,"class","hero svelte-444h2t"),void 0===t[0]&&R((()=>t[5].call(s))),d(e,"class","svelte-444h2t")},m(i,o){a(i,e,o),c(e,r),c(e,n),c(e,s);for(let t=0;t<E.length;t+=1)E[t]&&E[t].m(s,null);p(s,t[0],!0),c(e,C),c(e,f),c(f,m),c(f,v),c(f,b),c(f,w),c(f,y),c(e,O),T&&T.m(e,null),c(e,N),c(e,S),c(e,x);for(let t=0;t<H.length;t+=1)H[t]&&H[t].m(e,null);A=!0,k||(F=[g(s,"change",t[5]),g(m,"click",t[6]),g(b,"click",t[7]),g(y,"click",t[8])],k=!0)},p(t,[r]){if(4&r){let e;for(M=[...t[2]],e=0;e<M.length;e+=1){const i=We(t,M,e);E[e]?E[e].p(i,r):(E[e]=Xe(i),E[e].c(),E[e].m(s,null))}for(;e<E.length;e+=1)E[e].d(1);E.length=M.length}if(5&r&&p(s,t[0]),t[0]&&t[1]?T?T.p(t,r):(T=Ue(t),T.c(),T.m(e,N)):T&&(T.d(1),T=null),11&r){let i;for(I=t[3].filter(t[9]),i=0;i<I.length;i+=1){const n=Ve(t,I,i);H[i]?(H[i].p(n,r),P(H[i],1)):(H[i]=Ye(n),H[i].c(),P(H[i],1),H[i].m(e,null))}for(B(),i=I.length;i<H.length;i+=1)z(i);L()}},i(t){if(!A){for(let t=0;t<I.length;t+=1)P(H[t]);A=!0}},o(t){H=H.filter(Boolean);for(let t=0;t<H.length;t+=1)D(H[t]);A=!1},d(t){t&&o(e),l(E,t),T&&T.d(),l(H,t),k=!1,i(F)}}}function Ge(t,e,r){let i=_e,n="gpt-4",s="mutate",c=new Set(i.map((t=>t.model)));c=[...c].sort(((t,e)=>t.length-e.length));return[n,s,c,i,{mutate:"Generate 5 diverse molecules that are similar to {mol}",add:"Add {left} and {right} into a single molecule",sub:"Subtract {left} from {right}"},function(){n=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),r(0,n),r(2,c)},()=>r(1,s="mutate"),()=>r(1,s="add"),()=>r(1,s="sub"),t=>t.type===s&&(!n||t.model===n)]}return new class extends W{constructor(t){super(),V(this,t,Ge,qe,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
